(function(e,c,a,g){var d="menuAim",f={triggerEvent:"hover",rowSelector:"> li",handle:"> a",submenuSelector:"*",submenuDirection:"right",openClassName:"open",tolerance:75,activationDelay:300,mouseLocsTracked:3,defaultDelay:300,enterCallback:e.noop,activateCallback:e.noop,deactivateCallback:e.noop,exitCallback:e.noop,exitMenuCallback:e.noop};function b(i,h){this.el=i;this.options=e.extend({},f,h);this._defaults=f;this._name=d;this.init()}b.prototype={init:function(){this.activeRow=null,this.mouseLocs=[],this.lastDelayLoc=null,this.timeoutId=null,this.openDelayId=null,this.isOnClick=e.inArray(this.options.triggerEvent,["both","click"])>-1,this.isOnHover=e.inArray(this.options.triggerEvent,["both","hover"])>-1;if(this.isOnHover){this._hoverTriggerOn()}if(this.isOnClick){this._clickTriggerOn()}},_mouseMoveDocument:function(h){obj=h.data.obj;obj.mouseLocs.push({x:h.pageX,y:h.pageY});if(obj.mouseLocs.length>obj.options.mouseLocsTracked){obj.mouseLocs.shift()}},_mouseLeaveMenu:function(h){obj=h.data.obj;if(obj.timeoutId){clearTimeout(obj.timeoutId)}if(obj.openDelayId){clearTimeout(obj.openDelayId)}obj._possiblyDeactivate(obj.activeRow);obj.options.exitMenuCallback(this)},_mouseEnterRow:function(h){obj=h.data.obj;if(obj.timeoutId){clearTimeout(obj.timeoutId)}obj.options.enterCallback(this);obj._possiblyActivate(this)},_mouseLeaveRow:function(h){h.data.obj.options.exitCallback(this)},_clickRow:function(h){obj=h.data.obj;obj._activate(this);e(obj.el).find(obj.options.rowSelector).find(obj.options.handle).on("click",{obj:obj},obj._clickRowHandle)},_clickRowHandle:function(h){obj=h.data.obj;if(e(this).closest("li").hasClass(obj.options.openClassName)){obj._deactivate();h.stopPropagation()}},_activate:function(i){var h=this;if(i==this.activeRow){return}if(this.openDelayId){clearTimeout(this.openDelayId)}if(parseInt(h.options.activationDelay,0)>0&&h.isOnHover){if(h.activeRow){h._activateWithoutDelay(i)}else{this.openDelayId=setTimeout(function(){h._activateWithoutDelay(i)},h.options.activationDelay)}}else{h._activateWithoutDelay(i)}},_activateWithoutDelay:function(h){if(this.activeRow){this.options.deactivateCallback(this.activeRow)}this.options.activateCallback(h);this.activeRow=h},_deactivate:function(){if(this.openDelayId){clearTimeout(this.openDelayId)}if(this.activeRow){this.options.deactivateCallback(this.activeRow);this.activeRow=null}},_possiblyActivate:function(j){var h=this._activationDelay(),i=this;if(h){this.timeoutId=setTimeout(function(){i._possiblyActivate(j)},h)}else{this._activate(j)}},_possiblyDeactivate:function(j){var h=this._activationDelay(),i=this;if(h){this.timeoutId=setTimeout(function(){i._possiblyDeactivate(j)},h)}else{this.options.deactivateCallback(j);this.activeRow=null}},_activationDelay:function(){if(!this.activeRow||!e(this.activeRow).is(this.options.submenuSelector)){return 0}var l=e(this.el).offset(),h={x:l.left,y:l.top-this.options.tolerance},s={x:l.left+e(this.el).outerWidth(),y:h.y},u={x:l.left,y:l.top+e(this.el).outerHeight()+this.options.tolerance},m={x:l.left+e(this.el).outerWidth(),y:u.y},n=this.mouseLocs[this.mouseLocs.length-1],r=this.mouseLocs[0];if(!n){return 0}if(!r){r=n}if(r.x<l.left||r.x>m.x||r.y<l.top||r.y>m.y){return 0}if(this.lastDelayLoc&&n.x==this.lastDelayLoc.x&&n.y==this.lastDelayLoc.y){return 0}function o(w,v){return(v.y-w.y)/(v.x-w.x)}var q=s,i=m;if(this.options.submenuDirection=="left"){q=u;i=h}else{if(this.options.submenuDirection=="below"){q=m;i=u}else{if(this.options.submenuDirection=="above"){q=h;i=s}}}var j=o(n,q),p=o(n,i),t=o(r,q),k=o(r,i);if(j<t&&p>k){this.lastDelayLoc=n;return this.options.defaultDelay}this.lastDelayLoc=null;return 0},_outsideMenuClick:function(i){var h=i.data.obj;if(e(h.el).not(i.target)&&e(h.el).has(i.target).length===0){h.options.deactivateCallback(h.activeRow);h.activeRow=null}},_hoverTriggerOn:function(){e(this.el).on("mouseleave",{obj:this},this._mouseLeaveMenu).find(this.options.rowSelector).on("mouseenter",{obj:this},this._mouseEnterRow).on("mouseleave",{obj:this},this._mouseLeaveRow);e(c).on("blur",{obj:this},this._mouseLeaveMenu);e(a).on("mousemove",{obj:this},this._mouseMoveDocument)},_hoverTriggerOff:function(){e(this.el).off("mouseleave",this._mouseLeaveMenu).find(this.options.rowSelector).off("mouseenter",this._mouseEnterRow).off("mouseleave",this._mouseLeaveRow);e(c).off("blur",this._mouseLeaveMenu);e(a).off("mousemove",{obj:this},this._mouseMoveDocument)},_clickTriggerOn:function(){e(this.el).find(this.options.rowSelector).on("click",{obj:this},this._clickRow);e(a).on("click",{obj:this},this._outsideMenuClick)},_clickTriggerOff:function(){e(this.el).find(this.options.rowSelector).off("click",this._clickRow);e(a).off("click",this._outsideMenuClick)},switchToHover:function(){this._clickTriggerOff();this._hoverTriggerOn();this.isOnHover=true;this.isOnClick=false},switchToClick:function(){this._hoverTriggerOff();this._clickTriggerOn();this.isOnHover=false;this.isOnClick=true}};e.fn[d]=function(i){var h=arguments;if(i===g||typeof i==="object"){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,i))}})}else{if(typeof i==="string"&&i[0]!=="_"&&i!=="init"){var j;this.each(function(){var k=e.data(this,"plugin_"+d);if(k instanceof b&&typeof k[i]==="function"){j=k[i].apply(k,Array.prototype.slice.call(h,1))}if(i==="destroy"){e.data(this,"plugin_"+d,null)}});return j!==g?j:this}}}}(jQuery,window,document));