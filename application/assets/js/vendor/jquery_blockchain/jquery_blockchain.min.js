function checkConfirmations(a){$.ajax({type:"GET",url:iL.AJAXURL+"?do=bitcoin-confirmations&id="+a,data:{format:"plain"},success:function(c){if(!c){return}var e=parseInt(c);var f=parseInt($("#confirmationsrequired").text());var b=(100/f).toFixed(2);if(e>0){var d=(b*e);if(d>100){d=100}$("#confirmationcount").innerHTML(e);$("#confirmationpercent").css("width",d+"%");if(e<f){setTimeout("checkConfirmations("+a+")",10000)}else{$("#transactions").removeAttr("disabled")}}else{setTimeout("checkConfirmations("+a+")",10000)}}})}$(document).ready(function(){var a="https://blockchain.info/";var b=$(".blockchain-btn");b.find(".blockchain").hide();b.find(".stage-begin").trigger("show").show();b.each(function(c){var d=$(this);(function(){var e=d;e.click(function(){var f=$(this).data("create-url");e.find(".blockchain").hide();$("#submit-top").attr("disabled","disabled");e.find(".stage-loading").trigger("show").show();$.ajax({type:"GET",dataType:"json",url:f,success:function(g){e.find(".qr-code").empty();e.find(".blockchain").hide();if(!g||!g.input_address){e.find(".stage-error").trigger("show").show().html(e.find(".stage-error").html().replace("[[error]]","Unknown Error"));return}function h(){$.ajax({type:"GET",url:a+"q/getreceivedbyaddress/"+g.input_address,data:{format:"plain"},success:function(j){if(!j){return}var k=parseInt(j);var l=parseInt($("#invoice_id").val());if(k>0){e.find(".blockchain").hide();e.find(".stage-paid").trigger("show").show().html(e.find(".stage-paid").html().replace("[[value]]",k/100000000));setTimeout("checkConfirmations("+l+")",10000)}else{setTimeout(h,10000)}}})}try{ws=new WebSocket("wss://ws.blockchain.info/inv");if(!ws){return}ws.onmessage=function(o){try{var n=$.parseJSON(o.data);if(n.op=="utx"){var k=n.x;var j=0;for(var m=0;m<k.out.length;m++){var l=k.out[m];if(l.addr==g.input_address){j+=parseInt(l.value)}}}e.find(".blockchain").hide();e.find(".stage-paid").trigger("show").show().html(e.find(".stage-paid").html().replace("[[value]]",j/100000000));ws.close()}catch(o){console.log(o);console.log(o.data)}};ws.onopen=function(){ws.send('{"op":"addr_sub", "addr":"'+g.input_address+'"}')}}catch(i){console.log(i)}e.find(".stage-ready").trigger("show").show().html(e.find(".stage-ready").html().replace("[[address]]",g.input_address));e.find("#qr-code").html('<img src="'+a+"qr?data="+g.input_address+'&size=125">');e.unbind();setTimeout(h,10000)},error:function(g){e.find(".blockchain").hide();e.find(".stage-error").show().trigger("show").html(e.find(".stage-error").html().replace("[[error]]",g.responseText))}})})})()})});