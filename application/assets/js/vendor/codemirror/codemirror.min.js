(function(a){if(typeof exports=="object"&&typeof module=="object"){module.exports=a()}else{if(typeof define=="function"&&define.amd){return define([],a)}else{this.CodeMirror=a()}}})(function(){var co=/gecko\/\d/i.test(navigator.userAgent);var eK=/MSIE \d/.test(navigator.userAgent);var bJ=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);var dK=eK||bJ;var k=dK&&(eK?document.documentMode||6:bJ[1]);var c0=/WebKit\//.test(navigator.userAgent);var dN=c0&&/Qt\/\d+\.\d+/.test(navigator.userAgent);var dc=/Chrome\//.test(navigator.userAgent);var d3=/Opera\//.test(navigator.userAgent);var aC=/Apple Computer/.test(navigator.vendor);var c7=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent);var fu=/PhantomJS/.test(navigator.userAgent);var e1=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent);var eg=e1||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent);var b7=e1||/Mac/.test(navigator.platform);var aP=/win/i.test(navigator.platform);var aZ=d3&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);if(aZ){aZ=Number(aZ[1])}if(aZ&&aZ>=15){d3=false;c0=true}var bQ=b7&&(dN||d3&&(aZ==null||aZ<12.11));var f9=co||(dK&&k>=9);var gc=false,a8=false;function H(gi,gk){if(!(this instanceof H)){return new H(gi,gk)}this.options=gk=gk?aN(gk):{};aN(e3,gk,false);ce(gk);var go=gk.value;if(typeof go=="string"){go=new at(go,gk.mode)}this.doc=go;var gj=new H.inputStyles[gk.inputStyle](this);var gn=this.display=new eI(gi,go,gj);gn.wrapper.CodeMirror=this;ec(this);cO(this);if(gk.lineWrapping){this.display.wrapper.className+=" CodeMirror-wrap"}if(gk.autofocus&&!eg){gn.input.focus()}aD(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,delayingBlurEvent:false,focused:false,suppressEdits:false,pasteIncoming:false,cutIncoming:false,draggingText:false,highlight:new gg(),keySeq:null,specialChars:null};var gh=this;if(dK&&k<11){setTimeout(function(){gh.display.input.reset(true)},20)}fQ(this);bj();cI(this);this.curOp.forceUpdate=true;eb(this,go);if((gk.autofocus&&!eg)||gh.hasFocus()){setTimeout(cv(cB,this),20)}else{aV(this)}for(var gm in bf){if(bf.hasOwnProperty(gm)){bf[gm](this,gk[gm],cc)}}d5(this);if(gk.finishInit){gk.finishInit(this)}for(var gl=0;gl<a9.length;++gl){a9[gl](this)}am(this);if(c0&&gk.lineWrapping&&getComputedStyle(gn.lineDiv).textRendering=="optimizelegibility"){gn.lineDiv.style.textRendering="auto"}}function eI(gh,gj,gi){var gk=this;this.input=gi;gk.scrollbarFiller=f2("div",null,"CodeMirror-scrollbar-filler");gk.scrollbarFiller.setAttribute("cm-not-content","true");gk.gutterFiller=f2("div",null,"CodeMirror-gutter-filler");gk.gutterFiller.setAttribute("cm-not-content","true");gk.lineDiv=f2("div",null,"CodeMirror-code");gk.selectionDiv=f2("div",null,null,"position: relative; z-index: 1");gk.cursorDiv=f2("div",null,"CodeMirror-cursors");gk.measure=f2("div",null,"CodeMirror-measure");gk.lineMeasure=f2("div",null,"CodeMirror-measure");gk.lineSpace=f2("div",[gk.measure,gk.lineMeasure,gk.selectionDiv,gk.cursorDiv,gk.lineDiv],null,"position: relative; outline: none");gk.mover=f2("div",[f2("div",[gk.lineSpace],"CodeMirror-lines")],null,"position: relative");gk.sizer=f2("div",[gk.mover],"CodeMirror-sizer");gk.sizerWidth=null;gk.heightForcer=f2("div",null,null,"position: absolute; height: "+dJ+"px; width: 1px;");gk.gutters=f2("div",null,"CodeMirror-gutters");gk.lineGutter=null;gk.scroller=f2("div",[gk.sizer,gk.heightForcer,gk.gutters],"CodeMirror-scroll");gk.scroller.setAttribute("tabIndex","-1");gk.wrapper=f2("div",[gk.scrollbarFiller,gk.gutterFiller,gk.scroller],"CodeMirror");if(dK&&k<8){gk.gutters.style.zIndex=-1;gk.scroller.style.paddingRight=0}if(!c0&&!(co&&eg)){gk.scroller.draggable=true}if(gh){if(gh.appendChild){gh.appendChild(gk.wrapper)}else{gh(gk.wrapper)}}gk.viewFrom=gk.viewTo=gj.first;gk.reportedViewFrom=gk.reportedViewTo=gj.first;gk.view=[];gk.renderedView=null;gk.externalMeasured=null;gk.viewOffset=0;gk.lastWrapHeight=gk.lastWrapWidth=0;gk.updateLineNumbers=null;gk.nativeBarWidth=gk.barHeight=gk.barWidth=0;gk.scrollbarsClipped=false;gk.lineNumWidth=gk.lineNumInnerWidth=gk.lineNumChars=null;gk.alignWidgets=false;gk.cachedCharWidth=gk.cachedTextHeight=gk.cachedPaddingH=null;gk.maxLine=null;gk.maxLineLength=0;gk.maxLineChanged=false;gk.wheelDX=gk.wheelDY=gk.wheelStartX=gk.wheelStartY=null;gk.shift=false;gk.selForContextMenu=null;gk.activeTouch=null;gi.init(gk)}function br(gh){gh.doc.mode=H.getMode(gh.options,gh.doc.modeOption);el(gh)}function el(gh){gh.doc.iter(function(gi){if(gi.stateAfter){gi.stateAfter=null}if(gi.styles){gi.styles=null}});gh.doc.frontier=gh.doc.first;ef(gh,100);gh.state.modeGen++;if(gh.curOp){ah(gh)}}function eG(gh){if(gh.options.lineWrapping){fA(gh.display.wrapper,"CodeMirror-wrap");gh.display.sizer.style.minWidth="";gh.display.sizerWidth=null}else{f(gh.display.wrapper,"CodeMirror-wrap");g(gh)}X(gh);ah(gh);ak(gh);setTimeout(function(){eY(gh)},100)}function be(gh){var gj=aY(gh.display),gi=gh.options.lineWrapping;var gk=gi&&Math.max(5,gh.display.scroller.clientWidth/dD(gh.display)-3);return function(gm){if(fw(gh.doc,gm)){return 0}var gl=0;if(gm.widgets){for(var gn=0;gn<gm.widgets.length;gn++){if(gm.widgets[gn].height){gl+=gm.widgets[gn].height}}}if(gi){return gl+(Math.ceil(gm.text.length/gk)||1)*gj}else{return gl+gj}}}function X(gh){var gj=gh.doc,gi=be(gh);gj.iter(function(gk){var gl=gi(gk);if(gl!=gk.height){f5(gk,gl)}})}function cO(gh){gh.display.wrapper.className=gh.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+gh.options.theme.replace(/(^|\s)\s*/g," cm-s-");ak(gh)}function dw(gh){ec(gh);ah(gh);setTimeout(function(){eE(gh)},20)}function ec(gh){var gi=gh.display.gutters,gm=gh.options.gutters;d1(gi);for(var gj=0;gj<gm.length;++gj){var gk=gm[gj];var gl=gi.appendChild(f2("div",null,"CodeMirror-gutter "+gk));if(gk=="CodeMirror-linenumbers"){gh.display.lineGutter=gl;gl.style.width=(gh.display.lineNumWidth||1)+"px"}}gi.style.display=gj?"":"none";c4(gh)}function c4(gh){var gi=gh.display.gutters.offsetWidth;gh.display.sizer.style.marginLeft=gi+"px"}function en(gj){if(gj.height==0){return 0}var gi=gj.text.length,gh,gl=gj;while(gh=eO(gl)){var gk=gh.find(0,true);gl=gk.from.line;gi+=gk.from.ch-gk.to.ch}gl=gj;while(gh=ew(gl)){var gk=gh.find(0,true);gi-=gl.text.length-gk.from.ch;gl=gk.to.line;gi+=gl.text.length-gk.to.ch}return gi}function g(gh){var gj=gh.display,gi=gh.doc;gj.maxLine=ff(gi,gi.first);gj.maxLineLength=en(gj.maxLine);gj.maxLineChanged=true;gi.iter(function(gl){var gk=en(gl);if(gk>gj.maxLineLength){gj.maxLineLength=gk;gj.maxLine=gl}})}function ce(gh){var gi=dh(gh.gutters,"CodeMirror-linenumbers");if(gi==-1&&gh.lineNumbers){gh.gutters=gh.gutters.concat(["CodeMirror-linenumbers"])}else{if(gi>-1&&!gh.lineNumbers){gh.gutters=gh.gutters.slice(0);gh.gutters.splice(gi,1)}}}function dA(gh){var gk=gh.display,gj=gk.gutters.offsetWidth;var gi=Math.round(gh.doc.height+bI(gh.display));return{clientHeight:gk.scroller.clientHeight,viewHeight:gk.wrapper.clientHeight,scrollWidth:gk.scroller.scrollWidth,clientWidth:gk.scroller.clientWidth,viewWidth:gk.wrapper.clientWidth,barLeft:gh.options.fixedGutter?gj:0,docHeight:gi,scrollHeight:gi+cT(gh)+gk.barHeight,nativeBarWidth:gk.nativeBarWidth,gutterWidth:gj}}function dk(gj,gi,gh){this.cm=gh;var gk=this.vert=f2("div",[f2("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar");var gl=this.horiz=f2("div",[f2("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");gj(gk);gj(gl);bX(gk,"scroll",function(){if(gk.clientHeight){gi(gk.scrollTop,"vertical")}});bX(gl,"scroll",function(){if(gl.clientWidth){gi(gl.scrollLeft,"horizontal")}});this.checkedOverlay=false;if(dK&&k<8){this.horiz.style.minHeight=this.vert.style.minWidth="18px"}}dk.prototype=aN({update:function(gk){var gl=gk.scrollWidth>gk.clientWidth+1;var gj=gk.scrollHeight>gk.clientHeight+1;var gm=gk.nativeBarWidth;if(gj){this.vert.style.display="block";this.vert.style.bottom=gl?gm+"px":"0";var gi=gk.viewHeight-(gl?gm:0);this.vert.firstChild.style.height=Math.max(0,gk.scrollHeight-gk.clientHeight+gi)+"px"}else{this.vert.style.display="";this.vert.firstChild.style.height="0"}if(gl){this.horiz.style.display="block";this.horiz.style.right=gj?gm+"px":"0";this.horiz.style.left=gk.barLeft+"px";var gh=gk.viewWidth-gk.barLeft-(gj?gm:0);this.horiz.firstChild.style.width=(gk.scrollWidth-gk.clientWidth+gh)+"px"}else{this.horiz.style.display="";this.horiz.firstChild.style.width="0"}if(!this.checkedOverlay&&gk.clientHeight>0){if(gm==0){this.overlayHack()}this.checkedOverlay=true}return{right:gj?gm:0,bottom:gl?gm:0}},setScrollLeft:function(gh){if(this.horiz.scrollLeft!=gh){this.horiz.scrollLeft=gh}},setScrollTop:function(gh){if(this.vert.scrollTop!=gh){this.vert.scrollTop=gh}},overlayHack:function(){var gh=b7&&!c7?"12px":"18px";this.horiz.style.minHeight=this.vert.style.minWidth=gh;var gi=this;var gj=function(gk){if(L(gk)!=gi.vert&&L(gk)!=gi.horiz){c2(gi.cm,eu)(gk)}};bX(this.vert,"mousedown",gj);bX(this.horiz,"mousedown",gj)},clear:function(){var gh=this.horiz.parentNode;gh.removeChild(this.horiz);gh.removeChild(this.vert)}},dk.prototype);function e4(){}e4.prototype=aN({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},e4.prototype);H.scrollbarModel={"native":dk,"null":e4};function aD(gh){if(gh.display.scrollbars){gh.display.scrollbars.clear();if(gh.display.scrollbars.addClass){f(gh.display.wrapper,gh.display.scrollbars.addClass)}}gh.display.scrollbars=new H.scrollbarModel[gh.options.scrollbarStyle](function(gi){gh.display.wrapper.insertBefore(gi,gh.display.scrollbarFiller);bX(gi,"mousedown",function(){if(gh.state.focused){setTimeout(function(){gh.display.input.focus()},0)}});gi.setAttribute("cm-not-content","true")},function(gj,gi){if(gi=="horizontal"){bE(gh,gj)}else{N(gh,gj)}},gh);if(gh.display.scrollbars.addClass){fA(gh.display.wrapper,gh.display.scrollbars.addClass)}}function eY(gj,gl){if(!gl){gl=dA(gj)}var gi=gj.display.barWidth,gh=gj.display.barHeight;aU(gj,gl);for(var gk=0;gk<4&&gi!=gj.display.barWidth||gh!=gj.display.barHeight;gk++){if(gi!=gj.display.barWidth&&gj.options.lineWrapping){ba(gj)}aU(gj,dA(gj));gi=gj.display.barWidth;gh=gj.display.barHeight}}function aU(gh,gi){var gk=gh.display;var gj=gk.scrollbars.update(gi);gk.sizer.style.paddingRight=(gk.barWidth=gj.right)+"px";gk.sizer.style.paddingBottom=(gk.barHeight=gj.bottom)+"px";if(gj.right&&gj.bottom){gk.scrollbarFiller.style.display="block";gk.scrollbarFiller.style.height=gj.bottom+"px";gk.scrollbarFiller.style.width=gj.right+"px"}else{gk.scrollbarFiller.style.display=""}if(gj.bottom&&gh.options.coverGutterNextToScrollbar&&gh.options.fixedGutter){gk.gutterFiller.style.display="block";gk.gutterFiller.style.height=gj.bottom+"px";gk.gutterFiller.style.width=gi.gutterWidth+"px"}else{gk.gutterFiller.style.display=""}}function b6(gk,go,gj){var gl=gj&&gj.top!=null?Math.max(0,gj.top):gk.scroller.scrollTop;gl=Math.floor(gl-e8(gk));var gh=gj&&gj.bottom!=null?gj.bottom:gl+gk.wrapper.clientHeight;var gm=bG(go,gl),gn=bG(go,gh);if(gj&&gj.ensure){var gi=gj.ensure.from.line,gp=gj.ensure.to.line;if(gi<gm){gm=gi;gn=bG(go,bM(ff(go,gi))+gk.wrapper.clientHeight)}else{if(Math.min(gp,go.lastLine())>=gn){gm=bG(go,bM(ff(go,gp))-gk.wrapper.clientHeight);gn=gp}}}return{from:gm,to:Math.max(gn,gm+1)}}function eE(gp){var gn=gp.display,go=gn.view;if(!gn.alignWidgets&&(!gn.gutters.firstChild||!gp.options.fixedGutter)){return}var gl=dX(gn)-gn.scroller.scrollLeft+gp.doc.scrollLeft;var gh=gn.gutters.offsetWidth,gi=gl+"px";for(var gk=0;gk<go.length;gk++){if(!go[gk].hidden){if(gp.options.fixedGutter&&go[gk].gutter){go[gk].gutter.style.left=gi}var gm=go[gk].alignable;if(gm){for(var gj=0;gj<gm.length;gj++){gm[gj].style.left=gi}}}}if(gp.options.fixedGutter){gn.gutters.style.left=(gl+gh)+"px"}}function d5(gh){if(!gh.options.lineNumbers){return false}var gm=gh.doc,gi=es(gh.options,gm.first+gm.size-1),gl=gh.display;if(gi.length!=gl.lineNumChars){var gn=gl.measure.appendChild(f2("div",[f2("div",gi)],"CodeMirror-linenumber CodeMirror-gutter-elt"));var gj=gn.firstChild.offsetWidth,gk=gn.offsetWidth-gj;gl.lineGutter.style.width="";gl.lineNumInnerWidth=Math.max(gj,gl.lineGutter.offsetWidth-gk)+1;gl.lineNumWidth=gl.lineNumInnerWidth+gk;gl.lineNumChars=gl.lineNumInnerWidth?gi.length:-1;gl.lineGutter.style.width=gl.lineNumWidth+"px";c4(gh);return true}return false}function es(gh,gi){return String(gh.lineNumberFormatter(gi+gh.firstLineNumber))}function dX(gh){return gh.scroller.getBoundingClientRect().left-gh.sizer.getBoundingClientRect().left}function aI(gi,gh,gj){var gk=gi.display;this.viewport=gh;this.visible=b6(gk,gi.doc,gh);this.editorIsHidden=!gk.wrapper.offsetWidth;this.wrapperHeight=gk.wrapper.clientHeight;this.wrapperWidth=gk.wrapper.clientWidth;this.oldDisplayWidth=dl(gi);this.force=gj;this.dims=fd(gi);this.events=[]}aI.prototype.signal=function(gi,gh){if(fi(gi,gh)){this.events.push(arguments)}};aI.prototype.finish=function(){for(var gh=0;gh<this.events.length;gh++){aE.apply(null,this.events[gh])}};function J(gh){var gi=gh.display;if(!gi.scrollbarsClipped&&gi.scroller.offsetWidth){gi.nativeBarWidth=gi.scroller.offsetWidth-gi.scroller.clientWidth;gi.heightForcer.style.height=cT(gh)+"px";gi.sizer.style.marginBottom=-gi.nativeBarWidth+"px";gi.sizer.style.borderRightWidth=cT(gh)+"px";gi.scrollbarsClipped=true}}function B(gq,gk){var gl=gq.display,gp=gq.doc;if(gk.editorIsHidden){ex(gq);return false}if(!gk.force&&gk.visible.from>=gl.viewFrom&&gk.visible.to<=gl.viewTo&&(gl.updateLineNumbers==null||gl.updateLineNumbers>=gl.viewTo)&&gl.renderedView==gl.view&&db(gq)==0){return false}if(d5(gq)){ex(gq);gk.dims=fd(gq)}var gj=gp.first+gp.size;var gn=Math.max(gk.visible.from-gq.options.viewportMargin,gp.first);var go=Math.min(gj,gk.visible.to+gq.options.viewportMargin);if(gl.viewFrom<gn&&gn-gl.viewFrom<20){gn=Math.max(gp.first,gl.viewFrom)}if(gl.viewTo>go&&gl.viewTo-go<20){go=Math.min(gj,gl.viewTo)}if(a8){gn=aW(gq.doc,gn);go=d2(gq.doc,go)}var gi=gn!=gl.viewFrom||go!=gl.viewTo||gl.lastWrapHeight!=gk.wrapperHeight||gl.lastWrapWidth!=gk.wrapperWidth;cR(gq,gn,go);gl.viewOffset=bM(ff(gq.doc,gl.viewFrom));gq.display.mover.style.top=gl.viewOffset+"px";var gh=db(gq);if(!gi&&gh==0&&!gk.force&&gl.renderedView==gl.view&&(gl.updateLineNumbers==null||gl.updateLineNumbers>=gl.viewTo)){return false}var gm=dO();if(gh>4){gl.lineDiv.style.display="none"}cm(gq,gl.updateLineNumbers,gk.dims);if(gh>4){gl.lineDiv.style.display=""}gl.renderedView=gl.view;if(gm&&dO()!=gm&&gm.offsetHeight){gm.focus()}d1(gl.cursorDiv);d1(gl.selectionDiv);gl.gutters.style.height=0;if(gi){gl.lastWrapHeight=gk.wrapperHeight;gl.lastWrapWidth=gk.wrapperWidth;ef(gq,400)}gl.updateLineNumbers=null;return true}function cj(gi,gl){var gh=gl.viewport;for(var gk=true;;gk=false){if(!gk||!gi.options.lineWrapping||gl.oldDisplayWidth==dl(gi)){if(gh&&gh.top!=null){gh={top:Math.min(gi.doc.height+bI(gi.display)-cV(gi),gh.top)}}gl.visible=b6(gi.display,gi.doc,gh);if(gl.visible.from>=gi.display.viewFrom&&gl.visible.to<=gi.display.viewTo){break}}if(!B(gi,gl)){break}ba(gi);var gj=dA(gi);bC(gi);dz(gi,gj);eY(gi,gj)}gl.signal(gi,"update",gi);if(gi.display.viewFrom!=gi.display.reportedViewFrom||gi.display.viewTo!=gi.display.reportedViewTo){gl.signal(gi,"viewportChange",gi,gi.display.viewFrom,gi.display.viewTo);gi.display.reportedViewFrom=gi.display.viewFrom;gi.display.reportedViewTo=gi.display.viewTo}}function dT(gi,gh){var gk=new aI(gi,gh);if(B(gi,gk)){ba(gi);cj(gi,gk);var gj=dA(gi);bC(gi);dz(gi,gj);eY(gi,gj);gk.finish()}}function dz(gh,gi){gh.display.sizer.style.minHeight=gi.docHeight+"px";var gj=gi.docHeight+gh.display.barHeight;gh.display.heightForcer.style.top=gj+"px";gh.display.gutters.style.height=Math.max(gj+cT(gh),gi.clientHeight)+"px"}function ba(go){var gm=go.display;var gi=gm.lineDiv.offsetTop;for(var gj=0;gj<gm.view.length;gj++){var gp=gm.view[gj],gq;if(gp.hidden){continue}if(dK&&k<8){var gl=gp.node.offsetTop+gp.node.offsetHeight;gq=gl-gi;gi=gl}else{var gk=gp.node.getBoundingClientRect();gq=gk.bottom-gk.top}var gn=gp.line.height-gq;if(gq<2){gq=aY(gm)}if(gn>0.001||gn<-0.001){f5(gp.line,gq);cb(gp.line);if(gp.rest){for(var gh=0;gh<gp.rest.length;gh++){cb(gp.rest[gh])}}}}}function cb(gh){if(gh.widgets){for(var gi=0;gi<gh.widgets.length;++gi){gh.widgets[gi].height=gh.widgets[gi].node.offsetHeight}}}function fd(gh){var gm=gh.display,gk={},gj={};var gl=gm.gutters.clientLeft;for(var gn=gm.gutters.firstChild,gi=0;gn;gn=gn.nextSibling,++gi){gk[gh.options.gutters[gi]]=gn.offsetLeft+gn.clientLeft+gl;gj[gh.options.gutters[gi]]=gn.clientWidth}return{fixedPos:dX(gm),gutterTotalWidth:gm.gutters.offsetWidth,gutterLeft:gk,gutterWidth:gj,wrapperWidth:gm.wrapper.clientWidth}}function cm(gs,gj,gr){var go=gs.display,gu=gs.options.lineNumbers;var gh=go.lineDiv,gt=gh.firstChild;function gn(gw){var gv=gw.nextSibling;if(c0&&b7&&gs.display.currentWheelTarget==gw){gw.style.display="none"}else{gw.parentNode.removeChild(gw)}return gv}var gp=go.view,gm=go.viewFrom;for(var gk=0;gk<gp.length;gk++){var gl=gp[gk];if(gl.hidden){}else{if(!gl.node||gl.node.parentNode!=gh){var gi=aF(gs,gl,gm,gr);gh.insertBefore(gi,gt)}else{while(gt!=gl.node){gt=gn(gt)}var gq=gu&&gj!=null&&gj<=gm&&gl.lineNumber;if(gl.changes){if(dh(gl.changes,"gutter")>-1){gq=false}ab(gs,gl,gm,gr)}if(gq){d1(gl.lineNumber);gl.lineNumber.appendChild(document.createTextNode(es(gs.options,gm)))}gt=gl.node.nextSibling}}gm+=gl.size}while(gt){gt=gn(gt)}}function ab(gh,gj,gl,gm){for(var gi=0;gi<gj.changes.length;gi++){var gk=gj.changes[gi];if(gk=="text"){fl(gh,gj)}else{if(gk=="gutter"){df(gh,gj,gl,gm)}else{if(gk=="class"){dG(gj)}else{if(gk=="widget"){ao(gh,gj,gm)}}}}}gj.changes=null}function fH(gh){if(gh.node==gh.text){gh.node=f2("div",null,null,"position: relative");if(gh.text.parentNode){gh.text.parentNode.replaceChild(gh.node,gh.text)}gh.node.appendChild(gh.text);if(dK&&k<8){gh.node.style.zIndex=2}}return gh.node}function ev(gi){var gh=gi.bgClass?gi.bgClass+" "+(gi.line.bgClass||""):gi.line.bgClass;if(gh){gh+=" CodeMirror-linebackground"}if(gi.background){if(gh){gi.background.className=gh}else{gi.background.parentNode.removeChild(gi.background);gi.background=null}}else{if(gh){var gj=fH(gi);gi.background=gj.insertBefore(f2("div",null,gh),gj.firstChild)}}}function dV(gh,gi){var gj=gh.display.externalMeasured;if(gj&&gj.line==gi.line){gh.display.externalMeasured=null;gi.measure=gj.measure;return gj.built}return eR(gh,gi)}function fl(gh,gk){var gi=gk.text.className;var gj=dV(gh,gk);if(gk.text==gk.node){gk.node=gj.pre}gk.text.parentNode.replaceChild(gj.pre,gk.text);gk.text=gj.pre;if(gj.bgClass!=gk.bgClass||gj.textClass!=gk.textClass){gk.bgClass=gj.bgClass;gk.textClass=gj.textClass;dG(gk)}else{if(gi){gk.text.className=gi}}}function dG(gi){ev(gi);if(gi.line.wrapClass){fH(gi).className=gi.line.wrapClass}else{if(gi.node!=gi.text){gi.node.className=""}}var gh=gi.textClass?gi.textClass+" "+(gi.line.textClass||""):gi.line.textClass;gi.text.className=gh||""}function df(gp,gn,gm,go){if(gn.gutter){gn.node.removeChild(gn.gutter);gn.gutter=null}var gk=gn.line.gutterMarkers;if(gp.options.lineNumbers||gk){var gi=fH(gn);var gl=gn.gutter=f2("div",null,"CodeMirror-gutter-wrapper","left: "+(gp.options.fixedGutter?go.fixedPos:-go.gutterTotalWidth)+"px; width: "+go.gutterTotalWidth+"px");gp.display.input.setUneditable(gl);gi.insertBefore(gl,gn.text);if(gn.line.gutterClass){gl.className+=" "+gn.line.gutterClass}if(gp.options.lineNumbers&&(!gk||!gk["CodeMirror-linenumbers"])){gn.lineNumber=gl.appendChild(f2("div",es(gp.options,gm),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+go.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+gp.display.lineNumInnerWidth+"px"))}if(gk){for(var gj=0;gj<gp.options.gutters.length;++gj){var gh=gp.options.gutters[gj],gq=gk.hasOwnProperty(gh)&&gk[gh];if(gq){gl.appendChild(f2("div",[gq],"CodeMirror-gutter-elt","left: "+go.gutterLeft[gh]+"px; width: "+go.gutterWidth[gh]+"px"))}}}}}function ao(gh,gi,gl){if(gi.alignable){gi.alignable=null}for(var gk=gi.node.firstChild,gj;gk;gk=gj){var gj=gk.nextSibling;if(gk.className=="CodeMirror-linewidget"){gi.node.removeChild(gk)}}ft(gh,gi,gl)}function aF(gh,gj,gk,gl){var gi=dV(gh,gj);gj.text=gj.node=gi.pre;if(gi.bgClass){gj.bgClass=gi.bgClass}if(gi.textClass){gj.textClass=gi.textClass}dG(gj);df(gh,gj,gk,gl);ft(gh,gj,gl);return gj.node}function ft(gh,gj,gk){f7(gh,gj.line,gj,gk,true);if(gj.rest){for(var gi=0;gi<gj.rest.length;gi++){f7(gh,gj.rest[gi],gj,gk,false)}}}function f7(gp,gq,gm,go,gk){if(!gq.widgets){return}var gh=fH(gm);for(var gj=0,gn=gq.widgets;gj<gn.length;++gj){var gl=gn[gj],gi=f2("div",[gl.node],"CodeMirror-linewidget");if(!gl.handleMouseEvents){gi.setAttribute("cm-ignore-events","true")}bF(gl,gi,gm,go);gp.display.input.setUneditable(gi);if(gk&&gl.above){gh.insertBefore(gi,gm.gutter||gm.text)}else{gh.appendChild(gi)}ae(gl,"redraw")}}function bF(gk,gj,gh,gl){if(gk.noHScroll){(gh.alignable||(gh.alignable=[])).push(gj);var gi=gl.wrapperWidth;gj.style.left=gl.fixedPos+"px";if(!gk.coverGutter){gi-=gl.gutterTotalWidth;gj.style.paddingLeft=gl.gutterTotalWidth+"px"}gj.style.width=gi+"px"}if(gk.coverGutter){gj.style.zIndex=5;gj.style.position="relative";if(!gk.noHScroll){gj.style.marginLeft=-gl.gutterTotalWidth+"px"}}}var W=H.Pos=function(gh,gi){if(!(this instanceof W)){return new W(gh,gi)}this.line=gh;this.ch=gi};var cf=H.cmpPos=function(gi,gh){return gi.line-gh.line||gi.ch-gh.ch};function ci(gh){return W(gh.line,gh.ch)}function bx(gi,gh){return cf(gi,gh)<0?gh:gi}function ar(gi,gh){return cf(gi,gh)<0?gi:gh}function r(gh){if(!gh.state.focused){gh.display.input.focus();cB(gh)}}function aj(gh){return gh.options.readOnly||gh.doc.cantEdit}var bm=null;function fY(gu,gk,gj,gi,gt){var gs=gu.doc;gu.display.shift=false;if(!gi){gi=gs.sel}var gn=a1(gk),gh=null;if(gu.state.pasteIncoming&&gi.ranges.length>1){if(bm&&bm.join("\n")==gk){gh=gi.ranges.length%bm.length==0&&bS(bm,a1)}else{if(gn.length==gi.ranges.length){gh=bS(gn,function(gv){return[gv]})}}}for(var gl=gi.ranges.length-1;gl>=0;gl--){var gm=gi.ranges[gl];var gr=gm.from(),gq=gm.to();if(gm.empty()){if(gj&&gj>0){gr=W(gr.line,gr.ch-gj)}else{if(gu.state.overwrite&&!gu.state.pasteIncoming){gq=W(gq.line,Math.min(ff(gs,gq.line).text.length,gq.ch+fG(gn).length))}}}var go=gu.curOp.updateInput;var gp={from:gr,to:gq,text:gh?gh[gl%gh.length]:gn,origin:gt||(gu.state.pasteIncoming?"paste":gu.state.cutIncoming?"cut":"+input")};bg(gu.doc,gp);ae(gu,"inputRead",gu,gp)}if(gk&&!gu.state.pasteIncoming){fV(gu,gk)}fF(gu);gu.curOp.updateInput=go;gu.curOp.typing=true;gu.state.pasteIncoming=gu.state.cutIncoming=false}function fV(gh,gl){if(!gh.options.electricChars||!gh.options.smartIndent){return}var gm=gh.doc.sel;for(var gk=gm.ranges.length-1;gk>=0;gk--){var gi=gm.ranges[gk];if(gi.head.ch>100||(gk&&gm.ranges[gk-1].head.line==gi.head.line)){continue}var gn=gh.getModeAt(gi.head);var go=false;if(gn.electricChars){for(var gj=0;gj<gn.electricChars.length;gj++){if(gl.indexOf(gn.electricChars.charAt(gj))>-1){go=ad(gh,gi.head.line,"smart");break}}}else{if(gn.electricInput){if(gn.electricInput.test(ff(gh.doc,gi.head.line).text.slice(0,gi.head.ch))){go=ad(gh,gi.head.line,"smart")}}}if(go){ae(gh,"electricInput",gh,gi.head.line)}}}function dj(gh){var gm=[],gj=[];for(var gk=0;gk<gh.doc.sel.ranges.length;gk++){var gi=gh.doc.sel.ranges[gk].head.line;var gl={anchor:W(gi,0),head:W(gi+1,0)};gj.push(gl);gm.push(gh.getRange(gl.anchor,gl.head))}return{text:gm,ranges:gj}}function fP(gh){gh.setAttribute("autocorrect","off");gh.setAttribute("autocapitalize","off");gh.setAttribute("spellcheck","false")}function Y(gh){this.cm=gh;this.prevInput="";this.pollingFast=false;this.polling=new gg();this.inaccurateSelection=false;this.hasSelection=false;this.composing=null}function aX(){var gh=f2("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none");var gi=f2("div",[gh],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");if(c0){gh.style.width="1000px"}else{gh.setAttribute("wrap","off")}if(e1){gh.style.border="1px solid black"}fP(gh);return gi}Y.prototype=aN({init:function(gj){var gi=this,gh=this.cm;var gm=this.wrapper=aX();var gk=this.textarea=gm.firstChild;gj.wrapper.insertBefore(gm,gj.wrapper.firstChild);if(e1){gk.style.width="0px"}bX(gk,"input",function(){if(dK&&k>=9&&gi.hasSelection){gi.hasSelection=null}gi.poll()});bX(gk,"paste",function(){if(c0&&!gh.state.fakedLastChar&&!(new Date-gh.state.lastMiddleDown<200)){var go=gk.selectionStart,gn=gk.selectionEnd;gk.value+="$";gk.selectionEnd=gn;gk.selectionStart=go;gh.state.fakedLastChar=true}gh.state.pasteIncoming=true;gi.fastPoll()});function gl(go){if(gh.somethingSelected()){bm=gh.getSelections();if(gi.inaccurateSelection){gi.prevInput="";gi.inaccurateSelection=false;gk.value=bm.join("\n");dL(gk)}}else{if(!gh.options.lineWiseCopyCut){return}else{var gn=dj(gh);bm=gn.text;if(go.type=="cut"){gh.setSelections(gn.ranges,null,Z)}else{gi.prevInput="";gk.value=gn.text.join("\n");dL(gk)}}}if(go.type=="cut"){gh.state.cutIncoming=true}}bX(gk,"cut",gl);bX(gk,"copy",gl);bX(gj.scroller,"paste",function(gn){if(bb(gj,gn)){return}gh.state.pasteIncoming=true;gi.focus()});bX(gj.lineSpace,"selectstart",function(gn){if(!bb(gj,gn)){cG(gn)}});bX(gk,"compositionstart",function(){var gn=gh.getCursor("from");gi.composing={start:gn,range:gh.markText(gn,gh.getCursor("to"),{className:"CodeMirror-composing"})}});bX(gk,"compositionend",function(){if(gi.composing){gi.poll();gi.composing.range.clear();gi.composing=null}})},prepareSelection:function(){var gi=this.cm,gm=gi.display,gl=gi.doc;var gh=fI(gi);if(gi.options.moveInputWithCursor){var gn=dU(gi,gl.sel.primary().head,"div");var gj=gm.wrapper.getBoundingClientRect(),gk=gm.lineDiv.getBoundingClientRect();gh.teTop=Math.max(0,Math.min(gm.wrapper.clientHeight-10,gn.top+gk.top-gj.top));gh.teLeft=Math.max(0,Math.min(gm.wrapper.clientWidth-10,gn.left+gk.left-gj.left))}return gh},showSelection:function(gj){var gh=this.cm,gi=gh.display;bR(gi.cursorDiv,gj.cursors);bR(gi.selectionDiv,gj.selection);if(gj.teTop!=null){this.wrapper.style.top=gj.teTop+"px";this.wrapper.style.left=gj.teLeft+"px"}},reset:function(gl){if(this.contextMenuPending){return}var gi,gk,gh=this.cm,gn=gh.doc;if(gh.somethingSelected()){this.prevInput="";var gj=gn.sel.primary();gi=da&&(gj.to().line-gj.from().line>100||(gk=gh.getSelection()).length>1000);var gm=gi?"-":gk||gh.getSelection();this.textarea.value=gm;if(gh.state.focused){dL(this.textarea)}if(dK&&k>=9){this.hasSelection=gm}}else{if(!gl){this.prevInput=this.textarea.value="";if(dK&&k>=9){this.hasSelection=null}}}this.inaccurateSelection=gi},getField:function(){return this.textarea},supportsTouch:function(){return false},focus:function(){if(this.cm.options.readOnly!="nocursor"&&(!eg||dO()!=this.textarea)){try{this.textarea.focus()}catch(gh){}}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var gh=this;if(gh.pollingFast){return}gh.polling.set(this.cm.options.pollInterval,function(){gh.poll();if(gh.cm.state.focused){gh.slowPoll()}})},fastPoll:function(){var gi=false,gh=this;gh.pollingFast=true;function gj(){var gk=gh.poll();if(!gk&&!gi){gi=true;gh.polling.set(60,gj)}else{gh.pollingFast=false;gh.slowPoll()}}gh.polling.set(20,gj)},poll:function(){var gh=this.cm,gk=this.textarea,gl=this.prevInput;if(!gh.state.focused||(bs(gk)&&!gl)||aj(gh)||gh.options.disableInput||gh.state.keySeq){return false}if(gh.state.pasteIncoming&&gh.state.fakedLastChar){gk.value=gk.value.substring(0,gk.value.length-1);gh.state.fakedLastChar=false}var gn=gk.value;if(gn==gl&&!gh.somethingSelected()){return false}if(dK&&k>=9&&this.hasSelection===gn||b7&&/[\uf700-\uf7ff]/.test(gn)){gh.display.input.reset();return false}if(gh.doc.sel==gh.display.selForContextMenu){var gm=gn.charCodeAt(0);if(gm==8203&&!gl){gl="\u200b"}if(gm==8666){this.reset();return this.cm.execCommand("undo")}}var go=0,gi=Math.min(gl.length,gn.length);while(go<gi&&gl.charCodeAt(go)==gn.charCodeAt(go)){++go}var gj=this;cM(gh,function(){fY(gh,gn.slice(go),gl.length-go,null,gj.composing?"*compose":null);if(gn.length>1000||gn.indexOf("\n")>-1){gk.value=gj.prevInput=""}else{gj.prevInput=gn}if(gj.composing){gj.composing.range.clear();gj.composing.range=gh.markText(gj.composing.start,gh.getCursor("to"),{className:"CodeMirror-composing"})}});return true},ensurePolled:function(){if(this.pollingFast&&this.poll()){this.pollingFast=false}},onKeyPress:function(){if(dK&&k>=9){this.hasSelection=null}this.fastPoll()},onContextMenu:function(gm){var gr=this,gs=gr.cm,go=gs.display,gi=gr.textarea;var gq=cn(gs,gm),gh=go.scroller.scrollTop;if(!gq||d3){return}var gl=gs.options.resetSelectionOnContextMenu;if(gl&&gs.doc.sel.contains(gq)==-1){c2(gs,bU)(gs.doc,eS(gq),Z)}var gn=gi.style.cssText;gr.wrapper.style.position="absolute";gi.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(gm.clientY-5)+"px; left: "+(gm.clientX-5)+"px; z-index: 1000; background: "+(dK?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";if(c0){var gt=window.scrollY}go.input.focus();if(c0){window.scrollTo(null,gt)}go.input.reset();if(!gs.somethingSelected()){gi.value=gr.prevInput=" "}gr.contextMenuPending=true;go.selForContextMenu=gs.doc.sel;clearTimeout(go.detectingSelectAll);function gk(){if(gi.selectionStart!=null){var gu=gs.somethingSelected();var gv="\u200b"+(gu?gi.value:"");gi.value="\u21da";gi.value=gv;gr.prevInput=gu?"":"\u200b";gi.selectionStart=1;gi.selectionEnd=gv.length;go.selForContextMenu=gs.doc.sel}}function gp(){gr.contextMenuPending=false;gr.wrapper.style.position="relative";gi.style.cssText=gn;if(dK&&k<9){go.scrollbars.setScrollTop(go.scroller.scrollTop=gh)}if(gi.selectionStart!=null){if(!dK||(dK&&k<9)){gk()}var gu=0,gv=function(){if(go.selForContextMenu==gs.doc.sel&&gi.selectionStart==0&&gi.selectionEnd>0&&gr.prevInput=="\u200b"){c2(gs,eD.selectAll)(gs)}else{if(gu++<10){go.detectingSelectAll=setTimeout(gv,500)}else{go.input.reset()}}};go.detectingSelectAll=setTimeout(gv,200)}}if(dK&&k>=9){gk()}if(f9){er(gm);var gj=function(){ed(window,"mouseup",gj);setTimeout(gp,20)};bX(window,"mouseup",gj)}else{setTimeout(gp,50)}},setUneditable:fU,needsContentAttribute:false},Y.prototype);function dv(gh){this.cm=gh;this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null;this.polling=new gg();this.gracePeriod=false}dv.prototype=aN({init:function(gk){var gj=this,gh=gj.cm;var gl=gj.div=gk.lineDiv;gl.contentEditable="true";fP(gl);bX(gl,"paste",function(gn){var gm=gn.clipboardData&&gn.clipboardData.getData("text/plain");if(gm){gn.preventDefault();gh.replaceSelection(gm,null,"paste")}});bX(gl,"compositionstart",function(gq){var gp=gq.data;gj.composing={sel:gh.doc.sel,data:gp,startData:gp};if(!gp){return}var gn=gh.doc.sel.primary();var gm=gh.getLine(gn.head.line);var go=gm.indexOf(gp,Math.max(0,gn.head.ch-gp.length));if(go>-1&&go<=gn.head.ch){gj.composing.sel=eS(W(gn.head.line,go),W(gn.head.line,go+gp.length))}});bX(gl,"compositionupdate",function(gm){gj.composing.data=gm.data});bX(gl,"compositionend",function(gn){var gm=gj.composing;if(!gm){return}if(gn.data!=gm.startData&&!/\u200b/.test(gn.data)){gm.data=gn.data}setTimeout(function(){if(!gm.handled){gj.applyComposition(gm)}if(gj.composing==gm){gj.composing=null}},50)});bX(gl,"touchstart",function(){gj.forceCompositionEnd()});bX(gl,"input",function(){if(gj.composing){return}if(!gj.pollContent()){cM(gj.cm,function(){ah(gh)})}});function gi(gp){if(gh.somethingSelected()){bm=gh.getSelections();if(gp.type=="cut"){gh.replaceSelection("",null,"cut")}}else{if(!gh.options.lineWiseCopyCut){return}else{var gn=dj(gh);bm=gn.text;if(gp.type=="cut"){gh.operation(function(){gh.setSelections(gn.ranges,0,Z);gh.replaceSelection("",null,"cut")})}}}if(gp.clipboardData&&!e1){gp.preventDefault();gp.clipboardData.clearData();gp.clipboardData.setData("text/plain",bm.join("\n"))}else{var go=aX(),gq=go.firstChild;gh.display.lineSpace.insertBefore(go,gh.display.lineSpace.firstChild);gq.value=bm.join("\n");var gm=document.activeElement;dL(gq);setTimeout(function(){gh.display.lineSpace.removeChild(go);gm.focus()},50)}}bX(gl,"copy",gi);bX(gl,"cut",gi)},prepareSelection:function(){var gh=fI(this.cm,false);gh.focus=this.cm.state.focused;return gh},showSelection:function(gh){if(!gh||!this.cm.display.view.length){return}if(gh.focus){this.showPrimarySelection()}this.showMultipleSelections(gh)},showPrimarySelection:function(){var gl=window.getSelection(),go=this.cm.doc.sel.primary();var gm=az(this.cm,gl.anchorNode,gl.anchorOffset);var gq=az(this.cm,gl.focusNode,gl.focusOffset);if(gm&&!gm.bad&&gq&&!gq.bad&&cf(ar(gm,gq),go.from())==0&&cf(bx(gm,gq),go.to())==0){return}var gk=cz(this.cm,go.from());var gp=cz(this.cm,go.to());if(!gk&&!gp){return}var gs=this.cm.display.view;var gn=gl.rangeCount&&gl.getRangeAt(0);if(!gk){gk={node:gs[0].measure.map[2],offset:0}}else{if(!gp){var gj=gs[gs.length-1].measure;var gi=gj.maps?gj.maps[gj.maps.length-1]:gj.map;gp={node:gi[gi.length-1],offset:gi[gi.length-2]-gi[gi.length-3]}}}try{var gh=cl(gk.node,gk.offset,gp.offset,gp.node)}catch(gr){}if(gh){gl.removeAllRanges();gl.addRange(gh);if(gn&&gl.anchorNode==null){gl.addRange(gn)}else{if(co){this.startGracePeriod()}}}this.rememberSelection()},startGracePeriod:function(){var gh=this;clearTimeout(this.gracePeriod);this.gracePeriod=setTimeout(function(){gh.gracePeriod=false;if(gh.selectionChanged()){gh.cm.operation(function(){gh.cm.curOp.selectionChanged=true})}},20)},showMultipleSelections:function(gh){bR(this.cm.display.cursorDiv,gh.cursors);bR(this.cm.display.selectionDiv,gh.selection)},rememberSelection:function(){var gh=window.getSelection();this.lastAnchorNode=gh.anchorNode;this.lastAnchorOffset=gh.anchorOffset;this.lastFocusNode=gh.focusNode;this.lastFocusOffset=gh.focusOffset},selectionInEditor:function(){var gi=window.getSelection();if(!gi.rangeCount){return false}var gh=gi.getRangeAt(0).commonAncestorContainer;return ga(this.div,gh)},focus:function(){if(this.cm.options.readOnly!="nocursor"){this.div.focus()}},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return true},receivedFocus:function(){var gh=this;if(this.selectionInEditor()){this.pollSelection()}else{cM(this.cm,function(){gh.cm.curOp.selectionChanged=true})}function gi(){if(gh.cm.state.focused){gh.pollSelection();gh.polling.set(gh.cm.options.pollInterval,gi)}}this.polling.set(this.cm.options.pollInterval,gi)},selectionChanged:function(){var gh=window.getSelection();return gh.anchorNode!=this.lastAnchorNode||gh.anchorOffset!=this.lastAnchorOffset||gh.focusNode!=this.lastFocusNode||gh.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var gk=window.getSelection(),gh=this.cm;this.rememberSelection();var gi=az(gh,gk.anchorNode,gk.anchorOffset);var gj=az(gh,gk.focusNode,gk.focusOffset);if(gi&&gj){cM(gh,function(){bU(gh.doc,eS(gi,gj),Z);if(gi.bad||gj.bad){gh.curOp.selectionChanged=true}})}}},pollContent:function(){var gr=this.cm,gB=gr.display,gz=gr.doc.sel.primary();var gA=gz.from(),gl=gz.to();if(gA.line<gB.viewFrom||gl.line>gB.viewTo-1){return false}var go;if(gA.line==gB.viewFrom||(go=dr(gr,gA.line))==0){var gm=bN(gB.view[0].line);var gq=gB.view[0].node}else{var gm=bN(gB.view[go].line);var gq=gB.view[go-1].node.nextSibling}var gy=dr(gr,gl.line);if(gy==gB.view.length-1){var gt=gB.viewTo-1;var gw=gB.view[gy].node}else{var gt=bN(gB.view[gy+1].line)-1;var gw=gB.view[gy+1].node.previousSibling}var gC=a1(fZ(gr,gq,gw,gm,gt));var gv=f4(gr.doc,W(gm,0),W(gt,ff(gr.doc,gt).text.length));while(gC.length>1&&gv.length>1){if(fG(gC)==fG(gv)){gC.pop();gv.pop();gt--}else{if(gC[0]==gv[0]){gC.shift();gv.shift();gm++}else{break}}}var gx=0,gj=0;var gs=gC[0],gi=gv[0],gh=Math.min(gs.length,gi.length);while(gx<gh&&gs.charCodeAt(gx)==gi.charCodeAt(gx)){++gx}var gp=fG(gC),gD=fG(gv);var gk=Math.min(gp.length-(gC.length==1?gx:0),gD.length-(gv.length==1?gx:0));while(gj<gk&&gp.charCodeAt(gp.length-gj-1)==gD.charCodeAt(gD.length-gj-1)){++gj}gC[gC.length-1]=gp.slice(0,gp.length-gj);gC[0]=gC[0].slice(gx);var gn=W(gm,gx);var gu=W(gt,gv.length?fG(gv).length-gj:0);if(gC.length>1||gC[0]||cf(gn,gu)){a2(gr.doc,gC,gn,gu,"+input");return true}},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){if(!this.composing||this.composing.handled){return}this.applyComposition(this.composing);this.composing.handled=true;this.div.blur();this.div.focus()},applyComposition:function(gh){if(gh.data&&gh.data!=gh.startData){c2(this.cm,fY)(this.cm,gh.data,0,gh.sel)}},setUneditable:function(gh){gh.setAttribute("contenteditable","false")},onKeyPress:function(gh){gh.preventDefault();c2(this.cm,fY)(this.cm,String.fromCharCode(gh.charCode==null?gh.keyCode:gh.charCode),0)},onContextMenu:fU,resetPosition:fU,needsContentAttribute:true},dv.prototype);function cz(gn,gl){var gm=fb(gn,gl.line);if(!gm||gm.hidden){return null}var gp=ff(gn.doc,gl.line);var gi=ct(gm,gp,gl.line);var gj=a(gp),gk="left";if(gj){var gh=aG(gj,gl.ch);gk=gh%2?"right":"left"}var go=aL(gi.map,gl.ch,gk);go.offset=go.collapse=="right"?go.end:go.start;return go}function et(gi,gh){if(gh){gi.bad=true}return gi}function az(gh,gk,gm){var gl;if(gk==gh.display.lineDiv){gl=gh.display.lineDiv.childNodes[gm];if(!gl){return et(gh.clipPos(W(gh.display.viewTo-1)),true)}gk=null;gm=0}else{for(gl=gk;;gl=gl.parentNode){if(!gl||gl==gh.display.lineDiv){return null}if(gl.parentNode&&gl.parentNode==gh.display.lineDiv){break}}}for(var gj=0;gj<gh.display.view.length;gj++){var gi=gh.display.view[gj];if(gi.node==gl){return aa(gi,gk,gm)}}}function aa(gp,gl,gn){var gj=gp.text.firstChild,gk=false;if(!gl||!ga(gj,gl)){return et(W(bN(gp.line),0),true)}if(gl==gj){gk=true;gl=gj.childNodes[gn];gn=0;if(!gl){var gv=gp.rest?fG(gp.rest):gp.line;return et(W(bN(gv),gv.text.length),gk)}}var gm=gl.nodeType==3?gl:null,gt=gl;if(!gm&&gl.childNodes.length==1&&gl.firstChild.nodeType==3){gm=gl.firstChild;if(gn){gn=gm.nodeValue.length}}while(gt.parentNode!=gj){gt=gt.parentNode}var gi=gp.measure,gr=gi.maps;function go(gy,gD,gA){for(var gC=-1;gC<(gr?gr.length:0);gC++){var gx=gC<0?gi.map:gr[gC];for(var gB=0;gB<gx.length;gB+=3){var gz=gx[gB+2];if(gz==gy||gz==gD){var gE=bN(gC<0?gp.line:gp.rest[gC]);var gw=gx[gB]+gA;if(gA<0||gz!=gy){gw=gx[gB+(gA?1:0)]}return W(gE,gw)}}}}var gu=go(gm,gt,gn);if(gu){return et(gu,gk)}for(var gh=gt.nextSibling,gq=gm?gm.nodeValue.length-gn:0;gh;gh=gh.nextSibling){gu=go(gh,gh.firstChild,0);if(gu){return et(W(gu.line,gu.ch-gq),gk)}else{gq+=gh.textContent.length}}for(var gs=gt.previousSibling,gq=gn;gs;gs=gs.previousSibling){gu=go(gs,gs.firstChild,-1);if(gu){return et(W(gu.line,gu.ch+gq),gk)}else{gq+=gh.textContent.length}}}function fZ(go,gm,gn,gj,gh){var gp="",gi=false;function gk(gq){return function(gr){return gr.id==gq}}function gl(gu){if(gu.nodeType==1){var gr=gu.getAttribute("cm-text");if(gr!=null){if(gr==""){gr=gu.textContent.replace(/\u200b/g,"")}gp+=gr;return}var gt=gu.getAttribute("cm-marker"),gq;if(gt){var gv=go.findMarks(W(gj,0),W(gh+1,0),gk(+gt));if(gv.length&&(gq=gv[0].find())){gp+=f4(go.doc,gq.from,gq.to).join("\n")}return}if(gu.getAttribute("contenteditable")=="false"){return}for(var gs=0;gs<gu.childNodes.length;gs++){gl(gu.childNodes[gs])}if(/^(pre|div|p)$/i.test(gu.nodeName)){gi=true}}else{if(gu.nodeType==3){var gw=gu.nodeValue;if(!gw){return}if(gi){gp+="\n";gi=false}gp+=gw}}}for(;;){gl(gm);if(gm==gn){break}gm=gm.nextSibling}return gp}H.inputStyles={textarea:Y,contenteditable:dv};function f3(gh,gi){this.ranges=gh;this.primIndex=gi}f3.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(gh){if(gh==this){return true}if(gh.primIndex!=this.primIndex||gh.ranges.length!=this.ranges.length){return false}for(var gj=0;gj<this.ranges.length;gj++){var gi=this.ranges[gj],gk=gh.ranges[gj];if(cf(gi.anchor,gk.anchor)!=0||cf(gi.head,gk.head)!=0){return false}}return true},deepCopy:function(){for(var gh=[],gi=0;gi<this.ranges.length;gi++){gh[gi]=new dY(ci(this.ranges[gi].anchor),ci(this.ranges[gi].head))}return new f3(gh,this.primIndex)},somethingSelected:function(){for(var gh=0;gh<this.ranges.length;gh++){if(!this.ranges[gh].empty()){return true}}return false},contains:function(gk,gh){if(!gh){gh=gk}for(var gj=0;gj<this.ranges.length;gj++){var gi=this.ranges[gj];if(cf(gh,gi.from())>=0&&cf(gk,gi.to())<=0){return gj}}return -1}};function dY(gh,gi){this.anchor=gh;this.head=gi}dY.prototype={from:function(){return ar(this.anchor,this.head)},to:function(){return bx(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};function cw(gh,go){var gj=gh[go];gh.sort(function(gr,gq){return cf(gr.from(),gq.from())});go=dh(gh,gj);for(var gl=1;gl<gh.length;gl++){var gp=gh[gl],gi=gh[gl-1];if(cf(gi.to(),gp.from())>=0){var gm=ar(gi.from(),gp.from()),gn=bx(gi.to(),gp.to());var gk=gi.empty()?gp.from()==gp.head:gi.from()==gi.head;if(gl<=go){--go}gh.splice(--gl,2,new dY(gk?gn:gm,gk?gm:gn))}}return new f3(gh,go)}function eS(gh,gi){return new f3([new dY(gh,gi||gh)],0)}function c5(gh,gi){return Math.max(gh.first,Math.min(gi,gh.first+gh.size-1))}function fJ(gi,gj){if(gj.line<gi.first){return W(gi.first,0)}var gh=gi.first+gi.size-1;if(gj.line>gh){return W(gh,ff(gi,gh).text.length)}return fs(gj,ff(gi,gj.line).text.length)}function fs(gj,gi){var gh=gj.ch;if(gh==null||gh>gi){return W(gj.line,gi)}else{if(gh<0){return W(gj.line,0)}else{return gj}}}function b9(gi,gh){return gh>=gi.first&&gh<gi.first+gi.size}function d0(gj,gk){for(var gh=[],gi=0;gi<gk.length;gi++){gh[gi]=fJ(gj,gk[gi])}return gh}function fv(gm,gi,gl,gh){if(gm.cm&&gm.cm.display.shift||gm.extend){var gk=gi.anchor;if(gh){var gj=cf(gl,gk)<0;if(gj!=(cf(gh,gk)<0)){gk=gl;gl=gh}else{if(gj!=(cf(gl,gh)<0)){gl=gh}}}return new dY(gk,gl)}else{return new dY(gh||gl,gl)}}function fW(gk,gj,gh,gi){bU(gk,new f3([fv(gk,gk.sel.primary(),gj,gh)],0),gi)}function aw(gm,gl,gj){for(var gi=[],gk=0;gk<gm.sel.ranges.length;gk++){gi[gk]=fv(gm,gm.sel.ranges[gk],gl[gk],null)}var gh=cw(gi,gm.sel.primIndex);bU(gm,gh,gj)}function e(gl,gk,gi,gj){var gh=gl.sel.ranges.slice(0);gh[gk]=gi;bU(gl,cw(gh,gl.sel.primIndex),gj)}function F(gk,gi,gj,gh){bU(gk,eS(gi,gj),gh)}function c(gj,gh){var gi={ranges:gh.ranges,update:function(gk){this.ranges=[];for(var gl=0;gl<gk.length;gl++){this.ranges[gl]=new dY(fJ(gj,gk[gl].anchor),fJ(gj,gk[gl].head))}}};aE(gj,"beforeSelectionChange",gj,gi);if(gj.cm){aE(gj.cm,"beforeSelectionChange",gj.cm,gi)}if(gi.ranges!=gh.ranges){return cw(gi.ranges,gi.ranges.length-1)}else{return gh}}function e7(gl,gk,gi){var gh=gl.history.done,gj=fG(gh);if(gj&&gj.ranges){gh[gh.length-1]=gk;ep(gl,gk,gi)}else{bU(gl,gk,gi)}}function bU(gj,gi,gh){ep(gj,gi,gh);gb(gj,gj.sel,gj.cm?gj.cm.curOp.id:NaN,gh)}function ep(gk,gj,gi){if(fi(gk,"beforeSelectionChange")||gk.cm&&fi(gk.cm,"beforeSelectionChange")){gj=c(gk,gj)}var gh=gi&&gi.bias||(cf(gj.primary().head,gk.sel.primary().head)<0?-1:1);c9(gk,n(gk,gj,gh,true));if(!(gi&&gi.scroll===false)&&gk.cm){fF(gk.cm)}}function c9(gi,gh){if(gh.equals(gi.sel)){return}gi.sel=gh;if(gi.cm){gi.cm.curOp.updateInput=gi.cm.curOp.selectionChanged=true;V(gi.cm)}ae(gi,"cursorActivity",gi)}function ey(gh){c9(gh,n(gh,gh.sel,null,false),Z)}function n(gp,gh,gm,gn){var gj;for(var gk=0;gk<gh.ranges.length;gk++){var gl=gh.ranges[gk];var go=bV(gp,gl.anchor,gm,gn);var gi=bV(gp,gl.head,gm,gn);if(gj||go!=gl.anchor||gi!=gl.head){if(!gj){gj=gh.ranges.slice(0,gk)}gj[gk]=new dY(go,gi)}}return gj?cw(gj,gh.primIndex):gh}function bV(gq,gp,gm,gn){var gr=false,gj=gp;var gk=gm||1;gq.cantEdit=false;search:for(;;){var gs=ff(gq,gj.line);if(gs.markedSpans){for(var gl=0;gl<gs.markedSpans.length;++gl){var gh=gs.markedSpans[gl],gi=gh.marker;if((gh.from==null||(gi.inclusiveLeft?gh.from<=gj.ch:gh.from<gj.ch))&&(gh.to==null||(gi.inclusiveRight?gh.to>=gj.ch:gh.to>gj.ch))){if(gn){aE(gi,"beforeCursorEnter");if(gi.explicitlyCleared){if(!gs.markedSpans){break}else{--gl;continue}}}if(!gi.atomic){continue}var go=gi.find(gk<0?-1:1);if(cf(go,gj)==0){go.ch+=gk;if(go.ch<0){if(go.line>gq.first){go=fJ(gq,W(go.line-1))}else{go=null}}else{if(go.ch>gs.text.length){if(go.line<gq.first+gq.size-1){go=W(go.line+1,0)}else{go=null}}}if(!go){if(gr){if(!gn){return bV(gq,gp,gm,true)}gq.cantEdit=true;return W(gq.first,0)}gr=true;go=gp;gk=-gk}}gj=go;continue search}}}return gj}}function bC(gh){gh.display.input.showSelection(gh.display.input.prepareSelection())}function fI(go,gh){var gn=go.doc,gp={};var gm=gp.cursors=document.createDocumentFragment();var gi=gp.selection=document.createDocumentFragment();for(var gk=0;gk<gn.sel.ranges.length;gk++){if(gh===false&&gk==gn.sel.primIndex){continue}var gl=gn.sel.ranges[gk];var gj=gl.empty();if(gj||go.options.showCursorWhenSelecting){A(go,gl,gm)}if(!gj){bD(go,gl,gi)}}return gp}function A(gh,gk,gj){var gm=dU(gh,gk.head,"div",null,null,!gh.options.singleCursorHeightPerLine);var gl=gj.appendChild(f2("div","\u00a0","CodeMirror-cursor"));gl.style.left=gm.left+"px";gl.style.top=gm.top+"px";gl.style.height=Math.max(0,gm.bottom-gm.top)*gh.options.cursorHeight+"px";if(gm.other){var gi=gj.appendChild(f2("div","\u00a0","CodeMirror-cursor CodeMirror-secondarycursor"));gi.style.display="";gi.style.left=gm.other.left+"px";gi.style.top=gm.other.top+"px";gi.style.height=(gm.other.bottom-gm.other.top)*0.85+"px"}}function bD(gl,gr,gm){var gu=gl.display,gy=gl.doc;var gh=document.createDocumentFragment();var gq=e5(gl.display),gk=gq.left;var gv=Math.max(gu.sizerWidth,dl(gl)-gu.sizer.offsetLeft)-gq.right;function gs(gC,gB,gA,gz){if(gB<0){gB=0}gB=Math.round(gB);gz=Math.round(gz);gh.appendChild(f2("div",null,"CodeMirror-selected","position: absolute; left: "+gC+"px; top: "+gB+"px; width: "+(gA==null?gv-gC:gA)+"px; height: "+(gz-gB)+"px"))}function gi(gA,gC,gF){var gB=ff(gy,gA);var gD=gB.text.length;var gG,gz;function gE(gI,gH){return cJ(gl,W(gA,gI),"div",gB,gH)}d4(a(gB),gC||0,gF==null?gD:gF,function(gO,gN,gH){var gK=gE(gO,"left"),gL,gM,gJ;if(gO==gN){gL=gK;gM=gJ=gK.left}else{gL=gE(gN-1,"right");if(gH=="rtl"){var gI=gK;gK=gL;gL=gI}gM=gK.left;gJ=gL.right}if(gC==null&&gO==0){gM=gk}if(gL.top-gK.top>3){gs(gM,gK.top,null,gK.bottom);gM=gk;if(gK.bottom<gL.top){gs(gM,gK.bottom,null,gL.top)}}if(gF==null&&gN==gD){gJ=gv}if(!gG||gK.top<gG.top||gK.top==gG.top&&gK.left<gG.left){gG=gK}if(!gz||gL.bottom>gz.bottom||gL.bottom==gz.bottom&&gL.right>gz.right){gz=gL}if(gM<gk+1){gM=gk}gs(gM,gL.top,gJ-gM,gL.bottom)});return{start:gG,end:gz}}var gx=gr.from(),gw=gr.to();if(gx.line==gw.line){gi(gx.line,gx.ch,gw.ch)}else{var gj=ff(gy,gx.line),go=ff(gy,gw.line);var gn=y(gj)==y(go);var gp=gi(gx.line,gx.ch,gn?gj.text.length+1:null).end;var gt=gi(gw.line,gn?0:null,gw.ch).start;if(gn){if(gp.top<gt.top-2){gs(gp.right,gp.top,null,gp.bottom);gs(gk,gt.top,gt.left,gt.bottom)}else{gs(gp.right,gp.top,gt.left-gp.right,gp.bottom)}}if(gp.bottom<gt.top){gs(gk,gp.bottom,null,gt.top)}}gm.appendChild(gh)}function o(gh){if(!gh.state.focused){return}var gj=gh.display;clearInterval(gj.blinker);var gi=true;gj.cursorDiv.style.visibility="";if(gh.options.cursorBlinkRate>0){gj.blinker=setInterval(function(){gj.cursorDiv.style.visibility=(gi=!gi)?"":"hidden"},gh.options.cursorBlinkRate)}else{if(gh.options.cursorBlinkRate<0){gj.cursorDiv.style.visibility="hidden"}}}function ef(gh,gi){if(gh.doc.mode.startState&&gh.doc.frontier<gh.display.viewTo){gh.state.highlight.set(gi,cv(cP,gh))}}function cP(gh){var gl=gh.doc;if(gl.frontier<gl.first){gl.frontier=gl.first}if(gl.frontier>=gh.display.viewTo){return}var gj=+new Date+gh.options.workTime;var gk=b3(gl.mode,dC(gh,gl.frontier));var gi=[];gl.iter(gl.frontier,Math.min(gl.first+gl.size,gh.display.viewTo+500),function(gm){if(gl.frontier>=gh.display.viewFrom){var gp=gm.styles;var gr=fz(gh,gm,gk,true);gm.styles=gr.styles;var go=gm.styleClasses,gq=gr.classes;if(gq){gm.styleClasses=gq}else{if(go){gm.styleClasses=null}}var gs=!gp||gp.length!=gm.styles.length||go!=gq&&(!go||!gq||go.bgClass!=gq.bgClass||go.textClass!=gq.textClass);for(var gn=0;!gs&&gn<gp.length;++gn){gs=gp[gn]!=gm.styles[gn]}if(gs){gi.push(gl.frontier)}gm.stateAfter=b3(gl.mode,gk)}else{dx(gh,gm.text,gk);gm.stateAfter=gl.frontier%5==0?b3(gl.mode,gk):null}++gl.frontier;if(+new Date>gj){ef(gh,gh.options.workDelay);return true}});if(gi.length){cM(gh,function(){for(var gm=0;gm<gi.length;gm++){R(gh,gi[gm],"text")}})}}function cy(gn,gh,gk){var gi,gl,gm=gn.doc;var gj=gk?-1:gh-(gn.doc.mode.innerMode?1000:100);for(var gq=gh;gq>gj;--gq){if(gq<=gm.first){return gm.first}var gp=ff(gm,gq-1);if(gp.stateAfter&&(!gk||gq<=gm.frontier)){return gq}var go=bT(gp.text,null,gn.options.tabSize);if(gl==null||gi>go){gl=gq-1;gi=go}}return gl}function dC(gh,gn,gi){var gl=gh.doc,gk=gh.display;if(!gl.mode.startState){return true}var gm=cy(gh,gn,gi),gj=gm>gl.first&&ff(gl,gm-1).stateAfter;if(!gj){gj=b0(gl.mode)}else{gj=b3(gl.mode,gj)}gl.iter(gm,gn,function(go){dx(gh,go.text,gj);var gp=gm==gn-1||gm%5==0||gm>=gk.viewFrom&&gm<gk.viewTo;go.stateAfter=gp?b3(gl.mode,gj):null;++gm});if(gi){gl.frontier=gm}return gj}function e8(gh){return gh.lineSpace.offsetTop}function bI(gh){return gh.mover.offsetHeight-gh.lineSpace.offsetHeight}function e5(gk){if(gk.cachedPaddingH){return gk.cachedPaddingH}var gj=bR(gk.measure,f2("pre","x"));var gh=window.getComputedStyle?window.getComputedStyle(gj):gj.currentStyle;var gi={left:parseInt(gh.paddingLeft),right:parseInt(gh.paddingRight)};if(!isNaN(gi.left)&&!isNaN(gi.right)){gk.cachedPaddingH=gi}return gi}function cT(gh){return dJ-gh.display.nativeBarWidth}function dl(gh){return gh.display.scroller.clientWidth-cT(gh)-gh.display.barWidth}function cV(gh){return gh.display.scroller.clientHeight-cT(gh)-gh.display.barHeight}function ch(go,gk,gn){var gj=go.options.lineWrapping;var gl=gj&&dl(go);if(!gk.measure.heights||gj&&gk.measure.width!=gl){var gm=gk.measure.heights=[];if(gj){gk.measure.width=gl;var gq=gk.text.firstChild.getClientRects();for(var gh=0;gh<gq.length-1;gh++){var gp=gq[gh],gi=gq[gh+1];if(Math.abs(gp.bottom-gi.bottom)>2){gm.push((gp.bottom+gi.top)/2-gn.top)}}}gm.push(gn.bottom-gn.top)}}function ct(gj,gh,gk){if(gj.line==gh){return{map:gj.measure.map,cache:gj.measure.cache}}for(var gi=0;gi<gj.rest.length;gi++){if(gj.rest[gi]==gh){return{map:gj.measure.maps[gi],cache:gj.measure.caches[gi]}}}for(var gi=0;gi<gj.rest.length;gi++){if(bN(gj.rest[gi])>gk){return{map:gj.measure.maps[gi],cache:gj.measure.caches[gi],before:true}}}}function c1(gh,gj){gj=y(gj);var gl=bN(gj);var gi=gh.display.externalMeasured=new bv(gh.doc,gj,gl);gi.lineN=gl;var gk=gi.built=eR(gh,gi);gi.text=gk.pre;bR(gh.display.lineMeasure,gk.pre);return gi}function eh(gh,gi,gk,gj){return C(gh,a5(gh,gi),gk,gj)}function fb(gh,gj){if(gj>=gh.display.viewFrom&&gj<gh.display.viewTo){return gh.display.view[dr(gh,gj)]}var gi=gh.display.externalMeasured;if(gi&&gj>=gi.lineN&&gj<gi.lineN+gi.size){return gi}}function a5(gh,gj){var gk=bN(gj);var gi=fb(gh,gk);if(gi&&!gi.text){gi=null}else{if(gi&&gi.changes){ab(gh,gi,gk,fd(gh))}}if(!gi){gi=c1(gh,gj)}var gl=ct(gi,gj,gk);return{line:gj,view:gi,rect:null,map:gl.map,cache:gl.cache,before:gl.before,hasHeights:false}}function C(gh,gn,gl,gi,gk){if(gn.before){gl=-1}var gj=gl+(gi||""),gm;if(gn.cache.hasOwnProperty(gj)){gm=gn.cache[gj]}else{if(!gn.rect){gn.rect=gn.view.text.getBoundingClientRect()}if(!gn.hasHeights){ch(gh,gn.view,gn.rect);gn.hasHeights=true}gm=j(gh,gn,gl,gi);if(!gm.bogus){gn.cache[gj]=gm}}return{left:gm.left,right:gm.right,top:gk?gm.rtop:gm.top,bottom:gk?gm.rbottom:gm.bottom}}var eB={left:0,right:0,top:0,bottom:0};function aL(gi,gh,go){var gk,gj,gm,gp;for(var gn=0;gn<gi.length;gn+=3){var gl=gi[gn],gq=gi[gn+1];if(gh<gl){gj=0;gm=1;gp="left"}else{if(gh<gq){gj=gh-gl;gm=gj+1}else{if(gn==gi.length-3||gh==gq&&gi[gn+3]>gh){gm=gq-gl;gj=gm-1;if(gh>=gq){gp="right"}}}}if(gj!=null){gk=gi[gn+2];if(gl==gq&&go==(gk.insertLeft?"left":"right")){gp=go}if(go=="left"&&gj==0){while(gn&&gi[gn-2]==gi[gn-3]&&gi[gn-1].insertLeft){gk=gi[(gn-=3)+2];gp="left"}}if(go=="right"&&gj==gq-gl){while(gn<gi.length-3&&gi[gn+3]==gi[gn+4]&&!gi[gn+5].insertLeft){gk=gi[(gn+=3)+2];gp="right"}}break}}return{node:gk,start:gj,end:gm,collapse:gp,coverStart:gl,coverEnd:gq}}function j(go,gy,gr,gm){var gp=aL(gy.map,gr,gm);var gw=gp.node,gl=gp.start,gk=gp.end,gh=gp.collapse;var gi;if(gw.nodeType==3){for(var gx=0;gx<4;gx++){while(gl&&fp(gy.line.text.charAt(gp.coverStart+gl))){--gl}while(gp.coverStart+gk<gp.coverEnd&&fp(gy.line.text.charAt(gp.coverStart+gk))){++gk}if(dK&&k<9&&gl==0&&gk==gp.coverEnd-gp.coverStart){gi=gw.parentNode.getBoundingClientRect()}else{if(dK&&go.options.lineWrapping){var gj=cl(gw,gl,gk).getClientRects();if(gj.length){gi=gj[gm=="right"?gj.length-1:0]}else{gi=eB}}else{gi=cl(gw,gl,gk).getBoundingClientRect()||eB}}if(gi.left||gi.right||gl==0){break}gk=gl;gl=gl-1;gh="right"}if(dK&&k<11){gi=eN(go.display.measure,gi)}}else{if(gl>0){gh=gm="right"}var gj;if(go.options.lineWrapping&&(gj=gw.getClientRects()).length>1){gi=gj[gm=="right"?gj.length-1:0]}else{gi=gw.getBoundingClientRect()}}if(dK&&k<9&&!gl&&(!gi||!gi.left&&!gi.right)){var gn=gw.parentNode.getClientRects()[0];if(gn){gi={left:gn.left,right:gn.left+dD(go.display),top:gn.top,bottom:gn.bottom}}else{gi=eB}}var gu=gi.top-gy.rect.top,gs=gi.bottom-gy.rect.top;var gA=(gu+gs)/2;var gz=gy.view.measure.heights;for(var gx=0;gx<gz.length-1;gx++){if(gA<gz[gx]){break}}var gv=gx?gz[gx-1]:0,gt=gz[gx];var gq={left:(gh=="right"?gi.right:gi.left)-gy.rect.left,right:(gh=="left"?gi.left:gi.right)-gy.rect.left,top:gv,bottom:gt};if(!gi.left&&!gi.right){gq.bogus=true}if(!go.options.singleCursorHeightPerLine){gq.rtop=gu;gq.rbottom=gs}return gq}function eN(gj,gk){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!aK(gj)){return gk}var gi=screen.logicalXDPI/screen.deviceXDPI;var gh=screen.logicalYDPI/screen.deviceYDPI;return{left:gk.left*gi,right:gk.right*gi,top:gk.top*gh,bottom:gk.bottom*gh}}function au(gi){if(gi.measure){gi.measure.cache={};gi.measure.heights=null;if(gi.rest){for(var gh=0;gh<gi.rest.length;gh++){gi.measure.caches[gh]={}}}}}function aO(gh){gh.display.externalMeasure=null;d1(gh.display.lineMeasure);for(var gi=0;gi<gh.display.view.length;gi++){au(gh.display.view[gi])}}function ak(gh){aO(gh);gh.display.cachedCharWidth=gh.display.cachedTextHeight=gh.display.cachedPaddingH=null;if(!gh.options.lineWrapping){gh.display.maxLineChanged=true}gh.display.lineNumChars=null}function cu(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function cs(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function eQ(gn,gk,gm,gi){if(gk.widgets){for(var gj=0;gj<gk.widgets.length;++gj){if(gk.widgets[gj].above){var gp=cY(gk.widgets[gj]);gm.top+=gp;gm.bottom+=gp}}}if(gi=="line"){return gm}if(!gi){gi="local"}var gl=bM(gk);if(gi=="local"){gl+=e8(gn.display)}else{gl-=gn.display.viewOffset}if(gi=="page"||gi=="window"){var gh=gn.display.lineSpace.getBoundingClientRect();gl+=gh.top+(gi=="window"?0:cs());var go=gh.left+(gi=="window"?0:cu());gm.left+=go;gm.right+=go}gm.top+=gl;gm.bottom+=gl;return gm}function ge(gi,gl,gj){if(gj=="div"){return gl}var gn=gl.left,gm=gl.top;if(gj=="page"){gn-=cu();gm-=cs()}else{if(gj=="local"||!gj){var gk=gi.display.sizer.getBoundingClientRect();gn+=gk.left;gm+=gk.top}}var gh=gi.display.lineSpace.getBoundingClientRect();return{left:gn-gh.left,top:gm-gh.top}}function cJ(gh,gl,gk,gj,gi){if(!gj){gj=ff(gh.doc,gl.line)}return eQ(gh,gj,eh(gh,gj,gl.ch,gi),gk)}function dU(gq,gp,gj,gn,gs,go){gn=gn||ff(gq.doc,gp.line);if(!gs){gs=a5(gq,gn)}function gl(gv,gu){var gt=C(gq,gs,gv,gu?"right":"left",go);if(gu){gt.left=gt.right}else{gt.right=gt.left}return eQ(gq,gn,gt,gj)}function gr(gw,gt){var gu=gm[gt],gv=gu.level%2;if(gw==dy(gu)&&gt&&gu.level<gm[gt-1].level){gu=gm[--gt];gw=gd(gu)-(gu.level%2?0:1);gv=true}else{if(gw==gd(gu)&&gt<gm.length-1&&gu.level<gm[gt+1].level){gu=gm[++gt];gw=dy(gu)-gu.level%2;gv=false}}if(gv&&gw==gu.to&&gw>gu.from){return gl(gw-1)}return gl(gw,gv)}var gm=a(gn),gh=gp.ch;if(!gm){return gl(gh)}var gi=aG(gm,gh);var gk=gr(gh,gi);if(e2!=null){gk.other=gr(gh,e2)}return gk}function dH(gh,gl){var gk=0,gl=fJ(gh.doc,gl);if(!gh.options.lineWrapping){gk=dD(gh.display)*gl.ch}var gi=ff(gh.doc,gl.line);var gj=bM(gi)+e8(gh.display);return{left:gk,right:gk,top:gj,bottom:gj+gi.height}}function f1(gh,gi,gj,gl){var gk=W(gh,gi);gk.xRel=gl;if(gj){gk.outside=true}return gk}function fO(go,gl,gk){var gn=go.doc;gk+=go.display.viewOffset;if(gk<0){return f1(gn.first,0,true,-1)}var gj=bG(gn,gk),gp=gn.first+gn.size-1;if(gj>gp){return f1(gn.first+gn.size-1,ff(gn,gp).text.length,true,1)}if(gl<0){gl=0}var gi=ff(gn,gj);for(;;){var gq=cZ(go,gi,gj,gl,gk);var gm=ew(gi);var gh=gm&&gm.find(0,true);if(gm&&(gq.ch>gh.from.ch||gq.ch==gh.from.ch&&gq.xRel>0)){gj=bN(gi=gh.to.line)}else{return gq}}}function cZ(gr,gj,gu,gt,gs){var gq=gs-bM(gj);var gn=false,gA=2*gr.display.wrapper.clientWidth;var gx=a5(gr,gj);function gE(gG){var gH=dU(gr,W(gu,gG),"line",gj,gx);gn=true;if(gq>gH.bottom){return gH.left-gA}else{if(gq<gH.top){return gH.left+gA}else{gn=false}}return gH.left}var gw=a(gj),gz=gj.text.length;var gB=cE(gj),gk=cS(gj);var gy=gE(gB),gh=gn,gi=gE(gk),gm=gn;if(gt>gi){return f1(gu,gk,gm,1)}for(;;){if(gw?gk==gB||gk==u(gj,gB,1):gk-gB<=1){var gv=gt<gy||gt-gy<=gi-gt?gB:gk;var gD=gt-(gv==gB?gy:gi);while(fp(gj.text.charAt(gv))){++gv}var gp=f1(gu,gv,gv==gB?gh:gm,gD<-1?-1:gD>1?1:0);return gp}var go=Math.ceil(gz/2),gF=gB+go;if(gw){gF=gB;for(var gC=0;gC<go;++gC){gF=u(gj,gF,1)}}var gl=gE(gF);if(gl>gt){gk=gF;gi=gl;if(gm=gn){gi+=1000}gz=go}else{gB=gF;gy=gl;gh=gn;gz-=go}}}var aH;function aY(gj){if(gj.cachedTextHeight!=null){return gj.cachedTextHeight}if(aH==null){aH=f2("pre");for(var gi=0;gi<49;++gi){aH.appendChild(document.createTextNode("x"));aH.appendChild(f2("br"))}aH.appendChild(document.createTextNode("x"))}bR(gj.measure,aH);var gh=aH.offsetHeight/50;if(gh>3){gj.cachedTextHeight=gh}d1(gj.measure);return gh||1}function dD(gl){if(gl.cachedCharWidth!=null){return gl.cachedCharWidth}var gh=f2("span","xxxxxxxxxx");var gk=f2("pre",[gh]);bR(gl.measure,gk);var gj=gh.getBoundingClientRect(),gi=(gj.right-gj.left)/10;if(gi>2){gl.cachedCharWidth=gi}return gi||10}var bp=null;var d8=0;function cI(gh){gh.curOp={cm:gh,viewChanged:false,startHeight:gh.doc.height,forceUpdate:false,updateInput:null,typing:false,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:false,updateMaxLine:false,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:false,id:++d8};if(bp){bp.ops.push(gh.curOp)}else{gh.curOp.ownsGroup=bp={ops:[gh.curOp],delayedCallbacks:[]}}}function cU(gk){var gj=gk.delayedCallbacks,gi=0;do{for(;gi<gj.length;gi++){gj[gi]()}for(var gh=0;gh<gk.ops.length;gh++){var gl=gk.ops[gh];if(gl.cursorActivityHandlers){while(gl.cursorActivityCalled<gl.cursorActivityHandlers.length){gl.cursorActivityHandlers[gl.cursorActivityCalled++](gl.cm)}}}}while(gi<gj.length)}function am(gh){var gk=gh.curOp,gj=gk.ownsGroup;if(!gj){return}try{cU(gj)}finally{bp=null;for(var gi=0;gi<gj.ops.length;gi++){gj.ops[gi].cm.curOp=null}cK(gj)}}function cK(gj){var gi=gj.ops;for(var gh=0;gh<gi.length;gh++){b5(gi[gh])}for(var gh=0;gh<gi.length;gh++){aq(gi[gh])}for(var gh=0;gh<gi.length;gh++){b2(gi[gh])}for(var gh=0;gh<gi.length;gh++){ap(gi[gh])}for(var gh=0;gh<gi.length;gh++){e0(gi[gh])}}function b5(gj){var gh=gj.cm,gi=gh.display;J(gh);if(gj.updateMaxLine){g(gh)}gj.mustUpdate=gj.viewChanged||gj.forceUpdate||gj.scrollTop!=null||gj.scrollToPos&&(gj.scrollToPos.from.line<gi.viewFrom||gj.scrollToPos.to.line>=gi.viewTo)||gi.maxLineChanged&&gh.options.lineWrapping;gj.update=gj.mustUpdate&&new aI(gh,gj.mustUpdate&&{top:gj.scrollTop,ensure:gj.scrollToPos},gj.forceUpdate)}function aq(gh){gh.updatedDisplay=gh.mustUpdate&&B(gh.cm,gh.update)}function b2(gj){var gh=gj.cm,gi=gh.display;if(gj.updatedDisplay){ba(gh)}gj.barMeasure=dA(gh);if(gi.maxLineChanged&&!gh.options.lineWrapping){gj.adjustWidthTo=eh(gh,gi.maxLine,gi.maxLine.text.length).left+3;gh.display.sizerWidth=gj.adjustWidthTo;gj.barMeasure.scrollWidth=Math.max(gi.scroller.clientWidth,gi.sizer.offsetLeft+gj.adjustWidthTo+cT(gh)+gh.display.barWidth);gj.maxScrollLeft=Math.max(0,gi.sizer.offsetLeft+gj.adjustWidthTo-dl(gh))}if(gj.updatedDisplay||gj.selectionChanged){gj.preparedSelection=gi.input.prepareSelection()}}function ap(gi){var gh=gi.cm;if(gi.adjustWidthTo!=null){gh.display.sizer.style.minWidth=gi.adjustWidthTo+"px";if(gi.maxScrollLeft<gh.doc.scrollLeft){bE(gh,Math.min(gh.display.scroller.scrollLeft,gi.maxScrollLeft),true)}gh.display.maxLineChanged=false}if(gi.preparedSelection){gh.display.input.showSelection(gi.preparedSelection)}if(gi.updatedDisplay){dz(gh,gi.barMeasure)}if(gi.updatedDisplay||gi.startHeight!=gh.doc.height){eY(gh,gi.barMeasure)}if(gi.selectionChanged){o(gh)}if(gh.state.focused&&gi.updateInput){gh.display.input.reset(gi.typing)}if(gi.focus&&gi.focus==dO()){r(gi.cm)}}function e0(go){var gh=go.cm,gm=gh.display,gl=gh.doc;if(go.updatedDisplay){cj(gh,go.update)}if(gm.wheelStartX!=null&&(go.scrollTop!=null||go.scrollLeft!=null||go.scrollToPos)){gm.wheelStartX=gm.wheelStartY=null}if(go.scrollTop!=null&&(gm.scroller.scrollTop!=go.scrollTop||go.forceScroll)){gl.scrollTop=Math.max(0,Math.min(gm.scroller.scrollHeight-gm.scroller.clientHeight,go.scrollTop));gm.scrollbars.setScrollTop(gl.scrollTop);gm.scroller.scrollTop=gl.scrollTop}if(go.scrollLeft!=null&&(gm.scroller.scrollLeft!=go.scrollLeft||go.forceScroll)){gl.scrollLeft=Math.max(0,Math.min(gm.scroller.scrollWidth-dl(gh),go.scrollLeft));gm.scrollbars.setScrollLeft(gl.scrollLeft);gm.scroller.scrollLeft=gl.scrollLeft;eE(gh)}if(go.scrollToPos){var gk=D(gh,fJ(gl,go.scrollToPos.from),fJ(gl,go.scrollToPos.to),go.scrollToPos.margin);if(go.scrollToPos.isCursor&&gh.state.focused){d6(gh,gk)}}var gj=go.maybeHiddenMarkers,gn=go.maybeUnhiddenMarkers;if(gj){for(var gi=0;gi<gj.length;++gi){if(!gj[gi].lines.length){aE(gj[gi],"hide")}}}if(gn){for(var gi=0;gi<gn.length;++gi){if(gn[gi].lines.length){aE(gn[gi],"unhide")}}}if(gm.wrapper.offsetHeight){gl.scrollTop=gh.display.scroller.scrollTop}if(go.changeObjs){aE(gh,"changes",gh,go.changeObjs)}if(go.update){go.update.finish()}}function cM(gh,gi){if(gh.curOp){return gi()}cI(gh);try{return gi()}finally{am(gh)}}function c2(gh,gi){return function(){if(gh.curOp){return gi.apply(gh,arguments)}cI(gh);try{return gi.apply(gh,arguments)}finally{am(gh)}}}function c8(gh){return function(){if(this.curOp){return gh.apply(this,arguments)}cI(this);try{return gh.apply(this,arguments)}finally{am(this)}}}function cD(gh){return function(){var gi=this.cm;if(!gi||gi.curOp){return gh.apply(this,arguments)}cI(gi);try{return gh.apply(this,arguments)}finally{am(gi)}}}function bv(gj,gh,gi){this.line=gh;this.rest=h(gh);this.size=this.rest?bN(fG(this.rest))-gi+1:1;this.node=this.text=null;this.hidden=fw(gj,gh)}function eV(gh,gn,gm){var gl=[],gj;for(var gk=gn;gk<gm;gk=gj){var gi=new bv(gh.doc,ff(gh.doc,gk),gk);gj=gk+gi.size;gl.push(gi)}return gl}function ah(go,gm,gn,gp){if(gm==null){gm=go.doc.first}if(gn==null){gn=go.doc.first+go.doc.size}if(!gp){gp=0}var gj=go.display;if(gp&&gn<gj.viewTo&&(gj.updateLineNumbers==null||gj.updateLineNumbers>gm)){gj.updateLineNumbers=gm}go.curOp.viewChanged=true;if(gm>=gj.viewTo){if(a8&&aW(go.doc,gm)<gj.viewTo){ex(go)}}else{if(gn<=gj.viewFrom){if(a8&&d2(go.doc,gn+gp)>gj.viewFrom){ex(go)}else{gj.viewFrom+=gp;gj.viewTo+=gp}}else{if(gm<=gj.viewFrom&&gn>=gj.viewTo){ex(go)}else{if(gm<=gj.viewFrom){var gl=de(go,gn,gn+gp,1);if(gl){gj.view=gj.view.slice(gl.index);gj.viewFrom=gl.lineN;gj.viewTo+=gp}else{ex(go)}}else{if(gn>=gj.viewTo){var gl=de(go,gm,gm,-1);if(gl){gj.view=gj.view.slice(0,gl.index);gj.viewTo=gl.lineN}else{ex(go)}}else{var gk=de(go,gm,gm,-1);var gi=de(go,gn,gn+gp,1);if(gk&&gi){gj.view=gj.view.slice(0,gk.index).concat(eV(go,gk.lineN,gi.lineN)).concat(gj.view.slice(gi.index));gj.viewTo+=gp}else{ex(go)}}}}}}var gh=gj.externalMeasured;if(gh){if(gn<gh.lineN){gh.lineN+=gp}else{if(gm<gh.lineN+gh.size){gj.externalMeasured=null}}}}function R(gi,gj,gm){gi.curOp.viewChanged=true;var gn=gi.display,gl=gi.display.externalMeasured;if(gl&&gj>=gl.lineN&&gj<gl.lineN+gl.size){gn.externalMeasured=null}if(gj<gn.viewFrom||gj>=gn.viewTo){return}var gk=gn.view[dr(gi,gj)];if(gk.node==null){return}var gh=gk.changes||(gk.changes=[]);if(dh(gh,gm)==-1){gh.push(gm)}}function ex(gh){gh.display.viewFrom=gh.display.viewTo=gh.doc.first;gh.display.view=[];gh.display.viewOffset=0}function dr(gh,gk){if(gk>=gh.display.viewTo){return null}gk-=gh.display.viewFrom;if(gk<0){return null}var gi=gh.display.view;for(var gj=0;gj<gi.length;gj++){gk-=gi[gj].size;if(gk<0){return gj}}}function de(gp,gj,gl,gi){var gm=dr(gp,gj),go,gn=gp.display.view;if(!a8||gl==gp.doc.first+gp.doc.size){return{index:gm,lineN:gl}}for(var gk=0,gh=gp.display.viewFrom;gk<gm;gk++){gh+=gn[gk].size}if(gh!=gj){if(gi>0){if(gm==gn.length-1){return null}go=(gh+gn[gm].size)-gj;gm++}else{go=gh-gj}gj+=go;gl+=go}while(aW(gp.doc,gl)!=gl){if(gm==(gi<0?0:gn.length-1)){return null}gl+=gi*gn[gm-(gi<0?1:0)].size;gm+=gi}return{index:gm,lineN:gl}}function cR(gh,gl,gk){var gj=gh.display,gi=gj.view;if(gi.length==0||gl>=gj.viewTo||gk<=gj.viewFrom){gj.view=eV(gh,gl,gk);gj.viewFrom=gl}else{if(gj.viewFrom>gl){gj.view=eV(gh,gl,gj.viewFrom).concat(gj.view)}else{if(gj.viewFrom<gl){gj.view=gj.view.slice(dr(gh,gl))}}gj.viewFrom=gl;if(gj.viewTo<gk){gj.view=gj.view.concat(eV(gh,gj.viewTo,gk))}else{if(gj.viewTo>gk){gj.view=gj.view.slice(0,dr(gh,gk))}}}gj.viewTo=gk}function db(gh){var gi=gh.display.view,gl=0;for(var gk=0;gk<gi.length;gk++){var gj=gi[gk];if(!gj.hidden&&(!gj.node||gj.changes)){++gl}}return gl}function fQ(gi){var gm=gi.display;bX(gm.scroller,"mousedown",c2(gi,eu));if(dK&&k<11){bX(gm.scroller,"dblclick",c2(gi,function(gq){if(aR(gi,gq)){return}var gr=cn(gi,gq);if(!gr||l(gi,gq)||bb(gi.display,gq)){return}cG(gq);var gp=gi.findWordAt(gr);fW(gi.doc,gp.anchor,gp.head)}))}else{bX(gm.scroller,"dblclick",function(gp){aR(gi,gp)||cG(gp)})}if(!f9){bX(gm.scroller,"contextmenu",function(gp){ay(gi,gp)})}var go,gh={end:0};function gn(){if(gm.activeTouch){go=setTimeout(function(){gm.activeTouch=null},1000);gh=gm.activeTouch;gh.end=+new Date}}function gk(gp){if(gp.touches.length!=1){return false}var gq=gp.touches[0];return gq.radiusX<=1&&gq.radiusY<=1}function gj(gs,gp){if(gp.left==null){return true}var gr=gp.left-gs.left,gq=gp.top-gs.top;return gr*gr+gq*gq>20*20}bX(gm.scroller,"touchstart",function(gq){if(!gk(gq)){clearTimeout(go);var gp=+new Date;gm.activeTouch={start:gp,moved:false,prev:gp-gh.end<=300?gh:null};if(gq.touches.length==1){gm.activeTouch.left=gq.touches[0].pageX;gm.activeTouch.top=gq.touches[0].pageY}}});bX(gm.scroller,"touchmove",function(){if(gm.activeTouch){gm.activeTouch.moved=true}});bX(gm.scroller,"touchend",function(gq){var gs=gm.activeTouch;if(gs&&!bb(gm,gq)&&gs.left!=null&&!gs.moved&&new Date-gs.start<300){var gr=gi.coordsChar(gm.activeTouch,"page"),gp;if(!gs.prev||gj(gs,gs.prev)){gp=new dY(gr,gr)}else{if(!gs.prev.prev||gj(gs,gs.prev.prev)){gp=gi.findWordAt(gr)}else{gp=new dY(W(gr.line,0),fJ(gi.doc,W(gr.line+1,0)))}}gi.setSelection(gp.anchor,gp.head);gi.focus();cG(gq)}gn()});bX(gm.scroller,"touchcancel",gn);bX(gm.scroller,"scroll",function(){if(gm.scroller.clientHeight){N(gi,gm.scroller.scrollTop);bE(gi,gm.scroller.scrollLeft,true);aE(gi,"scroll",gi)}});bX(gm.scroller,"mousewheel",function(gp){b(gi,gp)});bX(gm.scroller,"DOMMouseScroll",function(gp){b(gi,gp)});bX(gm.wrapper,"scroll",function(){gm.wrapper.scrollTop=gm.wrapper.scrollLeft=0});gm.dragFunctions={simple:function(gp){if(!aR(gi,gp)){er(gp)}},start:function(gp){Q(gi,gp)},drop:c2(gi,bk)};var gl=gm.input.getField();bX(gl,"keyup",function(gp){bi.call(gi,gp)});bX(gl,"keydown",c2(gi,p));bX(gl,"keypress",c2(gi,cx));bX(gl,"focus",cv(cB,gi));bX(gl,"blur",cv(aV,gi))}function f0(gi,gl,gj){var gm=gj&&gj!=H.Init;if(!gl!=!gm){var gk=gi.display.dragFunctions;var gh=gl?bX:ed;gh(gi.display.scroller,"dragstart",gk.start);gh(gi.display.scroller,"dragenter",gk.simple);gh(gi.display.scroller,"dragover",gk.simple);gh(gi.display.scroller,"drop",gk.drop)}}function aT(gh){var gi=gh.display;if(gi.lastWrapHeight==gi.wrapper.clientHeight&&gi.lastWrapWidth==gi.wrapper.clientWidth){return}gi.cachedCharWidth=gi.cachedTextHeight=gi.cachedPaddingH=null;gi.scrollbarsClipped=false;gh.setSize()}function bb(gi,gh){for(var gj=L(gh);gj!=gi.wrapper;gj=gj.parentNode){if(!gj||(gj.nodeType==1&&gj.getAttribute("cm-ignore-events")=="true")||(gj.parentNode==gi.sizer&&gj!=gi.mover)){return true}}}function cn(gq,gl,gi,gj){var gm=gq.display;if(!gi&&L(gl).getAttribute("cm-not-content")=="true"){return null}var gp,gn,gh=gm.lineSpace.getBoundingClientRect();try{gp=gl.clientX-gh.left;gn=gl.clientY-gh.top}catch(gl){return null}var go=fO(gq,gp,gn),gr;if(gj&&go.xRel==1&&(gr=ff(gq.doc,go.line).text).length==go.ch){var gk=bT(gr,gr.length,gq.options.tabSize)-gr.length;go=W(go.line,Math.max(0,Math.round((gp-e5(gq.display).left)/dD(gq.display))-gk))}return go}function eu(gj){var gh=this,gi=gh.display;if(gi.activeTouch&&gi.input.supportsTouch()||aR(gh,gj)){return}gi.shift=gj.shiftKey;if(bb(gi,gj)){if(!c0){gi.scroller.draggable=false;setTimeout(function(){gi.scroller.draggable=true},100)}return}if(l(gh,gj)){return}var gk=cn(gh,gj);window.focus();switch(fN(gj)){case 1:if(gk){ax(gh,gj,gk)}else{if(L(gj)==gi.scroller){cG(gj)}}break;case 2:if(c0){gh.state.lastMiddleDown=+new Date}if(gk){fW(gh.doc,gk)}setTimeout(function(){gi.input.focus()},20);cG(gj);break;case 3:if(f9){ay(gh,gj)}else{al(gh)}break}}var dn,dd;function ax(gi,gn,go){if(dK){setTimeout(cv(r,gi),0)}else{gi.curOp.focus=dO()}var gj=+new Date,gl;if(dd&&dd.time>gj-400&&cf(dd.pos,go)==0){gl="triple"}else{if(dn&&dn.time>gj-400&&cf(dn.pos,go)==0){gl="double";dd={time:gj,pos:go}}else{gl="single";dn={time:gj,pos:go}}}var gm=gi.doc.sel,gh=b7?gn.metaKey:gn.ctrlKey,gk;if(gi.options.dragDrop&&eL&&!aj(gi)&&gl=="single"&&(gk=gm.contains(go))>-1&&!gm.ranges[gk].empty()){a4(gi,gn,go,gh)}else{m(gi,gn,go,gl,gh)}}function a4(gj,gm,gn,gi){var gl=gj.display,gk=+new Date;var gh=c2(gj,function(go){if(c0){gl.scroller.draggable=false}gj.state.draggingText=false;ed(document,"mouseup",gh);ed(gl.scroller,"drop",gh);if(Math.abs(gm.clientX-go.clientX)+Math.abs(gm.clientY-go.clientY)<10){cG(go);if(!gi&&+new Date-200<gk){fW(gj.doc,gn)}if(c0||dK&&k==9){setTimeout(function(){document.body.focus();gl.input.focus()},20)}else{gl.input.focus()}}});if(c0){gl.scroller.draggable=true}gj.state.draggingText=gh;if(gl.scroller.dragDrop){gl.scroller.dragDrop()}bX(document,"mouseup",gh);bX(gl.scroller,"drop",gh)}function m(gl,gz,gk,gi,gn){var gw=gl.display,gB=gl.doc;cG(gz);var gj,gA,gm=gB.sel,gh=gm.ranges;if(gn&&!gz.shiftKey){gA=gB.sel.contains(gk);if(gA>-1){gj=gh[gA]}else{gj=new dY(gk,gk)}}else{gj=gB.sel.primary();gA=gB.sel.primIndex}if(gz.altKey){gi="rect";if(!gn){gj=new dY(gk,gk)}gk=cn(gl,gz,true,true);gA=-1}else{if(gi=="double"){var gx=gl.findWordAt(gk);if(gl.display.shift||gB.extend){gj=fv(gB,gj,gx.anchor,gx.head)}else{gj=gx}}else{if(gi=="triple"){var gq=new dY(W(gk.line,0),fJ(gB,W(gk.line+1,0)));if(gl.display.shift||gB.extend){gj=fv(gB,gj,gq.anchor,gq.head)}else{gj=gq}}else{gj=fv(gB,gj,gk)}}}if(!gn){gA=0;bU(gB,new f3([gj],0),M);gm=gB.sel}else{if(gA==-1){gA=gh.length;bU(gB,cw(gh.concat([gj]),gA),{scroll:false,origin:"*mouse"})}else{if(gh.length>1&&gh[gA].empty()&&gi=="single"&&!gz.shiftKey){bU(gB,cw(gh.slice(0,gA).concat(gh.slice(gA+1)),0));gm=gB.sel}else{e(gB,gA,gj,M)}}}var gv=gk;function gu(gM){if(cf(gv,gM)==0){return}gv=gM;if(gi=="rect"){var gD=[],gJ=gl.options.tabSize;var gC=bT(ff(gB,gk.line).text,gk.ch,gJ);var gP=bT(ff(gB,gM.line).text,gM.ch,gJ);var gE=Math.min(gC,gP),gN=Math.max(gC,gP);for(var gQ=Math.min(gk.line,gM.line),gG=Math.min(gl.lastLine(),Math.max(gk.line,gM.line));gQ<=gG;gQ++){var gO=ff(gB,gQ).text,gF=eq(gO,gE,gJ);if(gE==gN){gD.push(new dY(W(gQ,gF),W(gQ,gF)))}else{if(gO.length>gF){gD.push(new dY(W(gQ,gF),W(gQ,eq(gO,gN,gJ))))}}}if(!gD.length){gD.push(new dY(gk,gk))}bU(gB,cw(gm.ranges.slice(0,gA).concat(gD),gA),{origin:"*mouse",scroll:false});gl.scrollIntoView(gM)}else{var gK=gj;var gH=gK.anchor,gL=gM;if(gi!="single"){if(gi=="double"){var gI=gl.findWordAt(gM)}else{var gI=new dY(W(gM.line,0),fJ(gB,W(gM.line+1,0)))}if(cf(gI.anchor,gH)>0){gL=gI.head;gH=ar(gK.from(),gI.anchor)}else{gL=gI.anchor;gH=bx(gK.to(),gI.head)}}var gD=gm.ranges.slice(0);gD[gA]=new dY(fJ(gB,gH),gL);bU(gB,cw(gD,gA),M)}}var gs=gw.wrapper.getBoundingClientRect();var go=0;function gy(gE){var gC=++go;var gG=cn(gl,gE,true,gi=="rect");if(!gG){return}if(cf(gG,gv)!=0){gl.curOp.focus=dO();gu(gG);var gF=b6(gw,gB);if(gG.line>=gF.to||gG.line<gF.from){setTimeout(c2(gl,function(){if(go==gC){gy(gE)}}),150)}}else{var gD=gE.clientY<gs.top?-20:gE.clientY>gs.bottom?20:0;if(gD){setTimeout(c2(gl,function(){if(go!=gC){return}gw.scroller.scrollTop+=gD;gy(gE)}),50)}}}function gr(gC){go=Infinity;cG(gC);gw.input.focus();ed(document,"mousemove",gt);ed(document,"mouseup",gp);gB.history.lastSelOrigin=null}var gt=c2(gl,function(gC){if(!fN(gC)){gr(gC)}else{gy(gC)}});var gp=c2(gl,gr);bX(document,"mousemove",gt);bX(document,"mouseup",gp)}function gf(gs,go,gq,gr,gk){try{var gi=go.clientX,gh=go.clientY}catch(go){return false}if(gi>=Math.floor(gs.display.gutters.getBoundingClientRect().right)){return false}if(gr){cG(go)}var gp=gs.display;var gn=gp.lineDiv.getBoundingClientRect();if(gh>gn.bottom||!fi(gs,gq)){return bL(go)}gh-=gn.top-gp.viewOffset;for(var gl=0;gl<gs.options.gutters.length;++gl){var gm=gp.gutters.childNodes[gl];if(gm&&gm.getBoundingClientRect().right>=gi){var gt=bG(gs.doc,gh);var gj=gs.options.gutters[gl];gk(gs,gq,gs,gt,gj,go);return bL(go)}}}function l(gh,gi){return gf(gh,gi,"gutterClick",true,ae)}var ag=0;function bk(gn){var gp=this;if(aR(gp,gn)||bb(gp.display,gn)){return}cG(gn);if(dK){ag=+new Date}var go=cn(gp,gn,true),gh=gn.dataTransfer.files;if(!go||aj(gp)){return}if(gh&&gh.length&&window.FileReader&&window.File){var gj=gh.length,gq=Array(gj),gi=0;var gl=function(gt,gs){var gr=new FileReader;gr.onload=c2(gp,function(){gq[gs]=gr.result;if(++gi==gj){go=fJ(gp.doc,go);var gu={from:go,to:go,text:a1(gq.join("\n")),origin:"paste"};bg(gp.doc,gu);e7(gp.doc,eS(go,cX(gu)))}});gr.readAsText(gt)};for(var gm=0;gm<gj;++gm){gl(gh[gm],gm)}}else{if(gp.state.draggingText&&gp.doc.sel.contains(go)>-1){gp.state.draggingText(gn);setTimeout(function(){gp.display.input.focus()},20);return}try{var gq=gn.dataTransfer.getData("Text");if(gq){if(gp.state.draggingText&&!(b7?gn.altKey:gn.ctrlKey)){var gk=gp.listSelections()}ep(gp.doc,eS(go,go));if(gk){for(var gm=0;gm<gk.length;++gm){a2(gp.doc,"",gk[gm].anchor,gk[gm].head,"drag")}}gp.replaceSelection(gq,"around","paste");gp.display.input.focus()}}catch(gn){}}}function Q(gh,gj){if(dK&&(!gh.state.draggingText||+new Date-ag<100)){er(gj);return}if(aR(gh,gj)||bb(gh.display,gj)){return}gj.dataTransfer.setData("Text",gh.getSelection());if(gj.dataTransfer.setDragImage&&!aC){var gi=f2("img",null,null,"position: fixed; left: 0; top: 0;");gi.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(d3){gi.width=gi.height=1;gh.display.wrapper.appendChild(gi);gi._top=gi.offsetTop}gj.dataTransfer.setDragImage(gi,0,0);if(d3){gi.parentNode.removeChild(gi)}}}function N(gh,gi){if(Math.abs(gh.doc.scrollTop-gi)<2){return}gh.doc.scrollTop=gi;if(!co){dT(gh,{top:gi})}if(gh.display.scroller.scrollTop!=gi){gh.display.scroller.scrollTop=gi}gh.display.scrollbars.setScrollTop(gi);if(co){dT(gh)}ef(gh,100)}function bE(gh,gj,gi){if(gi?gj==gh.doc.scrollLeft:Math.abs(gh.doc.scrollLeft-gj)<2){return}gj=Math.min(gj,gh.display.scroller.scrollWidth-gh.display.scroller.clientWidth);gh.doc.scrollLeft=gj;eE(gh);if(gh.display.scroller.scrollLeft!=gj){gh.display.scroller.scrollLeft=gj}gh.display.scrollbars.setScrollLeft(gj)}var fm=0,cg=null;if(dK){cg=-0.53}else{if(co){cg=15}else{if(dc){cg=-0.7}else{if(aC){cg=-1/3}}}}var cQ=function(gj){var gi=gj.wheelDeltaX,gh=gj.wheelDeltaY;if(gi==null&&gj.detail&&gj.axis==gj.HORIZONTAL_AXIS){gi=gj.detail}if(gh==null&&gj.detail&&gj.axis==gj.VERTICAL_AXIS){gh=gj.detail}else{if(gh==null){gh=gj.wheelDelta}}return{x:gi,y:gh}};H.wheelEventPixels=function(gh){var gi=cQ(gh);gi.x*=cg;gi.y*=cg;return gi};function b(gp,gj){var gq=cQ(gj),gt=gq.x,gs=gq.y;var gl=gp.display,go=gl.scroller;if(!(gt&&go.scrollWidth>go.clientWidth||gs&&go.scrollHeight>go.clientHeight)){return}if(gs&&b7&&c0){outer:for(var gr=gj.target,gn=gl.view;gr!=go;gr=gr.parentNode){for(var gi=0;gi<gn.length;gi++){if(gn[gi].node==gr){gp.display.currentWheelTarget=gr;break outer}}}}if(gt&&!co&&!d3&&cg!=null){if(gs){N(gp,Math.max(0,Math.min(go.scrollTop+gs*cg,go.scrollHeight-go.clientHeight)))}bE(gp,Math.max(0,Math.min(go.scrollLeft+gt*cg,go.scrollWidth-go.clientWidth)));cG(gj);gl.wheelStartX=null;return}if(gs&&cg!=null){var gh=gs*cg;var gm=gp.doc.scrollTop,gk=gm+gl.wrapper.clientHeight;if(gh<0){gm=Math.max(0,gm+gh-50)}else{gk=Math.min(gp.doc.height,gk+gh+50)}dT(gp,{top:gm,bottom:gk})}if(fm<20){if(gl.wheelStartX==null){gl.wheelStartX=go.scrollLeft;gl.wheelStartY=go.scrollTop;gl.wheelDX=gt;gl.wheelDY=gs;setTimeout(function(){if(gl.wheelStartX==null){return}var gu=go.scrollLeft-gl.wheelStartX;var gw=go.scrollTop-gl.wheelStartY;var gv=(gw&&gl.wheelDY&&gw/gl.wheelDY)||(gu&&gl.wheelDX&&gu/gl.wheelDX);gl.wheelStartX=gl.wheelStartY=null;if(!gv){return}cg=(cg*fm+gv)/(fm+1);++fm},200)}else{gl.wheelDX+=gt;gl.wheelDY+=gs}}}function fR(gi,gl,gh){if(typeof gl=="string"){gl=eD[gl];if(!gl){return false}}gi.display.input.ensurePolled();var gk=gi.display.shift,gj=false;try{if(aj(gi)){gi.state.suppressEdits=true}if(gh){gi.display.shift=false}gj=gl(gi)!=ca}finally{gi.display.shift=gk;gi.state.suppressEdits=false}return gj}function ea(gi,gj,gl){for(var gk=0;gk<gi.state.keyMaps.length;gk++){var gh=i(gj,gi.state.keyMaps[gk],gl,gi);if(gh){return gh}}return(gi.options.extraKeys&&i(gj,gi.options.extraKeys,gl,gi))||i(gj,gi.options.keyMap,gl,gi)}var dM=new gg;function bd(gi,gk,gm,gl){var gj=gi.state.keySeq;if(gj){if(eC(gk)){return"handled"}dM.set(50,function(){if(gi.state.keySeq==gj){gi.state.keySeq=null;gi.display.input.reset()}});gk=gj+" "+gk}var gh=ea(gi,gk,gl);if(gh=="multi"){gi.state.keySeq=gk}if(gh=="handled"){ae(gi,"keyHandled",gi,gk,gm)}if(gh=="handled"||gh=="multi"){cG(gm);o(gi)}if(gj&&!gh&&/\'$/.test(gk)){cG(gm);return true}return !!gh}function fj(gh,gj){var gi=fr(gj,true);if(!gi){return false}if(gj.shiftKey&&!gh.state.keySeq){return bd(gh,"Shift-"+gi,gj,function(gk){return fR(gh,gk,true)})||bd(gh,gi,gj,function(gk){if(typeof gk=="string"?/^go[A-Z]/.test(gk):gk.motion){return fR(gh,gk)}})}else{return bd(gh,gi,gj,function(gk){return fR(gh,gk)})}}function ej(gh,gj,gi){return bd(gh,"'"+gi+"'",gj,function(gk){return fR(gh,gk,true)})}var dm=null;function p(gk){var gh=this;gh.curOp.focus=dO();if(aR(gh,gk)){return}if(dK&&k<11&&gk.keyCode==27){gk.returnValue=false}var gi=gk.keyCode;gh.display.shift=gi==16||gk.shiftKey;var gj=fj(gh,gk);if(d3){dm=gj?gi:null;if(!gj&&gi==88&&!da&&(b7?gk.metaKey:gk.ctrlKey)){gh.replaceSelection("",null,"cut")}}if(gi==18&&!/\bCodeMirror-crosshair\b/.test(gh.display.lineDiv.className)){av(gh)}}function av(gi){var gj=gi.display.lineDiv;fA(gj,"CodeMirror-crosshair");function gh(gk){if(gk.keyCode==18||!gk.altKey){f(gj,"CodeMirror-crosshair");ed(document,"keyup",gh);ed(document,"mouseover",gh)}}bX(document,"keyup",gh);bX(document,"mouseover",gh)}function bi(gh){if(gh.keyCode==16){this.doc.sel.shift=false}aR(this,gh)}function cx(gl){var gh=this;if(bb(gh.display,gl)||aR(gh,gl)||gl.ctrlKey&&!gl.altKey||b7&&gl.metaKey){return}var gk=gl.keyCode,gi=gl.charCode;if(d3&&gk==dm){dm=null;cG(gl);return}if((d3&&(!gl.which||gl.which<10))&&fj(gh,gl)){return}var gj=String.fromCharCode(gi==null?gk:gi);if(ej(gh,gl,gj)){return}gh.display.input.onKeyPress(gl)}function al(gh){gh.state.delayingBlurEvent=true;setTimeout(function(){if(gh.state.delayingBlurEvent){gh.state.delayingBlurEvent=false;aV(gh)}},100)}function cB(gh){if(gh.state.delayingBlurEvent){gh.state.delayingBlurEvent=false}if(gh.options.readOnly=="nocursor"){return}if(!gh.state.focused){aE(gh,"focus",gh);gh.state.focused=true;fA(gh.display.wrapper,"CodeMirror-focused");if(!gh.curOp&&gh.display.selForContextMenu!=gh.doc.sel){gh.display.input.reset();if(c0){setTimeout(function(){gh.display.input.reset(true)},20)}}gh.display.input.receivedFocus()}o(gh)}function aV(gh){if(gh.state.delayingBlurEvent){return}if(gh.state.focused){aE(gh,"blur",gh);gh.state.focused=false;f(gh.display.wrapper,"CodeMirror-focused")}clearInterval(gh.display.blinker);setTimeout(function(){if(!gh.state.focused){gh.display.shift=false}},150)}function ay(gh,gi){if(bb(gh.display,gi)||dg(gh,gi)){return}gh.display.input.onContextMenu(gi)}function dg(gh,gi){if(!fi(gh,"gutterContextMenu")){return false}return gf(gh,gi,"gutterContextMenu",false,aE)}var cX=H.changeEnd=function(gh){if(!gh.text){return gh.to}return W(gh.from.line+gh.text.length-1,fG(gh.text).length+(gh.text.length==1?gh.from.ch:0))};function bZ(gk,gj){if(cf(gk,gj.from)<0){return gk}if(cf(gk,gj.to)<=0){return cX(gj)}var gh=gk.line+gj.text.length-(gj.to.line-gj.from.line)-1,gi=gk.ch;if(gk.line==gj.to.line){gi+=cX(gj).ch-gj.to.ch}return W(gh,gi)}function fk(gk,gl){var gi=[];for(var gj=0;gj<gk.sel.ranges.length;gj++){var gh=gk.sel.ranges[gj];gi.push(new dY(bZ(gh.anchor,gl),bZ(gh.head,gl)))}return cw(gi,gk.sel.primIndex)}function bu(gj,gi,gh){if(gj.line==gi.line){return W(gh.line,gj.ch-gi.ch+gh.ch)}else{return W(gh.line+(gj.line-gi.line),gj.ch)}}function af(gr,go,gi){var gj=[];var gh=W(gr.first,0),gs=gh;for(var gl=0;gl<go.length;gl++){var gn=go[gl];var gq=bu(gn.from,gh,gs);var gp=bu(cX(gn),gh,gs);gh=gn.to;gs=gp;if(gi=="around"){var gm=gr.sel.ranges[gl],gk=cf(gm.head,gm.anchor)<0;gj[gl]=new dY(gk?gp:gq,gk?gq:gp)}else{gj[gl]=new dY(gq,gq)}}return new f3(gj,gr.sel.primIndex)}function dR(gi,gk,gj){var gh={canceled:false,from:gk.from,to:gk.to,text:gk.text,origin:gk.origin,cancel:function(){this.canceled=true}};if(gj){gh.update=function(go,gn,gm,gl){if(go){this.from=fJ(gi,go)}if(gn){this.to=fJ(gi,gn)}if(gm){this.text=gm}if(gl!==undefined){this.origin=gl}}}aE(gi,"beforeChange",gi,gh);if(gi.cm){aE(gi.cm,"beforeChange",gi.cm,gh)}if(gh.canceled){return null}return{from:gh.from,to:gh.to,text:gh.text,origin:gh.origin}}function bg(gk,gl,gj){if(gk.cm){if(!gk.cm.curOp){return c2(gk.cm,bg)(gk,gl,gj)}if(gk.cm.state.suppressEdits){return}}if(fi(gk,"beforeChange")||gk.cm&&fi(gk.cm,"beforeChange")){gl=dR(gk,gl,true);if(!gl){return}}var gi=gc&&!gj&&cH(gk,gl.from,gl.to);if(gi){for(var gh=gi.length-1;gh>=0;--gh){K(gk,{from:gi[gh].from,to:gi[gh].to,text:gh?[""]:gl.text})}}else{K(gk,gl)}}function K(gj,gk){if(gk.text.length==1&&gk.text[0]==""&&cf(gk.from,gk.to)==0){return}var gi=fk(gj,gk);fM(gj,gk,gi,gj.cm?gj.cm.curOp.id:NaN);ee(gj,gk,gi,ek(gj,gk));var gh=[];d7(gj,function(gm,gl){if(!gl&&dh(gh,gm.history)==-1){dE(gm.history,gk);gh.push(gm.history)}ee(gm,gk,null,ek(gm,gk))})}function b8(gs,gq,gu){if(gs.cm&&gs.cm.state.suppressEdits){return}var gp=gs.history,gj,gl=gs.sel;var gh=gq=="undo"?gp.done:gp.undone,gt=gq=="undo"?gp.undone:gp.done;for(var gm=0;gm<gh.length;gm++){gj=gh[gm];if(gu?gj.ranges&&!gj.equals(gs.sel):!gj.ranges){break}}if(gm==gh.length){return}gp.lastOrigin=gp.lastSelOrigin=null;for(;;){gj=gh.pop();if(gj.ranges){cN(gj,gt);if(gu&&!gj.equals(gs.sel)){bU(gs,gj,{clearRedo:false});return}gl=gj}else{break}}var go=[];cN(gl,gt);gt.push({changes:go,generation:gp.generation});gp.generation=gj.generation||++gp.maxGeneration;var gk=fi(gs,"beforeChange")||gs.cm&&fi(gs.cm,"beforeChange");for(var gm=gj.changes.length-1;gm>=0;--gm){var gr=gj.changes[gm];gr.origin=gq;if(gk&&!dR(gs,gr,false)){gh.length=0;return}go.push(du(gs,gr));var gi=gm?fk(gs,gr):fG(gh);ee(gs,gr,gi,d9(gs,gr));if(!gm&&gs.cm){gs.cm.scrollIntoView({from:gr.from,to:cX(gr)})}var gn=[];d7(gs,function(gw,gv){if(!gv&&dh(gn,gw.history)==-1){dE(gw.history,gr);gn.push(gw.history)}ee(gw,gr,null,d9(gw,gr))})}}function fn(gi,gk){if(gk==0){return}gi.first+=gk;gi.sel=new f3(bS(gi.sel.ranges,function(gl){return new dY(W(gl.anchor.line+gk,gl.anchor.ch),W(gl.head.line+gk,gl.head.ch))}),gi.sel.primIndex);if(gi.cm){ah(gi.cm,gi.first,gi.first-gk,gk);for(var gj=gi.cm.display,gh=gj.viewFrom;gh<gj.viewTo;gh++){R(gi.cm,gh,"gutter")}}}function ee(gl,gm,gk,gi){if(gl.cm&&!gl.cm.curOp){return c2(gl.cm,ee)(gl,gm,gk,gi)}if(gm.to.line<gl.first){fn(gl,gm.text.length-1-(gm.to.line-gm.from.line));return}if(gm.from.line>gl.lastLine()){return}if(gm.from.line<gl.first){var gh=gm.text.length-1-(gl.first-gm.from.line);fn(gl,gh);gm={from:W(gl.first,0),to:W(gm.to.line+gh,gm.to.ch),text:[fG(gm.text)],origin:gm.origin}}var gj=gl.lastLine();if(gm.to.line>gj){gm={from:gm.from,to:W(gj,ff(gl,gj).text.length),text:[gm.text[0]],origin:gm.origin}}gm.removed=f4(gl,gm.from,gm.to);if(!gk){gk=fk(gl,gm)}if(gl.cm){aJ(gl.cm,gm,gi)}else{fy(gl,gm,gi)}ep(gl,gk,Z)}function aJ(gs,go,gm){var gr=gs.doc,gn=gs.display,gp=go.from,gq=go.to;var gh=false,gl=gp.line;if(!gs.options.lineWrapping){gl=bN(y(ff(gr,gp.line)));gr.iter(gl,gq.line+1,function(gu){if(gu==gn.maxLine){gh=true;return true}})}if(gr.sel.contains(go.from,go.to)>-1){V(gs)}fy(gr,go,gm,be(gs));if(!gs.options.lineWrapping){gr.iter(gl,gp.line+go.text.length,function(gv){var gu=en(gv);if(gu>gn.maxLineLength){gn.maxLine=gv;gn.maxLineLength=gu;gn.maxLineChanged=true;gh=false}});if(gh){gs.curOp.updateMaxLine=true}}gr.frontier=Math.min(gr.frontier,gp.line);ef(gs,400);var gt=go.text.length-(gq.line-gp.line)-1;if(go.full){ah(gs)}else{if(gp.line==gq.line&&go.text.length==1&&!dS(gs.doc,go)){R(gs,gp.line,"text")}else{ah(gs,gp.line,gq.line+1,gt)}}var gj=fi(gs,"changes"),gk=fi(gs,"change");if(gk||gj){var gi={from:gp,to:gq,text:go.text,removed:go.removed,origin:go.origin};if(gk){ae(gs,"change",gs,gi)}if(gj){(gs.curOp.changeObjs||(gs.curOp.changeObjs=[])).push(gi)}}gs.display.selForContextMenu=null}function a2(gk,gj,gm,gl,gh){if(!gl){gl=gm}if(cf(gl,gm)<0){var gi=gl;gl=gm;gm=gi}if(typeof gj=="string"){gj=a1(gj)}bg(gk,{from:gm,to:gl,text:gj,origin:gh})}function d6(gi,gl){if(aR(gi,"scrollCursorIntoView")){return}var gm=gi.display,gj=gm.sizer.getBoundingClientRect(),gh=null;if(gl.top+gj.top<0){gh=true}else{if(gl.bottom+gj.top>(window.innerHeight||document.documentElement.clientHeight)){gh=false}}if(gh!=null&&!fu){var gk=f2("div","\u200b",null,"position: absolute; top: "+(gl.top-gm.viewOffset-e8(gi.display))+"px; height: "+(gl.bottom-gl.top+cT(gi)+gm.barHeight)+"px; left: "+gl.left+"px; width: 2px;");gi.display.lineSpace.appendChild(gk);gk.scrollIntoView(gh);gi.display.lineSpace.removeChild(gk)}}function D(gr,gp,gl,gk){if(gk==null){gk=0}for(var gm=0;gm<5;gm++){var gn=false,gq=dU(gr,gp);var gh=!gl||gl==gp?gq:dU(gr,gl);var gj=G(gr,Math.min(gq.left,gh.left),Math.min(gq.top,gh.top)-gk,Math.max(gq.left,gh.left),Math.max(gq.bottom,gh.bottom)+gk);var go=gr.doc.scrollTop,gi=gr.doc.scrollLeft;if(gj.scrollTop!=null){N(gr,gj.scrollTop);if(Math.abs(gr.doc.scrollTop-go)>1){gn=true}}if(gj.scrollLeft!=null){bE(gr,gj.scrollLeft);if(Math.abs(gr.doc.scrollLeft-gi)>1){gn=true}}if(!gn){break}}return gq}function E(gh,gj,gl,gi,gk){var gm=G(gh,gj,gl,gi,gk);if(gm.scrollTop!=null){N(gh,gm.scrollTop)}if(gm.scrollLeft!=null){bE(gh,gm.scrollLeft)}}function G(gt,gk,gs,gi,gr){var gp=gt.display,gn=aY(gt.display);if(gs<0){gs=0}var gl=gt.curOp&&gt.curOp.scrollTop!=null?gt.curOp.scrollTop:gp.scroller.scrollTop;var gv=cV(gt),gx={};if(gr-gs>gv){gr=gs+gv}var gj=gt.doc.height+bI(gp);var gh=gs<gn,go=gr>gj-gn;if(gs<gl){gx.scrollTop=gh?0:gs}else{if(gr>gl+gv){var gq=Math.min(gs,(go?gj:gr)-gv);if(gq!=gl){gx.scrollTop=gq}}}var gw=gt.curOp&&gt.curOp.scrollLeft!=null?gt.curOp.scrollLeft:gp.scroller.scrollLeft;var gu=dl(gt)-(gt.options.fixedGutter?gp.gutters.offsetWidth:0);var gm=gi-gk>gu;if(gm){gi=gk+gu}if(gk<10){gx.scrollLeft=0}else{if(gk<gw){gx.scrollLeft=Math.max(0,gk-(gm?0:10))}else{if(gi>gu+gw-3){gx.scrollLeft=gi+(gm?0:10)-gu}}}return gx}function cL(gh,gj,gi){if(gj!=null||gi!=null){fC(gh)}if(gj!=null){gh.curOp.scrollLeft=(gh.curOp.scrollLeft==null?gh.doc.scrollLeft:gh.curOp.scrollLeft)+gj}if(gi!=null){gh.curOp.scrollTop=(gh.curOp.scrollTop==null?gh.doc.scrollTop:gh.curOp.scrollTop)+gi}}function fF(gh){fC(gh);var gi=gh.getCursor(),gk=gi,gj=gi;if(!gh.options.lineWrapping){gk=gi.ch?W(gi.line,gi.ch-1):gi;gj=W(gi.line,gi.ch+1)}gh.curOp.scrollToPos={from:gk,to:gj,margin:gh.options.cursorScrollMargin,isCursor:true}}function fC(gh){var gj=gh.curOp.scrollToPos;if(gj){gh.curOp.scrollToPos=null;var gl=dH(gh,gj.from),gk=dH(gh,gj.to);var gi=G(gh,Math.min(gl.left,gk.left),Math.min(gl.top,gk.top)-gj.margin,Math.max(gl.right,gk.right),Math.max(gl.bottom,gk.bottom)+gj.margin);gh.scrollTo(gi.scrollLeft,gi.scrollTop)}}function ad(gu,gk,gt,gj){var gs=gu.doc,gi;if(gt==null){gt="add"}if(gt=="smart"){if(!gs.mode.indent){gt="prev"}else{gi=dC(gu,gk)}}var go=gu.options.tabSize;var gv=ff(gs,gk),gn=bT(gv.text,null,go);if(gv.stateAfter){gv.stateAfter=null}var gh=gv.text.match(/^\s*/)[0],gq;if(!gj&&!/\S/.test(gv.text)){gq=0;gt="not"}else{if(gt=="smart"){gq=gs.mode.indent(gi,gv.text.slice(gh.length),gv.text);if(gq==ca||gq>150){if(!gj){return}gt="prev"}}}if(gt=="prev"){if(gk>gs.first){gq=bT(ff(gs,gk-1).text,null,go)}else{gq=0}}else{if(gt=="add"){gq=gn+gu.options.indentUnit}else{if(gt=="subtract"){gq=gn-gu.options.indentUnit}else{if(typeof gt=="number"){gq=gn+gt}}}}gq=Math.max(0,gq);var gr="",gp=0;if(gu.options.indentWithTabs){for(var gl=Math.floor(gq/go);gl;--gl){gp+=go;gr+="\t"}}if(gp<gq){gr+=cp(gq-gp)}if(gr!=gh){a2(gs,gr,W(gk,0),W(gk,gh.length),"+input");gv.stateAfter=null;return true}else{for(var gl=0;gl<gs.sel.ranges.length;gl++){var gm=gs.sel.ranges[gl];if(gm.head.line==gk&&gm.head.ch<gh.length){var gp=W(gk,gh.length);e(gs,gl,new dY(gp,gp));break}}}}function ez(gk,gj,gh,gm){var gl=gj,gi=gj;if(typeof gj=="number"){gi=ff(gk,c5(gk,gj))}else{gl=bN(gj)}if(gl==null){return null}if(gm(gi,gl)&&gk.cm){R(gk.cm,gl,gh)}return gi}function eX(gh,gn){var gi=gh.doc.sel.ranges,gl=[];for(var gk=0;gk<gi.length;gk++){var gj=gn(gi[gk]);while(gl.length&&cf(gj.from,fG(gl).to)<=0){var gm=gl.pop();if(cf(gm.from,gj.from)<0){gj.from=gm.from;break}}gl.push(gj)}cM(gh,function(){for(var go=gl.length-1;go>=0;go--){a2(gh.doc,"",gl[go].from,gl[go].to,"+delete")}fF(gh)})}function bw(gz,gl,gt,gs,gn){var gq=gl.line,gr=gl.ch,gy=gt;var gi=ff(gz,gq);var gw=true;function gx(){var gA=gq+gt;if(gA<gz.first||gA>=gz.first+gz.size){return(gw=false)}gq=gA;return gi=ff(gz,gA)}function gv(gB){var gA=(gn?u:ai)(gi,gr,gt,true);if(gA==null){if(!gB&&gx()){if(gn){gr=(gt<0?cS:cE)(gi)}else{gr=gt<0?gi.text.length:0}}else{return(gw=false)}}else{gr=gA}return true}if(gs=="char"){gv()}else{if(gs=="column"){gv(true)}else{if(gs=="word"||gs=="group"){var gu=null,go=gs=="group";var gh=gz.cm&&gz.cm.getHelper(gl,"wordChars");for(var gm=true;;gm=false){if(gt<0&&!gv(!gm)){break}var gj=gi.text.charAt(gr)||"\n";var gk=cA(gj,gh)?"w":go&&gj=="\n"?"n":!go||/\s/.test(gj)?null:"p";if(go&&!gm&&!gk){gk="s"}if(gu&&gu!=gk){if(gt<0){gt=1;gv()}break}if(gk){gu=gk}if(gt>0&&!gv(!gm)){break}}}}}var gp=bV(gz,W(gq,gr),gy,true);if(!gw){gp.hitSide=true}return gp}function bq(gp,gk,gh,go){var gn=gp.doc,gm=gk.left,gl;if(go=="page"){var gj=Math.min(gp.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);gl=gk.top+gh*(gj-(gh<0?1.5:0.5)*aY(gp.display))}else{if(go=="line"){gl=gh>0?gk.bottom+3:gk.top-3}}for(;;){var gi=fO(gp,gm,gl);if(!gi.outside){break}if(gh<0?gl<=0:gl>=gn.height){gi.hitSide=true;break}gl+=gh*5}return gi}H.prototype={constructor:H,focus:function(){window.focus();this.display.input.focus()},setOption:function(gj,gk){var gi=this.options,gh=gi[gj];if(gi[gj]==gk&&gj!="mode"){return}gi[gj]=gk;if(bf.hasOwnProperty(gj)){c2(this,bf[gj])(this,gk,gh)}},getOption:function(gh){return this.options[gh]},getDoc:function(){return this.doc},addKeyMap:function(gi,gh){this.state.keyMaps[gh?"push":"unshift"](fX(gi))},removeKeyMap:function(gi){var gj=this.state.keyMaps;for(var gh=0;gh<gj.length;++gh){if(gj[gh]==gi||gj[gh].name==gi){gj.splice(gh,1);return true}}},addOverlay:c8(function(gh,gi){var gj=gh.token?gh:H.getMode(this.options,gh);if(gj.startState){throw new Error("Overlays may not be stateful.")}this.state.overlays.push({mode:gj,modeSpec:gh,opaque:gi&&gi.opaque});this.state.modeGen++;ah(this)}),removeOverlay:c8(function(gh){var gj=this.state.overlays;for(var gi=0;gi<gj.length;++gi){var gk=gj[gi].modeSpec;if(gk==gh||typeof gh=="string"&&gk.name==gh){gj.splice(gi,1);this.state.modeGen++;ah(this);return}}}),indentLine:c8(function(gj,gh,gi){if(typeof gh!="string"&&typeof gh!="number"){if(gh==null){gh=this.options.smartIndent?"smart":"prev"}else{gh=gh?"add":"subtract"}}if(b9(this.doc,gj)){ad(this,gj,gh,gi)}}),indentSelection:c8(function(gq){var gh=this.doc.sel.ranges,gk=-1;for(var gm=0;gm<gh.length;gm++){var gn=gh[gm];if(!gn.empty()){var go=gn.from(),gp=gn.to();var gi=Math.max(gk,go.line);gk=Math.min(this.lastLine(),gp.line-(gp.ch?0:1))+1;for(var gl=gi;gl<gk;++gl){ad(this,gl,gq)}var gj=this.doc.sel.ranges;if(go.ch==0&&gh.length==gj.length&&gj[gm].from().ch>0){e(this.doc,gm,new dY(go,gj[gm].to()),Z)}}else{if(gn.head.line>gk){ad(this,gn.head.line,gq,true);gk=gn.head.line;if(gm==this.doc.sel.primIndex){fF(this)}}}}}),getTokenAt:function(gi,gh){return cq(this,gi,gh)},getLineTokens:function(gi,gh){return cq(this,W(gi),gh,true)},getTokenTypeAt:function(go){go=fJ(this.doc,go);var gk=c6(this,ff(this.doc,go.line));var gm=0,gn=(gk.length-1)/2,gj=go.ch;var gi;if(gj==0){gi=gk[2]}else{for(;;){var gh=(gm+gn)>>1;if((gh?gk[gh*2-1]:0)>=gj){gn=gh}else{if(gk[gh*2+1]<gj){gm=gh+1}else{gi=gk[gh*2+2];break}}}}var gl=gi?gi.indexOf("cm-overlay "):-1;return gl<0?gi:gl==0?null:gi.slice(0,gl-1)},getModeAt:function(gi){var gh=this.doc.mode;if(!gh.innerMode){return gh}return H.innerMode(gh,this.getTokenAt(gi).state).mode},getHelper:function(gi,gh){return this.getHelpers(gi,gh)[0]},getHelpers:function(go,gj){var gk=[];if(!fo.hasOwnProperty(gj)){return gk}var gh=fo[gj],gn=this.getModeAt(go);if(typeof gn[gj]=="string"){if(gh[gn[gj]]){gk.push(gh[gn[gj]])}}else{if(gn[gj]){for(var gi=0;gi<gn[gj].length;gi++){var gm=gh[gn[gj][gi]];if(gm){gk.push(gm)}}}else{if(gn.helperType&&gh[gn.helperType]){gk.push(gh[gn.helperType])}else{if(gh[gn.name]){gk.push(gh[gn.name])}}}}for(var gi=0;gi<gh._global.length;gi++){var gl=gh._global[gi];if(gl.pred(gn,this)&&dh(gk,gl.val)==-1){gk.push(gl.val)}}return gk},getStateAfter:function(gi,gh){var gj=this.doc;gi=c5(gj,gi==null?gj.first+gj.size-1:gi);return dC(this,gi+1,gh)},cursorCoords:function(gk,gi){var gj,gh=this.doc.sel.primary();if(gk==null){gj=gh.head}else{if(typeof gk=="object"){gj=fJ(this.doc,gk)}else{gj=gk?gh.from():gh.to()}}return dU(this,gj,gi||"page")},charCoords:function(gi,gh){return cJ(this,fJ(this.doc,gi),gh||"page")},coordsChar:function(gh,gi){gh=ge(this,gh,gi||"page");return fO(this,gh.left,gh.top)},lineAtHeight:function(gh,gi){gh=ge(this,{top:gh,left:0},gi||"page").top;return bG(this.doc,gh+this.display.viewOffset)},heightAtLine:function(gi,gl){var gh=false,gj;if(typeof gi=="number"){var gk=this.doc.first+this.doc.size-1;if(gi<this.doc.first){gi=this.doc.first}else{if(gi>gk){gi=gk;gh=true}}gj=ff(this.doc,gi)}else{gj=gi}return eQ(this,gj,{top:0,left:0},gl||"page").top+(gh?this.doc.height-bM(gj):0)},defaultTextHeight:function(){return aY(this.display)},defaultCharWidth:function(){return dD(this.display)},setGutterMarker:c8(function(gh,gi,gj){return ez(this.doc,gh,"gutter",function(gk){var gl=gk.gutterMarkers||(gk.gutterMarkers={});gl[gi]=gj;if(!gj&&eU(gl)){gk.gutterMarkers=null}return true})}),clearGutter:c8(function(gj){var gh=this,gk=gh.doc,gi=gk.first;gk.iter(function(gl){if(gl.gutterMarkers&&gl.gutterMarkers[gj]){gl.gutterMarkers[gj]=null;R(gh,gi,"gutter");if(eU(gl.gutterMarkers)){gl.gutterMarkers=null}}++gi})}),lineInfo:function(gh){if(typeof gh=="number"){if(!b9(this.doc,gh)){return null}var gi=gh;gh=ff(this.doc,gh);if(!gh){return null}}else{var gi=bN(gh);if(gi==null){return null}}return{line:gi,handle:gh,text:gh.text,gutterMarkers:gh.gutterMarkers,textClass:gh.textClass,bgClass:gh.bgClass,wrapClass:gh.wrapClass,widgets:gh.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(gm,gj,go,gk,gq){var gl=this.display;gm=dU(this,fJ(this.doc,gm));var gn=gm.bottom,gi=gm.left;gj.style.position="absolute";gj.setAttribute("cm-ignore-events","true");this.display.input.setUneditable(gj);gl.sizer.appendChild(gj);if(gk=="over"){gn=gm.top}else{if(gk=="above"||gk=="near"){var gh=Math.max(gl.wrapper.clientHeight,this.doc.height),gp=Math.max(gl.sizer.clientWidth,gl.lineSpace.clientWidth);if((gk=="above"||gm.bottom+gj.offsetHeight>gh)&&gm.top>gj.offsetHeight){gn=gm.top-gj.offsetHeight}else{if(gm.bottom+gj.offsetHeight<=gh){gn=gm.bottom}}if(gi+gj.offsetWidth>gp){gi=gp-gj.offsetWidth}}}gj.style.top=gn+"px";gj.style.left=gj.style.right="";if(gq=="right"){gi=gl.sizer.clientWidth-gj.offsetWidth;gj.style.right="0px"}else{if(gq=="left"){gi=0}else{if(gq=="middle"){gi=(gl.sizer.clientWidth-gj.offsetWidth)/2}}gj.style.left=gi+"px"}if(go){E(this,gi,gn,gi+gj.offsetWidth,gn+gj.offsetHeight)}},triggerOnKeyDown:c8(p),triggerOnKeyPress:c8(cx),triggerOnKeyUp:bi,execCommand:function(gh){if(eD.hasOwnProperty(gh)){return eD[gh](this)}},triggerElectric:c8(function(gh){fV(this,gh)}),findPosH:function(gn,gk,gl,gi){var gh=1;if(gk<0){gh=-1;gk=-gk}for(var gj=0,gm=fJ(this.doc,gn);gj<gk;++gj){gm=bw(this.doc,gm,gh,gl,gi);if(gm.hitSide){break}}return gm},moveH:c8(function(gi,gj){var gh=this;gh.extendSelectionsBy(function(gk){if(gh.display.shift||gh.doc.extend||gk.empty()){return bw(gh.doc,gk.head,gi,gj,gh.options.rtlMoveVisually)}else{return gi<0?gk.from():gk.to()}},cW)}),deleteH:c8(function(gh,gi){var gj=this.doc.sel,gk=this.doc;if(gj.somethingSelected()){gk.replaceSelection("",null,"+delete")}else{eX(this,function(gm){var gl=bw(gk,gm.head,gh,gi,false);return gh<0?{from:gl,to:gm.head}:{from:gm.head,to:gl}})}}),findPosV:function(gm,gj,gn,gp){var gh=1,gl=gp;if(gj<0){gh=-1;gj=-gj}for(var gi=0,go=fJ(this.doc,gm);gi<gj;++gi){var gk=dU(this,go,"div");if(gl==null){gl=gk.left}else{gk.left=gl}go=bq(this,gk,gh,gn);if(go.hitSide){break}}return go},moveV:c8(function(gi,gk){var gh=this,gm=this.doc,gl=[];var gn=!gh.display.shift&&!gm.extend&&gm.sel.somethingSelected();gm.extendSelectionsBy(function(go){if(gn){return gi<0?go.from():go.to()}var gq=dU(gh,go.head,"div");if(go.goalColumn!=null){gq.left=go.goalColumn}gl.push(gq.left);var gp=bq(gh,gq,gi,gk);if(gk=="page"&&go==gm.sel.primary()){cL(gh,null,cJ(gh,gp,"div").top-gq.top)}return gp},cW);if(gl.length){for(var gj=0;gj<gm.sel.ranges.length;gj++){gm.sel.ranges[gj].goalColumn=gl[gj]}}}),findWordAt:function(go){var gm=this.doc,gk=ff(gm,go.line).text;var gn=go.ch,gj=go.ch;if(gk){var gl=this.getHelper(go,"wordChars");if((go.xRel<0||gj==gk.length)&&gn){--gn}else{++gj}var gi=gk.charAt(gn);var gh=cA(gi,gl)?function(gp){return cA(gp,gl)}:/\s/.test(gi)?function(gp){return/\s/.test(gp)}:function(gp){return !/\s/.test(gp)&&!cA(gp)};while(gn>0&&gh(gk.charAt(gn-1))){--gn}while(gj<gk.length&&gh(gk.charAt(gj))){++gj}}return new dY(W(go.line,gn),W(go.line,gj))},toggleOverwrite:function(gh){if(gh!=null&&gh==this.state.overwrite){return}if(this.state.overwrite=!this.state.overwrite){fA(this.display.cursorDiv,"CodeMirror-overwrite")}else{f(this.display.cursorDiv,"CodeMirror-overwrite")}aE(this,"overwriteToggle",this,this.state.overwrite)},hasFocus:function(){return this.display.input.getField()==dO()},scrollTo:c8(function(gh,gi){if(gh!=null||gi!=null){fC(this)}if(gh!=null){this.curOp.scrollLeft=gh}if(gi!=null){this.curOp.scrollTop=gi}}),getScrollInfo:function(){var gh=this.display.scroller;return{left:gh.scrollLeft,top:gh.scrollTop,height:gh.scrollHeight-cT(this)-this.display.barHeight,width:gh.scrollWidth-cT(this)-this.display.barWidth,clientHeight:cV(this),clientWidth:dl(this)}},scrollIntoView:c8(function(gi,gj){if(gi==null){gi={from:this.doc.sel.primary().head,to:null};if(gj==null){gj=this.options.cursorScrollMargin}}else{if(typeof gi=="number"){gi={from:W(gi,0),to:null}}else{if(gi.from==null){gi={from:gi,to:null}}}}if(!gi.to){gi.to=gi.from}gi.margin=gj||0;if(gi.from.line!=null){fC(this);this.curOp.scrollToPos=gi}else{var gh=G(this,Math.min(gi.from.left,gi.to.left),Math.min(gi.from.top,gi.to.top)-gi.margin,Math.max(gi.from.right,gi.to.right),Math.max(gi.from.bottom,gi.to.bottom)+gi.margin);this.scrollTo(gh.scrollLeft,gh.scrollTop)}}),setSize:c8(function(gk,gi){var gh=this;function gj(gm){return typeof gm=="number"||/^\d+$/.test(String(gm))?gm+"px":gm}if(gk!=null){gh.display.wrapper.style.width=gj(gk)}if(gi!=null){gh.display.wrapper.style.height=gj(gi)}if(gh.options.lineWrapping){aO(this)}var gl=gh.display.viewFrom;gh.doc.iter(gl,gh.display.viewTo,function(gm){if(gm.widgets){for(var gn=0;gn<gm.widgets.length;gn++){if(gm.widgets[gn].noHScroll){R(gh,gl,"widget");break}}}++gl});gh.curOp.forceUpdate=true;aE(gh,"refresh",this)}),operation:function(gh){return cM(this,gh)},refresh:c8(function(){var gh=this.display.cachedTextHeight;ah(this);this.curOp.forceUpdate=true;ak(this);this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop);c4(this);if(gh==null||Math.abs(gh-aY(this.display))>0.5){X(this)}aE(this,"refresh",this)}),swapDoc:c8(function(gi){var gh=this.doc;gh.cm=null;eb(this,gi);ak(this);this.display.input.reset();this.scrollTo(gi.scrollLeft,gi.scrollTop);this.curOp.forceScroll=true;ae(this,"swapDoc",this,gh);return gh}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};by(H);var e3=H.defaults={};var bf=H.optionHandlers={};function s(gh,gk,gj,gi){H.defaults[gh]=gk;if(gj){bf[gh]=gi?function(gl,gn,gm){if(gm!=cc){gj(gl,gn,gm)}}:gj}}var cc=H.Init={toString:function(){return"CodeMirror.Init"}};s("value","",function(gh,gi){gh.setValue(gi)},true);s("mode",null,function(gh,gi){gh.doc.modeOption=gi;br(gh)},true);s("indentUnit",2,br,true);s("indentWithTabs",false);s("smartIndent",true);s("tabSize",4,function(gh){el(gh);ak(gh);ah(gh)},true);s("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(gh,gj,gi){gh.state.specialChars=new RegExp(gj.source+(gj.test("\t")?"":"|\t"),"g");if(gi!=H.Init){gh.refresh()}});s("specialCharPlaceholder",fc,function(gh){gh.refresh()},true);s("electricChars",true);s("inputStyle",eg?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},true);s("rtlMoveVisually",!aP);s("wholeLineUpdateBefore",true);s("theme","default",function(gh){cO(gh);dw(gh)},true);s("keyMap","default",function(gh,gl,gi){var gj=fX(gl);var gk=gi!=H.Init&&fX(gi);if(gk&&gk.detach){gk.detach(gh,gj)}if(gj.attach){gj.attach(gh,gk||null)}});s("extraKeys",null);s("lineWrapping",false,eG,true);s("gutters",[],function(gh){ce(gh.options);dw(gh)},true);s("fixedGutter",true,function(gh,gi){gh.display.gutters.style.left=gi?dX(gh.display)+"px":"0";gh.refresh()},true);s("coverGutterNextToScrollbar",false,function(gh){eY(gh)},true);s("scrollbarStyle","native",function(gh){aD(gh);eY(gh);gh.display.scrollbars.setScrollTop(gh.doc.scrollTop);gh.display.scrollbars.setScrollLeft(gh.doc.scrollLeft)},true);s("lineNumbers",false,function(gh){ce(gh.options);dw(gh)},true);s("firstLineNumber",1,dw,true);s("lineNumberFormatter",function(gh){return gh},dw,true);s("showCursorWhenSelecting",false,bC,true);s("resetSelectionOnContextMenu",true);s("lineWiseCopyCut",true);s("readOnly",false,function(gh,gi){if(gi=="nocursor"){aV(gh);gh.display.input.blur();gh.display.disabled=true}else{gh.display.disabled=false;if(!gi){gh.display.input.reset()}}});s("disableInput",false,function(gh,gi){if(!gi){gh.display.input.reset()}},true);s("dragDrop",true,f0);s("cursorBlinkRate",530);s("cursorScrollMargin",0);s("cursorHeight",1,bC,true);s("singleCursorHeightPerLine",true,bC,true);s("workTime",100);s("workDelay",100);s("flattenSpans",true,el,true);s("addModeClass",false,el,true);s("pollInterval",100);s("undoDepth",200,function(gh,gi){gh.doc.history.undoDepth=gi});s("historyEventDelay",1250);s("viewportMargin",10,function(gh){gh.refresh()},true);s("maxHighlightLength",10000,el,true);s("moveInputWithCursor",true,function(gh,gi){if(!gi){gh.display.input.resetPosition()}});s("tabindex",null,function(gh,gi){gh.display.input.getField().tabIndex=gi||""});s("autofocus",null);var ds=H.modes={},aS=H.mimeModes={};H.defineMode=function(gh,gi){if(!H.defaults.mode&&gh!="null"){H.defaults.mode=gh}if(arguments.length>2){gi.dependencies=Array.prototype.slice.call(arguments,2)}ds[gh]=gi};H.defineMIME=function(gi,gh){aS[gi]=gh};H.resolveMode=function(gh){if(typeof gh=="string"&&aS.hasOwnProperty(gh)){gh=aS[gh]}else{if(gh&&typeof gh.name=="string"&&aS.hasOwnProperty(gh.name)){var gi=aS[gh.name];if(typeof gi=="string"){gi={name:gi}}gh=ck(gi,gh);gh.name=gi.name}else{if(typeof gh=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(gh)){return H.resolveMode("application/xml")}}}if(typeof gh=="string"){return{name:gh}}else{return gh||{name:"null"}}};H.getMode=function(gi,gh){var gh=H.resolveMode(gh);var gk=ds[gh.name];if(!gk){return H.getMode(gi,"text/plain")}var gl=gk(gi,gh);if(dp.hasOwnProperty(gh.name)){var gj=dp[gh.name];for(var gm in gj){if(!gj.hasOwnProperty(gm)){continue}if(gl.hasOwnProperty(gm)){gl["_"+gm]=gl[gm]}gl[gm]=gj[gm]}}gl.name=gh.name;if(gh.helperType){gl.helperType=gh.helperType}if(gh.modeProps){for(var gm in gh.modeProps){gl[gm]=gh.modeProps[gm]}}return gl};H.defineMode("null",function(){return{token:function(gh){gh.skipToEnd()}}});H.defineMIME("text/plain","null");var dp=H.modeExtensions={};H.extendMode=function(gj,gi){var gh=dp.hasOwnProperty(gj)?dp[gj]:(dp[gj]={});aN(gi,gh)};H.defineExtension=function(gh,gi){H.prototype[gh]=gi};H.defineDocExtension=function(gh,gi){at.prototype[gh]=gi};H.defineOption=s;var a9=[];H.defineInitHook=function(gh){a9.push(gh)};var fo=H.helpers={};H.registerHelper=function(gi,gh,gj){if(!fo.hasOwnProperty(gi)){fo[gi]=H[gi]={_global:[]}}fo[gi][gh]=gj};H.registerGlobalHelper=function(gj,gi,gh,gk){H.registerHelper(gj,gi,gk);fo[gj]._global.push({pred:gh,val:gk})};var b3=H.copyState=function(gk,gh){if(gh===true){return gh}if(gk.copyState){return gk.copyState(gh)}var gj={};for(var gl in gh){var gi=gh[gl];if(gi instanceof Array){gi=gi.concat([])}gj[gl]=gi}return gj};var b0=H.startState=function(gj,gi,gh){return gj.startState?gj.startState(gi,gh):true};H.innerMode=function(gj,gh){while(gj.innerMode){var gi=gj.innerMode(gh);if(!gi||gi.mode==gj){break}gh=gi.state;gj=gi.mode}return gi||{mode:gj,state:gh}};var eD=H.commands={selectAll:function(gh){gh.setSelection(W(gh.firstLine(),0),W(gh.lastLine()),Z)},singleSelection:function(gh){gh.setSelection(gh.getCursor("anchor"),gh.getCursor("head"),Z)},killLine:function(gh){eX(gh,function(gj){if(gj.empty()){var gi=ff(gh.doc,gj.head.line).text.length;if(gj.head.ch==gi&&gj.head.line<gh.lastLine()){return{from:gj.head,to:W(gj.head.line+1,0)}}else{return{from:gj.head,to:W(gj.head.line,gi)}}}else{return{from:gj.from(),to:gj.to()}}})},deleteLine:function(gh){eX(gh,function(gi){return{from:W(gi.from().line,0),to:fJ(gh.doc,W(gi.to().line+1,0))}})},delLineLeft:function(gh){eX(gh,function(gi){return{from:W(gi.from().line,0),to:gi.from()}})},delWrappedLineLeft:function(gh){eX(gh,function(gi){var gk=gh.charCoords(gi.head,"div").top+5;var gj=gh.coordsChar({left:0,top:gk},"div");return{from:gj,to:gi.from()}})},delWrappedLineRight:function(gh){eX(gh,function(gi){var gk=gh.charCoords(gi.head,"div").top+5;var gj=gh.coordsChar({left:gh.display.lineDiv.offsetWidth+100,top:gk},"div");return{from:gi.from(),to:gj}})},undo:function(gh){gh.undo()},redo:function(gh){gh.redo()},undoSelection:function(gh){gh.undoSelection()},redoSelection:function(gh){gh.redoSelection()},goDocStart:function(gh){gh.extendSelection(W(gh.firstLine(),0))},goDocEnd:function(gh){gh.extendSelection(W(gh.lastLine()))},goLineStart:function(gh){gh.extendSelectionsBy(function(gi){return bt(gh,gi.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(gh){gh.extendSelectionsBy(function(gi){return dI(gh,gi.head)},{origin:"+move",bias:1})},goLineEnd:function(gh){gh.extendSelectionsBy(function(gi){return dP(gh,gi.head.line)},{origin:"+move",bias:-1})},goLineRight:function(gh){gh.extendSelectionsBy(function(gi){var gj=gh.charCoords(gi.head,"div").top+5;return gh.coordsChar({left:gh.display.lineDiv.offsetWidth+100,top:gj},"div")},cW)},goLineLeft:function(gh){gh.extendSelectionsBy(function(gi){var gj=gh.charCoords(gi.head,"div").top+5;return gh.coordsChar({left:0,top:gj},"div")},cW)},goLineLeftSmart:function(gh){gh.extendSelectionsBy(function(gi){var gj=gh.charCoords(gi.head,"div").top+5;var gk=gh.coordsChar({left:0,top:gj},"div");if(gk.ch<gh.getLine(gk.line).search(/\S/)){return dI(gh,gi.head)}return gk},cW)},goLineUp:function(gh){gh.moveV(-1,"line")},goLineDown:function(gh){gh.moveV(1,"line")},goPageUp:function(gh){gh.moveV(-1,"page")},goPageDown:function(gh){gh.moveV(1,"page")},goCharLeft:function(gh){gh.moveH(-1,"char")},goCharRight:function(gh){gh.moveH(1,"char")},goColumnLeft:function(gh){gh.moveH(-1,"column")},goColumnRight:function(gh){gh.moveH(1,"column")},goWordLeft:function(gh){gh.moveH(-1,"word")},goGroupRight:function(gh){gh.moveH(1,"group")},goGroupLeft:function(gh){gh.moveH(-1,"group")},goWordRight:function(gh){gh.moveH(1,"word")},delCharBefore:function(gh){gh.deleteH(-1,"char")},delCharAfter:function(gh){gh.deleteH(1,"char")},delWordBefore:function(gh){gh.deleteH(-1,"word")},delWordAfter:function(gh){gh.deleteH(1,"word")},delGroupBefore:function(gh){gh.deleteH(-1,"group")},delGroupAfter:function(gh){gh.deleteH(1,"group")},indentAuto:function(gh){gh.indentSelection("smart")},indentMore:function(gh){gh.indentSelection("add")},indentLess:function(gh){gh.indentSelection("subtract")},insertTab:function(gh){gh.replaceSelection("\t")},insertSoftTab:function(gh){var gj=[],gi=gh.listSelections(),gm=gh.options.tabSize;for(var gl=0;gl<gi.length;gl++){var gn=gi[gl].from();var gk=bT(gh.getLine(gn.line),gn.ch,gm);gj.push(new Array(gm-gk%gm+1).join(" "))}gh.replaceSelections(gj)},defaultTab:function(gh){if(gh.somethingSelected()){gh.indentSelection("add")}else{gh.execCommand("insertTab")}},transposeChars:function(gh){cM(gh,function(){var gk=gh.listSelections(),gj=[];for(var gl=0;gl<gk.length;gl++){var gn=gk[gl].head,gi=ff(gh.doc,gn.line).text;if(gi){if(gn.ch==gi.length){gn=new W(gn.line,gn.ch-1)}if(gn.ch>0){gn=new W(gn.line,gn.ch+1);gh.replaceRange(gi.charAt(gn.ch-1)+gi.charAt(gn.ch-2),W(gn.line,gn.ch-2),gn,"+transpose")}else{if(gn.line>gh.doc.first){var gm=ff(gh.doc,gn.line-1).text;if(gm){gh.replaceRange(gi.charAt(0)+"\n"+gm.charAt(gm.length-1),W(gn.line-1,gm.length-1),W(gn.line,1),"+transpose")}}}}gj.push(new dY(gn,gn))}gh.setSelections(gj)})},newlineAndIndent:function(gh){cM(gh,function(){var gi=gh.listSelections().length;for(var gk=0;gk<gi;gk++){var gj=gh.listSelections()[gk];gh.replaceRange("\n",gj.anchor,gj.head,"+input");gh.indentLine(gj.from().line+1,null,true);fF(gh)}})},toggleOverwrite:function(gh){gh.toggleOverwrite()}};var fa=H.keyMap={};fa.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"};fa.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};fa.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"};fa.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]};fa["default"]=b7?fa.macDefault:fa.pcDefault;function dt(gi){var go=gi.split(/-(?!$)/),gi=go[go.length-1];var gn,gm,gh,gl;for(var gk=0;gk<go.length-1;gk++){var gj=go[gk];if(/^(cmd|meta|m)$/i.test(gj)){gl=true}else{if(/^a(lt)?$/i.test(gj)){gn=true}else{if(/^(c|ctrl|control)$/i.test(gj)){gm=true}else{if(/^s(hift)$/i.test(gj)){gh=true}else{throw new Error("Unrecognized modifier name: "+gj)}}}}}if(gn){gi="Alt-"+gi}if(gm){gi="Ctrl-"+gi}if(gl){gi="Cmd-"+gi}if(gh){gi="Shift-"+gi}return gi}H.normalizeKeyMap=function(go){var gi={};for(var gn in go){if(go.hasOwnProperty(gn)){var gp=go[gn];if(/^(name|fallthrough|(de|at)tach)$/.test(gn)){continue}if(gp=="..."){delete go[gn];continue}var gq=bS(gn.split(" "),dt);for(var gm=0;gm<gq.length;gm++){var gk,gj;if(gm==gq.length-1){gj=gq.join(" ");gk=gp}else{gj=gq.slice(0,gm+1).join(" ");gk="..."}var gl=gi[gj];if(!gl){gi[gj]=gk}else{if(gl!=gk){throw new Error("Inconsistent bindings for "+gj)}}}delete go[gn]}}for(var gh in gi){go[gh]=gi[gh]}return go};var i=H.lookupKey=function(gk,gn,gm,gj){gn=fX(gn);var gl=gn.call?gn.call(gk,gj):gn[gk];if(gl===false){return"nothing"}if(gl==="..."){return"multi"}if(gl!=null&&gm(gl)){return"handled"}if(gn.fallthrough){if(Object.prototype.toString.call(gn.fallthrough)!="[object Array]"){return i(gk,gn.fallthrough,gm,gj)}for(var gi=0;gi<gn.fallthrough.length;gi++){var gh=i(gk,gn.fallthrough[gi],gm,gj);if(gh){return gh}}}};var eC=H.isModifierKey=function(gi){var gh=typeof gi=="string"?gi:fg[gi.keyCode];return gh=="Ctrl"||gh=="Alt"||gh=="Shift"||gh=="Mod"};var fr=H.keyName=function(gi,gk){if(d3&&gi.keyCode==34&&gi["char"]){return false}var gj=fg[gi.keyCode],gh=gj;if(gh==null||gi.altGraphKey){return false}if(gi.altKey&&gj!="Alt"){gh="Alt-"+gh}if((bQ?gi.metaKey:gi.ctrlKey)&&gj!="Ctrl"){gh="Ctrl-"+gh}if((bQ?gi.ctrlKey:gi.metaKey)&&gj!="Cmd"){gh="Cmd-"+gh}if(!gk&&gi.shiftKey&&gj!="Shift"){gh="Shift-"+gh}return gh};function fX(gh){return typeof gh=="string"?fa[gh]:gh}H.fromTextArea=function(go,gp){gp=gp?aN(gp):{};gp.value=go.value;if(!gp.tabindex&&go.tabIndex){gp.tabindex=go.tabIndex}if(!gp.placeholder&&go.placeholder){gp.placeholder=go.placeholder}if(gp.autofocus==null){var gh=dO();gp.autofocus=gh==go||go.getAttribute("autofocus")!=null&&gh==document.body}function gl(){go.value=gn.getValue()}if(go.form){bX(go.form,"submit",gl);if(!gp.leaveSubmitMethodAlone){var gi=go.form,gm=gi.submit;try{var gk=gi.submit=function(){gl();gi.submit=gm;gi.submit();gi.submit=gk}}catch(gj){}}}gp.finishInit=function(gq){gq.save=gl;gq.getTextArea=function(){return go};gq.toTextArea=function(){gq.toTextArea=isNaN;gl();go.parentNode.removeChild(gq.getWrapperElement());go.style.display="";if(go.form){ed(go.form,"submit",gl);if(typeof go.form.submit=="function"){go.form.submit=gm}}}};go.style.display="none";var gn=H(function(gq){go.parentNode.insertBefore(gq,go.nextSibling)},gp);return gn};var eT=H.StringStream=function(gh,gi){this.pos=this.start=0;this.string=gh;this.tabSize=gi||8;this.lastColumnPos=this.lastColumnValue=0;this.lineStart=0};eT.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length){return this.string.charAt(this.pos++)}},eat:function(gh){var gj=this.string.charAt(this.pos);if(typeof gh=="string"){var gi=gj==gh}else{var gi=gj&&(gh.test?gh.test(gj):gh(gj))}if(gi){++this.pos;return gj}},eatWhile:function(gh){var gi=this.pos;while(this.eat(gh)){}return this.pos>gi},eatSpace:function(){var gh=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos))){++this.pos}return this.pos>gh},skipToEnd:function(){this.pos=this.string.length},skipTo:function(gh){var gi=this.string.indexOf(gh,this.pos);if(gi>-1){this.pos=gi;return true}},backUp:function(gh){this.pos-=gh},column:function(){if(this.lastColumnPos<this.start){this.lastColumnValue=bT(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start}return this.lastColumnValue-(this.lineStart?bT(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return bT(this.string,null,this.tabSize)-(this.lineStart?bT(this.string,this.lineStart,this.tabSize):0)},match:function(gl,gi,gh){if(typeof gl=="string"){var gm=function(gn){return gh?gn.toLowerCase():gn};var gk=this.string.substr(this.pos,gl.length);if(gm(gk)==gm(gl)){if(gi!==false){this.pos+=gl.length}return true}}else{var gj=this.string.slice(this.pos).match(gl);if(gj&&gj.index>0){return null}if(gj&&gi!==false){this.pos+=gj[0].length}return gj}},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(gi,gh){this.lineStart+=gi;try{return gh()}finally{this.lineStart-=gi}}};var a6=0;var P=H.TextMarker=function(gi,gh){this.lines=[];this.type=gh;this.doc=gi;this.id=++a6};by(P);P.prototype.clear=function(){if(this.explicitlyCleared){return}var go=this.doc.cm,gi=go&&!go.curOp;if(gi){cI(go)}if(fi(this,"clear")){var gp=this.find();if(gp){ae(this,"clear",gp.from,gp.to)}}var gj=null,gm=null;for(var gk=0;gk<this.lines.length;++gk){var gq=this.lines[gk];var gn=e9(gq.markedSpans,this);if(go&&!this.collapsed){R(go,bN(gq),"text")}else{if(go){if(gn.to!=null){gm=bN(gq)}if(gn.from!=null){gj=bN(gq)}}}gq.markedSpans=eH(gq.markedSpans,gn);if(gn.from==null&&this.collapsed&&!fw(this.doc,gq)&&go){f5(gq,aY(go.display))}}if(go&&this.collapsed&&!go.options.lineWrapping){for(var gk=0;gk<this.lines.length;++gk){var gh=y(this.lines[gk]),gl=en(gh);if(gl>go.display.maxLineLength){go.display.maxLine=gh;go.display.maxLineLength=gl;go.display.maxLineChanged=true}}}if(gj!=null&&go&&this.collapsed){ah(go,gj,gm+1)}this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit){this.doc.cantEdit=false;if(go){ey(go.doc)}}if(go){ae(go,"markerCleared",go,this)}if(gi){am(go)}if(this.parent){this.parent.clear()}};P.prototype.find=function(gk,gi){if(gk==null&&this.type=="bookmark"){gk=1}var gn,gm;for(var gj=0;gj<this.lines.length;++gj){var gh=this.lines[gj];var gl=e9(gh.markedSpans,this);if(gl.from!=null){gn=W(gi?gh:bN(gh),gl.from);if(gk==-1){return gn}}if(gl.to!=null){gm=W(gi?gh:bN(gh),gl.to);if(gk==1){return gm}}}return gn&&{from:gn,to:gm}};P.prototype.changed=function(){var gj=this.find(-1,true),gi=this,gh=this.doc.cm;if(!gj||!gh){return}cM(gh,function(){var gl=gj.line,gm=bN(gj.line);var gk=fb(gh,gm);if(gk){au(gk);gh.curOp.selectionChanged=gh.curOp.forceUpdate=true}gh.curOp.updateMaxLine=true;if(!fw(gi.doc,gl)&&gi.height!=null){var go=gi.height;gi.height=null;var gn=cY(gi)-go;if(gn){f5(gl,gl.height+gn)}}})};P.prototype.attachLine=function(gh){if(!this.lines.length&&this.doc.cm){var gi=this.doc.cm.curOp;if(!gi.maybeHiddenMarkers||dh(gi.maybeHiddenMarkers,this)==-1){(gi.maybeUnhiddenMarkers||(gi.maybeUnhiddenMarkers=[])).push(this)}}this.lines.push(gh)};P.prototype.detachLine=function(gh){this.lines.splice(dh(this.lines,gh),1);if(!this.lines.length&&this.doc.cm){var gi=this.doc.cm.curOp;(gi.maybeHiddenMarkers||(gi.maybeHiddenMarkers=[])).push(this)}};var a6=0;function eF(gp,gn,go,gr,gl){if(gr&&gr.shared){return O(gp,gn,go,gr,gl)}if(gp.cm&&!gp.cm.curOp){return c2(gp.cm,eF)(gp,gn,go,gr,gl)}var gk=new P(gp,gl),gq=cf(gn,go);if(gr){aN(gr,gk,false)}if(gq>0||gq==0&&gk.clearWhenEmpty!==false){return gk}if(gk.replacedWith){gk.collapsed=true;gk.widgetNode=f2("span",[gk.replacedWith],"CodeMirror-widget");if(!gr.handleMouseEvents){gk.widgetNode.setAttribute("cm-ignore-events","true")}if(gr.insertLeft){gk.widgetNode.insertLeft=true}}if(gk.collapsed){if(z(gp,gn.line,gn,go,gk)||gn.line!=go.line&&z(gp,go.line,gn,go,gk)){throw new Error("Inserting collapsed marker partially overlapping an existing one")}a8=true}if(gk.addToHistory){fM(gp,{from:gn,to:go,origin:"markText"},gp.sel,NaN)}var gi=gn.line,gm=gp.cm,gh;gp.iter(gi,go.line+1,function(gs){if(gm&&gk.collapsed&&!gm.options.lineWrapping&&y(gs)==gm.display.maxLine){gh=true}if(gk.collapsed&&gi!=gn.line){f5(gs,0)}cd(gs,new ei(gk,gi==gn.line?gn.ch:null,gi==go.line?go.ch:null));++gi});if(gk.collapsed){gp.iter(gn.line,go.line+1,function(gs){if(fw(gp,gs)){f5(gs,0)}})}if(gk.clearOnEnter){bX(gk,"beforeCursorEnter",function(){gk.clear()})}if(gk.readOnly){gc=true;if(gp.history.done.length||gp.history.undone.length){gp.clearHistory()}}if(gk.collapsed){gk.id=++a6;gk.atomic=true}if(gm){if(gh){gm.curOp.updateMaxLine=true}if(gk.collapsed){ah(gm,gn.line,go.line+1)}else{if(gk.className||gk.title||gk.startStyle||gk.endStyle||gk.css){for(var gj=gn.line;gj<=go.line;gj++){R(gm,gj,"text")}}}if(gk.atomic){ey(gm.doc)}ae(gm,"markerAdded",gm,gk)}return gk}var x=H.SharedTextMarker=function(gj,gi){this.markers=gj;this.primary=gi;for(var gh=0;gh<gj.length;++gh){gj[gh].parent=this}};by(x);x.prototype.clear=function(){if(this.explicitlyCleared){return}this.explicitlyCleared=true;for(var gh=0;gh<this.markers.length;++gh){this.markers[gh].clear()}ae(this,"clear")};x.prototype.find=function(gi,gh){return this.primary.find(gi,gh)};function O(gl,go,gn,gh,gj){gh=aN(gh);gh.shared=false;var gm=[eF(gl,go,gn,gh,gj)],gi=gm[0];var gk=gh.widgetNode;d7(gl,function(gq){if(gk){gh.widgetNode=gk.cloneNode(true)}gm.push(eF(gq,fJ(gq,go),fJ(gq,gn),gh,gj));for(var gp=0;gp<gq.linked.length;++gp){if(gq.linked[gp].isParent){return}}gi=fG(gm)});return new x(gm,gi)}function eP(gh){return gh.findMarks(W(gh.first,0),gh.clipPos(W(gh.lastLine())),function(gi){return gi.parent})}function dF(gm,gn){for(var gk=0;gk<gn.length;gk++){var gi=gn[gk],go=gi.find();var gh=gm.clipPos(go.from),gl=gm.clipPos(go.to);if(cf(gh,gl)){var gj=eF(gm,gh,gl,gi.primary,gi.primary.type);gi.markers.push(gj);gj.parent=gi}}}function eo(gk){for(var gj=0;gj<gk.length;gj++){var gh=gk[gj],gm=[gh.primary.doc];d7(gh.primary.doc,function(gn){gm.push(gn)});for(var gi=0;gi<gh.markers.length;gi++){var gl=gh.markers[gi];if(dh(gm,gl.doc)==-1){gl.parent=null;gh.markers.splice(gi--,1)}}}}function ei(gh,gj,gi){this.marker=gh;this.from=gj;this.to=gi}function e9(gj,gh){if(gj){for(var gi=0;gi<gj.length;++gi){var gk=gj[gi];if(gk.marker==gh){return gk}}}}function eH(gi,gj){for(var gk,gh=0;gh<gi.length;++gh){if(gi[gh]!=gj){(gk||(gk=[])).push(gi[gh])}}return gk}function cd(gh,gi){gh.markedSpans=gh.markedSpans?gh.markedSpans.concat([gi]):[gi];gi.marker.attachLine(gh)}function aQ(gi,gj,gn){if(gi){for(var gl=0,go;gl<gi.length;++gl){var gp=gi[gl],gm=gp.marker;var gh=gp.from==null||(gm.inclusiveLeft?gp.from<=gj:gp.from<gj);if(gh||gp.from==gj&&gm.type=="bookmark"&&(!gn||!gp.marker.insertLeft)){var gk=gp.to==null||(gm.inclusiveRight?gp.to>=gj:gp.to>gj);(go||(go=[])).push(new ei(gm,gp.from,gk?null:gp.to))}}}return go}function aB(gi,gk,gn){if(gi){for(var gl=0,go;gl<gi.length;++gl){var gp=gi[gl],gm=gp.marker;var gj=gp.to==null||(gm.inclusiveRight?gp.to>=gk:gp.to>gk);if(gj||gp.from==gk&&gm.type=="bookmark"&&(!gn||gp.marker.insertLeft)){var gh=gp.from==null||(gm.inclusiveLeft?gp.from<=gk:gp.from<gk);(go||(go=[])).push(new ei(gm,gh?null:gp.from-gk,gp.to==null?null:gp.to-gk))}}}return go}function ek(gt,gq){if(gq.full){return null}var gp=b9(gt,gq.from.line)&&ff(gt,gq.from.line).markedSpans;var gw=b9(gt,gq.to.line)&&ff(gt,gq.to.line).markedSpans;if(!gp&&!gw){return null}var gi=gq.from.ch,gl=gq.to.ch,go=cf(gq.from,gq.to)==0;var gn=aQ(gp,gi,go);var gv=aB(gw,gl,go);var gu=gq.text.length==1,gj=fG(gq.text).length+(gu?gi:0);if(gn){for(var gk=0;gk<gn.length;++gk){var gs=gn[gk];if(gs.to==null){var gx=e9(gv,gs.marker);if(!gx){gs.to=gi}else{if(gu){gs.to=gx.to==null?null:gx.to+gj}}}}}if(gv){for(var gk=0;gk<gv.length;++gk){var gs=gv[gk];if(gs.to!=null){gs.to+=gj}if(gs.from==null){var gx=e9(gn,gs.marker);if(!gx){gs.from=gj;if(gu){(gn||(gn=[])).push(gs)}}}else{gs.from+=gj;if(gu){(gn||(gn=[])).push(gs)}}}}if(gn){gn=q(gn)}if(gv&&gv!=gn){gv=q(gv)}var gm=[gn];if(!gu){var gr=gq.text.length-2,gh;if(gr>0&&gn){for(var gk=0;gk<gn.length;++gk){if(gn[gk].to==null){(gh||(gh=[])).push(new ei(gn[gk].marker,null,null))}}}for(var gk=0;gk<gr;++gk){gm.push(gh)}gm.push(gv)}return gm}function q(gi){for(var gh=0;gh<gi.length;++gh){var gj=gi[gh];if(gj.from!=null&&gj.from==gj.to&&gj.marker.clearWhenEmpty!==false){gi.splice(gh--,1)}}if(!gi.length){return null}return gi}function d9(gp,gn){var gh=b4(gp,gn);var gq=ek(gp,gn);if(!gh){return gq}if(!gq){return gh}for(var gk=0;gk<gh.length;++gk){var gl=gh[gk],gm=gq[gk];if(gl&&gm){spans:for(var gj=0;gj<gm.length;++gj){var go=gm[gj];for(var gi=0;gi<gl.length;++gi){if(gl[gi].marker==go.marker){continue spans}}gl.push(go)}}else{if(gm){gh[gk]=gm}}}return gh}function cH(gt,gr,gs){var gl=null;gt.iter(gr.line,gs.line+1,function(gu){if(gu.markedSpans){for(var gv=0;gv<gu.markedSpans.length;++gv){var gw=gu.markedSpans[gv].marker;if(gw.readOnly&&(!gl||dh(gl,gw)==-1)){(gl||(gl=[])).push(gw)}}}});if(!gl){return null}var gm=[{from:gr,to:gs}];for(var gn=0;gn<gl.length;++gn){var go=gl[gn],gj=go.find(0);for(var gk=0;gk<gm.length;++gk){var gi=gm[gk];if(cf(gi.to,gj.from)<0||cf(gi.from,gj.to)>0){continue}var gq=[gk,1],gh=cf(gi.from,gj.from),gp=cf(gi.to,gj.to);if(gh<0||!go.inclusiveLeft&&!gh){gq.push({from:gi.from,to:gj.from})}if(gp>0||!go.inclusiveRight&&!gp){gq.push({from:gj.to,to:gi.to})}gm.splice.apply(gm,gq);gk+=gq.length-1}}return gm}function f8(gh){var gj=gh.markedSpans;if(!gj){return}for(var gi=0;gi<gj.length;++gi){gj[gi].marker.detachLine(gh)}gh.markedSpans=null}function c3(gh,gj){if(!gj){return}for(var gi=0;gi<gj.length;++gi){gj[gi].marker.attachLine(gh)}gh.markedSpans=gj}function v(gh){return gh.inclusiveLeft?-1:0}function bW(gh){return gh.inclusiveRight?1:0}function dQ(gk,gi){var gm=gk.lines.length-gi.lines.length;if(gm!=0){return gm}var gj=gk.find(),gn=gi.find();var gh=cf(gj.from,gn.from)||v(gk)-v(gi);if(gh){return -gh}var gl=cf(gj.to,gn.to)||bW(gk)-bW(gi);if(gl){return gl}return gi.id-gk.id}function a7(gi,gm){var gh=a8&&gi.markedSpans,gl;if(gh){for(var gk,gj=0;gj<gh.length;++gj){gk=gh[gj];if(gk.marker.collapsed&&(gm?gk.from:gk.to)==null&&(!gl||dQ(gl,gk.marker)<0)){gl=gk.marker}}}return gl}function eO(gh){return a7(gh,true)}function ew(gh){return a7(gh,false)}function z(gp,gj,gn,go,gl){var gs=ff(gp,gj);var gh=a8&&gs.markedSpans;if(gh){for(var gk=0;gk<gh.length;++gk){var gi=gh[gk];if(!gi.marker.collapsed){continue}var gr=gi.marker.find(0);var gq=cf(gr.from,gn)||v(gi.marker)-v(gl);var gm=cf(gr.to,go)||bW(gi.marker)-bW(gl);if(gq>=0&&gm<=0||gq<=0&&gm>=0){continue}if(gq<=0&&(cf(gr.to,gn)>0||(gi.marker.inclusiveRight&&gl.inclusiveLeft))||gq>=0&&(cf(gr.from,go)<0||(gi.marker.inclusiveLeft&&gl.inclusiveRight))){return true}}}}function y(gi){var gh;while(gh=eO(gi)){gi=gh.find(-1,true).line}return gi}function h(gj){var gh,gi;while(gh=ew(gj)){gj=gh.find(1,true).line;(gi||(gi=[])).push(gj)}return gi}function aW(gk,gi){var gh=ff(gk,gi),gj=y(gh);if(gh==gj){return gi}return bN(gj)}function d2(gk,gj){if(gj>gk.lastLine()){return gj}var gi=ff(gk,gj),gh;if(!fw(gk,gi)){return gj}while(gh=ew(gi)){gi=gh.find(1,true).line}return bN(gi)+1}function fw(gl,gi){var gh=a8&&gi.markedSpans;if(gh){for(var gk,gj=0;gj<gh.length;++gj){gk=gh[gj];if(!gk.marker.collapsed){continue}if(gk.from==null){return true}if(gk.marker.widgetNode){continue}if(gk.from==0&&gk.marker.inclusiveLeft&&T(gl,gi,gk)){return true}}}}function T(gm,gi,gk){if(gk.to==null){var gh=gk.marker.find(1,true);return T(gm,gh.line,e9(gh.line.markedSpans,gk.marker))}if(gk.marker.inclusiveRight&&gk.to==gi.text.length){return true}for(var gl,gj=0;gj<gi.markedSpans.length;++gj){gl=gi.markedSpans[gj];if(gl.marker.collapsed&&!gl.marker.widgetNode&&gl.from==gk.to&&(gl.to==null||gl.to!=gk.from)&&(gl.marker.inclusiveLeft||gk.marker.inclusiveRight)&&T(gm,gi,gl)){return true}}}var dB=H.LineWidget=function(gk,gj,gh){if(gh){for(var gi in gh){if(gh.hasOwnProperty(gi)){this[gi]=gh[gi]}}}this.doc=gk;this.node=gj};by(dB);function dZ(gh,gi,gj){if(bM(gi)<((gh.curOp&&gh.curOp.scrollTop)||gh.doc.scrollTop)){cL(gh,null,gj)}}dB.prototype.clear=function(){var gi=this.doc.cm,gk=this.line.widgets,gj=this.line,gm=bN(gj);if(gm==null||!gk){return}for(var gl=0;gl<gk.length;++gl){if(gk[gl]==this){gk.splice(gl--,1)}}if(!gk.length){gj.widgets=null}var gh=cY(this);f5(gj,Math.max(0,gj.height-gh));if(gi){cM(gi,function(){dZ(gi,gj,-gh);R(gi,gm,"widget")})}};dB.prototype.changed=function(){var gi=this.height,gh=this.doc.cm,gj=this.line;this.height=null;var gk=cY(this)-gi;if(!gk){return}f5(gj,gj.height+gk);if(gh){cM(gh,function(){gh.curOp.forceUpdate=true;dZ(gh,gj,gk)})}};function cY(gj){if(gj.height!=null){return gj.height}var gh=gj.doc.cm;if(!gh){return 0}if(!ga(document.body,gj.node)){var gi="position: relative;";if(gj.coverGutter){gi+="margin-left: -"+gh.display.gutters.offsetWidth+"px;"}if(gj.noHScroll){gi+="width: "+gh.display.wrapper.clientWidth+"px;"}bR(gh.display.measure,f2("div",[gj.node],null,gi))}return gj.height=gj.node.offsetHeight}function bH(gm,gl,gj,gi){var gk=new dB(gm,gj,gi);var gh=gm.cm;if(gh&&gk.noHScroll){gh.display.alignWidgets=true}ez(gm,gl,"widget",function(go){var gp=go.widgets||(go.widgets=[]);if(gk.insertAt==null){gp.push(gk)}else{gp.splice(Math.min(gp.length-1,Math.max(0,gk.insertAt)),0,gk)}gk.line=go;if(gh&&!fw(gm,go)){var gn=bM(go)<gm.scrollTop;f5(go,go.height+cY(gk));if(gn){cL(gh,null,gk.height)}gh.curOp.forceUpdate=true}return true});return gk}var f6=H.Line=function(gj,gi,gh){this.text=gj;c3(this,gi);this.height=gh?gh(this):1};by(f6);f6.prototype.lineNo=function(){return bN(this)};function em(gi,gl,gj,gh){gi.text=gl;if(gi.stateAfter){gi.stateAfter=null}if(gi.styles){gi.styles=null}if(gi.order!=null){gi.order=null}f8(gi);c3(gi,gj);var gk=gh?gh(gi):1;if(gk!=gi.height){f5(gi,gk)}}function bB(gh){gh.parent=null;f8(gh)}function di(gj,gi){if(gj){for(;;){var gh=gj.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!gh){break}gj=gj.slice(0,gh.index)+gj.slice(gh.index+gh[0].length);var gk=gh[1]?"bgClass":"textClass";if(gi[gk]==null){gi[gk]=gh[2]}else{if(!(new RegExp("(?:^|s)"+gh[2]+"(?:$|s)")).test(gi[gk])){gi[gk]+=" "+gh[2]}}}}return gj}function fq(gj,gi){if(gj.blankLine){return gj.blankLine(gi)}if(!gj.innerMode){return}var gh=H.innerMode(gj,gi);if(gh.mode.blankLine){return gh.mode.blankLine(gh.state)}}function eA(gm,gl,gk,gh){for(var gi=0;gi<10;gi++){if(gh){gh[0]=H.innerMode(gm,gk).mode}var gj=gm.token(gl,gk);if(gl.pos>gl.start){return gj}}throw new Error("Mode "+gm.name+" failed to advance stream.")}function cq(gq,go,gl,gk){function gh(gt){return{start:gr.start,end:gr.pos,string:gr.current(),type:gj||null,state:gt?b3(gp.mode,gi):gi}}var gp=gq.doc,gm=gp.mode,gj;go=fJ(gp,go);var gs=ff(gp,go.line),gi=dC(gq,go.line,gl);var gr=new eT(gs.text,gq.options.tabSize),gn;if(gk){gn=[]}while((gk||gr.pos<go.ch)&&!gr.eol()){gr.start=gr.pos;gj=eA(gm,gr,gi);if(gk){gn.push(gh(true))}}return gk?gn:gh()}function w(gr,gt,gm,gi,gn,gk,gl){var gj=gm.flattenSpans;if(gj==null){gj=gr.options.flattenSpans}var gp=0,go=null;var gs=new eT(gt,gr.options.tabSize),gh;var gv=gr.options.addModeClass&&[null];if(gt==""){di(fq(gm,gi),gk)}while(!gs.eol()){if(gs.pos>gr.options.maxHighlightLength){gj=false;if(gl){dx(gr,gt,gi,gs.pos)}gs.pos=gt.length;gh=null}else{gh=di(eA(gm,gs,gi,gv),gk)}if(gv){var gu=gv[0].name;if(gu){gh="m-"+(gh?gu+" "+gh:gu)}}if(!gj||go!=gh){while(gp<gs.start){gp=Math.min(gs.start,gp+50000);gn(gp,go)}go=gh}gs.start=gs.pos}while(gp<gs.pos){var gq=Math.min(gs.pos,gp+50000);gn(gq,go);gp=gq}}function fz(go,gq,gh,gl){var gp=[go.state.modeGen],gk={};w(go,gq.text,go.doc.mode,gh,function(gr,gs){gp.push(gr,gs)},gk,gl);for(var gi=0;gi<go.state.overlays.length;++gi){var gm=go.state.overlays[gi],gn=1,gj=0;w(go,gq.text,gm.mode,true,function(gr,gt){var gv=gn;while(gj<gr){var gs=gp[gn];if(gs>gr){gp.splice(gn,1,gr,gp[gn+1],gs)}gn+=2;gj=Math.min(gr,gs)}if(!gt){return}if(gm.opaque){gp.splice(gv,gn-gv,gr,"cm-overlay "+gt);gn=gv+2}else{for(;gv<gn;gv+=2){var gu=gp[gv+1];gp[gv+1]=(gu?gu+" ":"")+"cm-overlay "+gt}}},gk)}return{styles:gp,classes:gk.bgClass||gk.textClass?gk:null}}function c6(gi,gj,gk){if(!gj.styles||gj.styles[0]!=gi.state.modeGen){var gh=fz(gi,gj,gj.stateAfter=dC(gi,bN(gj)));gj.styles=gh.styles;if(gh.classes){gj.styleClasses=gh.classes}else{if(gj.styleClasses){gj.styleClasses=null}}if(gk===gi.doc.frontier){gi.doc.frontier++}}return gj.styles}function dx(gh,gm,gj,gi){var gl=gh.doc.mode;var gk=new eT(gm,gh.options.tabSize);gk.start=gk.pos=gi||0;if(gm==""){fq(gl,gj)}while(!gk.eol()&&gk.pos<=gh.options.maxHighlightLength){eA(gl,gk,gj);gk.start=gk.pos}}var dW={},b1={};function eW(gj,gi){if(!gj||/^\s*$/.test(gj)){return null}var gh=gi.addModeClass?b1:dW;return gh[gj]||(gh[gj]=gj.replace(/\S+/g,"cm-$&"))}function eR(gi,gm){var gn=f2("span",null,null,c0?"padding-right: .1px":null);var gk={pre:f2("pre",[gn]),content:gn,col:0,pos:0,cm:gi,splitSpaces:(dK||c0)&&gi.getOption("lineWrapping")};gm.measure={};for(var gl=0;gl<=(gm.rest?gm.rest.length:0);gl++){var gj=gl?gm.rest[gl-1]:gm.line,gh;gk.pos=0;gk.addToken=t;if(bO(gi.display.measure)&&(gh=a(gj))){gk.addToken=U(gk.addToken,gh)}gk.map=[];var go=gm!=gi.display.externalMeasured&&bN(gj);bo(gj,gk,c6(gi,gj,go));if(gj.styleClasses){if(gj.styleClasses.bgClass){gk.bgClass=fS(gj.styleClasses.bgClass,gk.bgClass||"")}if(gj.styleClasses.textClass){gk.textClass=fS(gj.styleClasses.textClass,gk.textClass||"")}}if(gk.map.length==0){gk.map.push(0,0,gk.content.appendChild(bn(gi.display.measure)))}if(gl==0){gm.measure.map=gk.map;gm.measure.cache={}}else{(gm.measure.maps||(gm.measure.maps=[])).push(gk.map);(gm.measure.caches||(gm.measure.caches=[])).push({})}}if(c0&&/\bcm-tab\b/.test(gk.content.lastChild.className)){gk.content.className="cm-tab-wrap-hack"}aE(gi,"renderLine",gi,gm.line,gk.pre);if(gk.pre.className){gk.textClass=fS(gk.pre.className,gk.textClass||"")}return gk}function fc(gi){var gh=f2("span","\u2022","cm-invalidchar");gh.title="\\u"+gi.charCodeAt(0).toString(16);gh.setAttribute("aria-label",gh.title);return gh}function t(gs,gn,gx,gu,gq,gz,gm){if(!gn){return}var gw=gs.splitSpaces?gn.replace(/ {3,}/g,cF):gn;var gh=gs.cm.state.specialChars,gi=false;if(!gh.test(gn)){gs.col+=gn.length;var gv=document.createTextNode(gw);gs.map.push(gs.pos,gs.pos+gn.length,gv);if(dK&&k<9){gi=true}gs.pos+=gn.length}else{var gv=document.createDocumentFragment(),gk=0;while(true){gh.lastIndex=gk;var gt=gh.exec(gn);var gy=gt?gt.index-gk:gn.length-gk;if(gy){var gp=document.createTextNode(gw.slice(gk,gk+gy));if(dK&&k<9){gv.appendChild(f2("span",[gp]))}else{gv.appendChild(gp)}gs.map.push(gs.pos,gs.pos+gy,gp);gs.col+=gy;gs.pos+=gy}if(!gt){break}gk+=gy+1;if(gt[0]=="\t"){var gr=gs.cm.options.tabSize,go=gr-gs.col%gr;var gp=gv.appendChild(f2("span",cp(go),"cm-tab"));gp.setAttribute("role","presentation");gp.setAttribute("cm-text","\t");gs.col+=go}else{var gp=gs.cm.options.specialCharPlaceholder(gt[0]);gp.setAttribute("cm-text",gt[0]);if(dK&&k<9){gv.appendChild(f2("span",[gp]))}else{gv.appendChild(gp)}gs.col+=1}gs.map.push(gs.pos,gs.pos+1,gp);gs.pos++}}if(gx||gu||gq||gi||gm){var gj=gx||"";if(gu){gj+=gu}if(gq){gj+=gq}var gl=f2("span",[gv],gj,gm);if(gz){gl.title=gz}return gs.content.appendChild(gl)}gs.content.appendChild(gv)}function cF(gh){var gi=" ";for(var gj=0;gj<gh.length-2;++gj){gi+=gj%2?" ":"\u00a0"}gi+=" ";return gi}function U(gi,gh){return function(gq,gs,gj,gn,gt,gr,gp){gj=gj?gj+" cm-force-border":"cm-force-border";var gk=gq.pos,gm=gk+gs.length;for(;;){for(var go=0;go<gh.length;go++){var gl=gh[go];if(gl.to>gk&&gl.from<=gk){break}}if(gl.to>=gm){return gi(gq,gs,gj,gn,gt,gr,gp)}gi(gq,gs.slice(0,gl.to-gk),gj,gn,null,gr,gp);gn=null;gs=gs.slice(gl.to-gk);gk=gl.to}}}function ac(gi,gk,gh,gj){var gl=!gj&&gh.widgetNode;if(gl){gi.map.push(gi.pos,gi.pos+gk,gl)}if(!gj&&gi.cm.display.input.needsContentAttribute){if(!gl){gl=gi.content.appendChild(document.createElement("span"))}gl.setAttribute("cm-marker",gh.id)}if(gl){gi.cm.display.input.setUneditable(gl);gi.content.appendChild(gl)}gi.pos+=gk}function bo(gq,gx,gp){var gm=gq.markedSpans,go=gq.text,gv=0;if(!gm){for(var gA=1;gA<gp.length;gA+=2){gx.addToken(gx,go.slice(gv,gv=gp[gA]),eW(gp[gA+1],gx.cm.options))}return}var gB=go.length,gl=0,gA=1,gt="",gC,gr;var gE=0,gh,gD,gu,gF,gj;for(;;){if(gE==gl){gh=gD=gu=gF=gr="";gj=null;gE=Infinity;var gn=[];for(var gy=0;gy<gm.length;++gy){var gz=gm[gy],gw=gz.marker;if(gw.type=="bookmark"&&gz.from==gl&&gw.widgetNode){gn.push(gw)}else{if(gz.from<=gl&&(gz.to==null||gz.to>gl||gw.collapsed&&gz.to==gl&&gz.from==gl)){if(gz.to!=null&&gz.to!=gl&&gE>gz.to){gE=gz.to;gD=""}if(gw.className){gh+=" "+gw.className}if(gw.css){gr=gw.css}if(gw.startStyle&&gz.from==gl){gu+=" "+gw.startStyle}if(gw.endStyle&&gz.to==gE){gD+=" "+gw.endStyle}if(gw.title&&!gF){gF=gw.title}if(gw.collapsed&&(!gj||dQ(gj.marker,gw)<0)){gj=gz}}else{if(gz.from>gl&&gE>gz.from){gE=gz.from}}}}if(gj&&(gj.from||0)==gl){ac(gx,(gj.to==null?gB+1:gj.to)-gl,gj.marker,gj.from==null);if(gj.to==null){return}if(gj.to==gl){gj=false}}if(!gj&&gn.length){for(var gy=0;gy<gn.length;++gy){ac(gx,0,gn[gy])}}}if(gl>=gB){break}var gs=Math.min(gB,gE);while(true){if(gt){var gi=gl+gt.length;if(!gj){var gk=gi>gs?gt.slice(0,gs-gl):gt;gx.addToken(gx,gk,gC?gC+gh:gh,gu,gl+gk.length==gE?gD:"",gF,gr)}if(gi>=gs){gt=gt.slice(gs-gl);gl=gs;break}gl=gi;gu=""}gt=go.slice(gv,gv=gp[gA++]);gC=eW(gp[gA++],gx.cm.options)}}}function dS(gh,gi){return gi.from.ch==0&&gi.to.ch==0&&fG(gi.text)==""&&(!gh.cm||gh.cm.options.wholeLineUpdateBefore)}function fy(gu,gp,gi,gl){function gv(gx){return gi?gi[gx]:null}function gj(gx,gz,gy){em(gx,gz,gy,gl);ae(gx,"change",gx,gp)}function gh(gA,gy){for(var gz=gA,gx=[];gz<gy;++gz){gx.push(new f6(gw[gz],gv(gz),gl))}return gx}var gt=gp.from,gs=gp.to,gw=gp.text;var gq=ff(gu,gt.line),gr=ff(gu,gs.line);var go=fG(gw),gk=gv(gw.length-1),gn=gs.line-gt.line;if(gp.full){gu.insert(0,gh(0,gw.length));gu.remove(gw.length,gu.size-gw.length)}else{if(dS(gu,gp)){var gm=gh(0,gw.length-1);gj(gr,gr.text,gk);if(gn){gu.remove(gt.line,gn)}if(gm.length){gu.insert(gt.line,gm)}}else{if(gq==gr){if(gw.length==1){gj(gq,gq.text.slice(0,gt.ch)+go+gq.text.slice(gs.ch),gk)}else{var gm=gh(1,gw.length-1);gm.push(new f6(go+gq.text.slice(gs.ch),gk,gl));gj(gq,gq.text.slice(0,gt.ch)+gw[0],gv(0));gu.insert(gt.line+1,gm)}}else{if(gw.length==1){gj(gq,gq.text.slice(0,gt.ch)+gw[0]+gr.text.slice(gs.ch),gv(0));gu.remove(gt.line+1,gn)}else{gj(gq,gq.text.slice(0,gt.ch)+gw[0],gv(0));gj(gr,go+gr.text.slice(gs.ch),gk);var gm=gh(1,gw.length-1);if(gn>1){gu.remove(gt.line+1,gn-1)}gu.insert(gt.line+1,gm)}}}}ae(gu,"change",gu,gp)}function eZ(gi){this.lines=gi;this.parent=null;for(var gj=0,gh=0;gj<gi.length;++gj){gi[gj].parent=this;gh+=gi[gj].height}this.height=gh}eZ.prototype={chunkSize:function(){return this.lines.length},removeInner:function(gh,gl){for(var gj=gh,gk=gh+gl;gj<gk;++gj){var gi=this.lines[gj];this.height-=gi.height;bB(gi);ae(gi,"delete")}this.lines.splice(gh,gl)},collapse:function(gh){gh.push.apply(gh,this.lines)},insertInner:function(gi,gj,gh){this.height+=gh;this.lines=this.lines.slice(0,gi).concat(gj).concat(this.lines.slice(gi));for(var gk=0;gk<gj.length;++gk){gj[gk].parent=this}},iterN:function(gh,gk,gj){for(var gi=gh+gk;gh<gi;++gh){if(gj(this.lines[gh])){return true}}}};function fx(gk){this.children=gk;var gj=0,gh=0;for(var gi=0;gi<gk.length;++gi){var gl=gk[gi];gj+=gl.chunkSize();gh+=gl.height;gl.parent=this}this.size=gj;this.height=gh;this.parent=null}fx.prototype={chunkSize:function(){return this.size},removeInner:function(gh,go){this.size-=go;for(var gj=0;gj<this.children.length;++gj){var gn=this.children[gj],gl=gn.chunkSize();if(gh<gl){var gk=Math.min(go,gl-gh),gm=gn.height;gn.removeInner(gh,gk);this.height-=gm-gn.height;if(gl==gk){this.children.splice(gj--,1);gn.parent=null}if((go-=gk)==0){break}gh=0}else{gh-=gl}}if(this.size-go<25&&(this.children.length>1||!(this.children[0] instanceof eZ))){var gi=[];this.collapse(gi);this.children=[new eZ(gi)];this.children[0].parent=this}},collapse:function(gh){for(var gi=0;gi<this.children.length;++gi){this.children[gi].collapse(gh)}},insertInner:function(gi,gj,gh){this.size+=gj.length;this.height+=gh;for(var gm=0;gm<this.children.length;++gm){var go=this.children[gm],gn=go.chunkSize();if(gi<=gn){go.insertInner(gi,gj,gh);if(go.lines&&go.lines.length>50){while(go.lines.length>50){var gl=go.lines.splice(go.lines.length-25,25);var gk=new eZ(gl);go.height-=gk.height;this.children.splice(gm+1,0,gk);gk.parent=this}this.maybeSpill()}break}gi-=gn}},maybeSpill:function(){if(this.children.length<=10){return}var gk=this;do{var gi=gk.children.splice(gk.children.length-5,5);var gj=new fx(gi);if(!gk.parent){var gl=new fx(gk.children);gl.parent=gk;gk.children=[gl,gj];gk=gl}else{gk.size-=gj.size;gk.height-=gj.height;var gh=dh(gk.parent.children,gk);gk.parent.children.splice(gh+1,0,gj)}gj.parent=gk.parent}while(gk.children.length>10);gk.parent.maybeSpill()},iterN:function(gh,gn,gm){for(var gi=0;gi<this.children.length;++gi){var gl=this.children[gi],gk=gl.chunkSize();if(gh<gk){var gj=Math.min(gn,gk-gh);if(gl.iterN(gh,gj,gm)){return true}if((gn-=gj)==0){break}gh=0}else{gh-=gk}}}};var cr=0;var at=H.Doc=function(gj,gi,gh){if(!(this instanceof at)){return new at(gj,gi,gh)}if(gh==null){gh=0}fx.call(this,[new eZ([new f6("",null)])]);this.first=gh;this.scrollTop=this.scrollLeft=0;this.cantEdit=false;this.cleanGeneration=1;this.frontier=gh;var gk=W(gh,0);this.sel=eS(gk);this.history=new fT(null);this.id=++cr;this.modeOption=gi;if(typeof gj=="string"){gj=a1(gj)}fy(this,{from:gk,to:gk,text:gj});bU(this,eS(gk),Z)};at.prototype=ck(fx.prototype,{constructor:at,iter:function(gj,gi,gh){if(gh){this.iterN(gj-this.first,gi-gj,gh)}else{this.iterN(this.first,this.first+this.size,gj)}},insert:function(gi,gj){var gh=0;for(var gk=0;gk<gj.length;++gk){gh+=gj[gk].height}this.insertInner(gi-this.first,gj,gh)},remove:function(gh,gi){this.removeInner(gh-this.first,gi)},getValue:function(gi){var gh=a3(this,this.first,this.first+this.size);if(gi===false){return gh}return gh.join(gi||"\n")},setValue:cD(function(gi){var gj=W(this.first,0),gh=this.first+this.size-1;bg(this,{from:gj,to:W(gh,ff(this,gh).text.length),text:a1(gi),origin:"setValue",full:true},true);bU(this,eS(gj))}),replaceRange:function(gi,gk,gj,gh){gk=fJ(this,gk);gj=gj?fJ(this,gj):gk;a2(this,gi,gk,gj,gh)},getRange:function(gk,gj,gi){var gh=f4(this,fJ(this,gk),fJ(this,gj));if(gi===false){return gh}return gh.join(gi||"\n")},getLine:function(gi){var gh=this.getLineHandle(gi);return gh&&gh.text},getLineHandle:function(gh){if(b9(this,gh)){return ff(this,gh)}},getLineNumber:function(gh){return bN(gh)},getLineHandleVisualStart:function(gh){if(typeof gh=="number"){gh=ff(this,gh)}return y(gh)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(gh){return fJ(this,gh)},getCursor:function(gj){var gh=this.sel.primary(),gi;if(gj==null||gj=="head"){gi=gh.head}else{if(gj=="anchor"){gi=gh.anchor}else{if(gj=="end"||gj=="to"||gj===false){gi=gh.to()}else{gi=gh.from()}}}return gi},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:cD(function(gh,gj,gi){F(this,fJ(this,typeof gh=="number"?W(gh,gj||0):gh),null,gi)}),setSelection:cD(function(gi,gj,gh){F(this,fJ(this,gi),fJ(this,gj||gi),gh)}),extendSelection:cD(function(gj,gh,gi){fW(this,fJ(this,gj),gh&&fJ(this,gh),gi)}),extendSelections:cD(function(gi,gh){aw(this,d0(this,gi,gh))}),extendSelectionsBy:cD(function(gi,gh){aw(this,bS(this.sel.ranges,gi),gh)}),setSelections:cD(function(gh,gl,gj){if(!gh.length){return}for(var gk=0,gi=[];gk<gh.length;gk++){gi[gk]=new dY(fJ(this,gh[gk].anchor),fJ(this,gh[gk].head))}if(gl==null){gl=Math.min(gh.length-1,this.sel.primIndex)}bU(this,cw(gi,gl),gj)}),addSelection:cD(function(gj,gk,gi){var gh=this.sel.ranges.slice(0);gh.push(new dY(fJ(this,gj),fJ(this,gk||gj)));bU(this,cw(gh,gh.length-1),gi)}),getSelection:function(gl){var gi=this.sel.ranges,gh;for(var gj=0;gj<gi.length;gj++){var gk=f4(this,gi[gj].from(),gi[gj].to());gh=gh?gh.concat(gk):gk}if(gl===false){return gh}else{return gh.join(gl||"\n")}},getSelections:function(gl){var gk=[],gh=this.sel.ranges;for(var gi=0;gi<gh.length;gi++){var gj=f4(this,gh[gi].from(),gh[gi].to());if(gl!==false){gj=gj.join(gl||"\n")}gk[gi]=gj}return gk},replaceSelection:function(gj,gl,gh){var gk=[];for(var gi=0;gi<this.sel.ranges.length;gi++){gk[gi]=gj}this.replaceSelections(gk,gl,gh||"+input")},replaceSelections:cD(function(gm,go,gj){var gl=[],gn=this.sel;for(var gk=0;gk<gn.ranges.length;gk++){var gi=gn.ranges[gk];gl[gk]={from:gi.from(),to:gi.to(),text:a1(gm[gk]),origin:gj}}var gh=go&&go!="end"&&af(this,gl,go);for(var gk=gl.length-1;gk>=0;gk--){bg(this,gl[gk])}if(gh){e7(this,gh)}else{if(this.cm){fF(this.cm)}}}),undo:cD(function(){b8(this,"undo")}),redo:cD(function(){b8(this,"redo")}),undoSelection:cD(function(){b8(this,"undo",true)}),redoSelection:cD(function(){b8(this,"redo",true)}),setExtending:function(gh){this.extend=gh},getExtending:function(){return this.extend},historySize:function(){var gk=this.history,gh=0,gj=0;for(var gi=0;gi<gk.done.length;gi++){if(!gk.done[gi].ranges){++gh}}for(var gi=0;gi<gk.undone.length;gi++){if(!gk.undone[gi].ranges){++gj}}return{undo:gh,redo:gj}},clearHistory:function(){this.history=new fT(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(true)},changeGeneration:function(gh){if(gh){this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null}return this.history.generation},isClean:function(gh){return this.history.generation==(gh||this.cleanGeneration)},getHistory:function(){return{done:bP(this.history.done),undone:bP(this.history.undone)}},setHistory:function(gi){var gh=this.history=new fT(this.history.maxGeneration);gh.done=bP(gi.done.slice(0),null,true);gh.undone=bP(gi.undone.slice(0),null,true)},addLineClass:cD(function(gj,gi,gh){return ez(this,gj,gi=="gutter"?"gutter":"class",function(gk){var gl=gi=="text"?"textClass":gi=="background"?"bgClass":gi=="gutter"?"gutterClass":"wrapClass";if(!gk[gl]){gk[gl]=gh}else{if(S(gh).test(gk[gl])){return false}else{gk[gl]+=" "+gh}}return true})}),removeLineClass:cD(function(gj,gi,gh){return ez(this,gj,gi=="gutter"?"gutter":"class",function(gl){var go=gi=="text"?"textClass":gi=="background"?"bgClass":gi=="gutter"?"gutterClass":"wrapClass";var gn=gl[go];if(!gn){return false}else{if(gh==null){gl[go]=null}else{var gm=gn.match(S(gh));if(!gm){return false}var gk=gm.index+gm[0].length;gl[go]=gn.slice(0,gm.index)+(!gm.index||gk==gn.length?"":" ")+gn.slice(gk)||null}}return true})}),addLineWidget:cD(function(gj,gi,gh){return bH(this,gj,gi,gh)}),removeLineWidget:function(gh){gh.clear()},markText:function(gj,gi,gh){return eF(this,fJ(this,gj),fJ(this,gi),gh,"range")},setBookmark:function(gj,gh){var gi={replacedWith:gh&&(gh.nodeType==null?gh.widget:gh),insertLeft:gh&&gh.insertLeft,clearWhenEmpty:false,shared:gh&&gh.shared,handleMouseEvents:gh&&gh.handleMouseEvents};gj=fJ(this,gj);return eF(this,gj,gj,gi,"bookmark")},findMarksAt:function(gl){gl=fJ(this,gl);var gk=[],gi=ff(this,gl.line).markedSpans;if(gi){for(var gh=0;gh<gi.length;++gh){var gj=gi[gh];if((gj.from==null||gj.from<=gl.ch)&&(gj.to==null||gj.to>=gl.ch)){gk.push(gj.marker.parent||gj.marker)}}}return gk},findMarks:function(gl,gk,gh){gl=fJ(this,gl);gk=fJ(this,gk);var gi=[],gj=gl.line;this.iter(gl.line,gk.line+1,function(gm){var go=gm.markedSpans;if(go){for(var gn=0;gn<go.length;gn++){var gp=go[gn];if(!(gj==gl.line&&gl.ch>gp.to||gp.from==null&&gj!=gl.line||gj==gk.line&&gp.from>gk.ch)&&(!gh||gh(gp.marker))){gi.push(gp.marker.parent||gp.marker)}}}++gj});return gi},getAllMarks:function(){var gh=[];this.iter(function(gj){var gi=gj.markedSpans;if(gi){for(var gk=0;gk<gi.length;++gk){if(gi[gk].from!=null){gh.push(gi[gk].marker)}}}});return gh},posFromIndex:function(gi){var gh,gj=this.first;this.iter(function(gk){var gl=gk.text.length+1;if(gl>gi){gh=gi;return true}gi-=gl;++gj});return fJ(this,W(gj,gh))},indexFromPos:function(gi){gi=fJ(this,gi);var gh=gi.ch;if(gi.line<this.first||gi.ch<0){return 0}this.iter(this.first,gi.line,function(gj){gh+=gj.text.length+1});return gh},copy:function(gh){var gi=new at(a3(this,this.first,this.first+this.size),this.modeOption,this.first);gi.scrollTop=this.scrollTop;gi.scrollLeft=this.scrollLeft;gi.sel=this.sel;gi.extend=false;if(gh){gi.history.undoDepth=this.history.undoDepth;gi.setHistory(this.getHistory())}return gi},linkedDoc:function(gh){if(!gh){gh={}}var gk=this.first,gj=this.first+this.size;if(gh.from!=null&&gh.from>gk){gk=gh.from}if(gh.to!=null&&gh.to<gj){gj=gh.to}var gi=new at(a3(this,gk,gj),gh.mode||this.modeOption,gk);if(gh.sharedHist){gi.history=this.history}(this.linked||(this.linked=[])).push({doc:gi,sharedHist:gh.sharedHist});gi.linked=[{doc:this,isParent:true,sharedHist:gh.sharedHist}];dF(gi,eP(this));return gi},unlinkDoc:function(gi){if(gi instanceof H){gi=gi.doc}if(this.linked){for(var gj=0;gj<this.linked.length;++gj){var gk=this.linked[gj];if(gk.doc!=gi){continue}this.linked.splice(gj,1);gi.unlinkDoc(this);eo(eP(this));break}}if(gi.history==this.history){var gh=[gi.id];d7(gi,function(gl){gh.push(gl.id)},true);gi.history=new fT(null);gi.history.done=bP(this.history.done,gh);gi.history.undone=bP(this.history.undone,gh)}},iterLinkedDocs:function(gh){d7(this,gh)},getMode:function(){return this.mode},getEditor:function(){return this.cm}});at.prototype.eachLine=at.prototype.iter;var d="iter insert remove copy getEditor".split(" ");for(var bK in at.prototype){if(at.prototype.hasOwnProperty(bK)&&dh(d,bK)<0){H.prototype[bK]=(function(gh){return function(){return gh.apply(this.doc,arguments)}})(at.prototype[bK])}}by(at);function d7(gk,gj,gi){function gh(gq,go,gm){if(gq.linked){for(var gn=0;gn<gq.linked.length;++gn){var gl=gq.linked[gn];if(gl.doc==go){continue}var gp=gm&&gl.sharedHist;if(gi&&!gp){continue}gj(gl.doc,gp);gh(gl.doc,gq,gp)}}}gh(gk,null,true)}function eb(gh,gi){if(gi.cm){throw new Error("This document is already in use.")}gh.doc=gi;gi.cm=gh;X(gh);br(gh);if(!gh.options.lineWrapping){g(gh)}gh.options.mode=gi.modeOption;ah(gh)}function ff(gk,gm){gm-=gk.first;if(gm<0||gm>=gk.size){throw new Error("There is no line "+(gm+gk.first)+" in the document.")}for(var gh=gk;!gh.lines;){for(var gi=0;;++gi){var gl=gh.children[gi],gj=gl.chunkSize();if(gm<gj){gh=gl;break}gm-=gj}}return gh.lines[gm]}function f4(gj,gl,gh){var gi=[],gk=gl.line;gj.iter(gl.line,gh.line+1,function(gm){var gn=gm.text;if(gk==gh.line){gn=gn.slice(0,gh.ch)}if(gk==gl.line){gn=gn.slice(gl.ch)}gi.push(gn);++gk});return gi}function a3(gi,gk,gj){var gh=[];gi.iter(gk,gj,function(gl){gh.push(gl.text)});return gh}function f5(gi,gh){var gj=gh-gi.height;if(gj){for(var gk=gi;gk;gk=gk.parent){gk.height+=gj}}}function bN(gh){if(gh.parent==null){return null}var gl=gh.parent,gk=dh(gl.lines,gh);for(var gi=gl.parent;gi;gl=gi,gi=gi.parent){for(var gj=0;;++gj){if(gi.children[gj]==gl){break}gk+=gi.children[gj].chunkSize()}}return gk+gl.first}function bG(gj,gm){var go=gj.first;outer:do{for(var gk=0;gk<gj.children.length;++gk){var gn=gj.children[gk],gl=gn.height;if(gm<gl){gj=gn;continue outer}gm-=gl;go+=gn.chunkSize()}return go}while(!gj.lines);for(var gk=0;gk<gj.lines.length;++gk){var gi=gj.lines[gk],gh=gi.height;if(gm<gh){break}gm-=gh}return go+gk}function bM(gj){gj=y(gj);var gl=0,gi=gj.parent;for(var gk=0;gk<gi.lines.length;++gk){var gh=gi.lines[gk];if(gh==gj){break}else{gl+=gh.height}}for(var gm=gi.parent;gm;gi=gm,gm=gi.parent){for(var gk=0;gk<gm.children.length;++gk){var gn=gm.children[gk];if(gn==gi){break}else{gl+=gn.height}}}return gl}function a(gi){var gh=gi.order;if(gh==null){gh=gi.order=bh(gi.text)}return gh}function fT(gh){this.done=[];this.undone=[];this.undoDepth=Infinity;this.lastModTime=this.lastSelTime=0;this.lastOp=this.lastSelOp=null;this.lastOrigin=this.lastSelOrigin=null;this.generation=this.maxGeneration=gh||1}function du(gh,gj){var gi={from:ci(gj.from),to:cX(gj),text:f4(gh,gj.from,gj.to)};bY(gh,gi,gj.from.line,gj.to.line+1);d7(gh,function(gk){bY(gk,gi,gj.from.line,gj.to.line+1)},true);return gi}function fB(gi){while(gi.length){var gh=fG(gi);if(gh.ranges){gi.pop()}else{break}}}function eM(gi,gh){if(gh){fB(gi.done);return fG(gi.done)}else{if(gi.done.length&&!fG(gi.done).ranges){return fG(gi.done)}else{if(gi.done.length>1&&!gi.done[gi.done.length-2].ranges){gi.done.pop();return fG(gi.done)}}}}function fM(gn,gl,gh,gk){var gj=gn.history;gj.undone.length=0;var gi=+new Date,go;if((gj.lastOp==gk||gj.lastOrigin==gl.origin&&gl.origin&&((gl.origin.charAt(0)=="+"&&gn.cm&&gj.lastModTime>gi-gn.cm.options.historyEventDelay)||gl.origin.charAt(0)=="*"))&&(go=eM(gj,gj.lastOp==gk))){var gp=fG(go.changes);if(cf(gl.from,gl.to)==0&&cf(gl.from,gp.to)==0){gp.to=cX(gl)}else{go.changes.push(du(gn,gl))}}else{var gm=fG(gj.done);if(!gm||!gm.ranges){cN(gn.sel,gj.done)}go={changes:[du(gn,gl)],generation:gj.generation};gj.done.push(go);while(gj.done.length>gj.undoDepth){gj.done.shift();if(!gj.done[0].ranges){gj.done.shift()}}}gj.done.push(gh);gj.generation=++gj.maxGeneration;gj.lastModTime=gj.lastSelTime=gi;gj.lastOp=gj.lastSelOp=gk;gj.lastOrigin=gj.lastSelOrigin=gl.origin;if(!gp){aE(gn,"historyAdded")}}function bA(gl,gh,gj,gk){var gi=gh.charAt(0);return gi=="*"||gi=="+"&&gj.ranges.length==gk.ranges.length&&gj.somethingSelected()==gk.somethingSelected()&&new Date-gl.history.lastSelTime<=(gl.cm?gl.cm.options.historyEventDelay:500)}function gb(gm,gk,gh,gj){var gl=gm.history,gi=gj&&gj.origin;if(gh==gl.lastSelOp||(gi&&gl.lastSelOrigin==gi&&(gl.lastModTime==gl.lastSelTime&&gl.lastOrigin==gi||bA(gm,gi,fG(gl.done),gk)))){gl.done[gl.done.length-1]=gk}else{cN(gk,gl.done)}gl.lastSelTime=+new Date;gl.lastSelOrigin=gi;gl.lastSelOp=gh;if(gj&&gj.clearRedo!==false){fB(gl.undone)}}function cN(gi,gh){var gj=fG(gh);if(!(gj&&gj.ranges&&gj.equals(gi))){gh.push(gi)}}function bY(gi,gm,gl,gk){var gh=gm["spans_"+gi.id],gj=0;gi.iter(Math.max(gi.first,gl),Math.min(gi.first+gi.size,gk),function(gn){if(gn.markedSpans){(gh||(gh=gm["spans_"+gi.id]={}))[gj]=gn.markedSpans}++gj})}function bl(gj){if(!gj){return null}for(var gi=0,gh;gi<gj.length;++gi){if(gj[gi].marker.explicitlyCleared){if(!gh){gh=gj.slice(0,gi)}}else{if(gh){gh.push(gj[gi])}}}return !gh?gj:gh.length?gh:null}function b4(gk,gl){var gj=gl["spans_"+gk.id];if(!gj){return null}for(var gi=0,gh=[];gi<gl.text.length;++gi){gh.push(bl(gj[gi]))}return gh}function bP(gs,gk,gr){for(var gn=0,gi=[];gn<gs.length;++gn){var gj=gs[gn];if(gj.ranges){gi.push(gr?f3.prototype.deepCopy.call(gj):gj);continue}var gp=gj.changes,gq=[];gi.push({changes:gq});for(var gm=0;gm<gp.length;++gm){var go=gp[gm],gl;gq.push({from:go.from,to:go.to,text:go.text});if(gk){for(var gh in go){if(gl=gh.match(/^spans_(\d+)$/)){if(dh(gk,Number(gl[1]))>-1){fG(gq)[gh]=go[gh];delete go[gh]}}}}}}return gi}function I(gk,gj,gi,gh){if(gi<gk.line){gk.line+=gh}else{if(gj<gk.line){gk.line=gj;gk.ch=0}}}function fh(gk,gm,gn,go){for(var gj=0;gj<gk.length;++gj){var gh=gk[gj],gl=true;if(gh.ranges){if(!gh.copied){gh=gk[gj]=gh.deepCopy();gh.copied=true}for(var gi=0;gi<gh.ranges.length;gi++){I(gh.ranges[gi].anchor,gm,gn,go);I(gh.ranges[gi].head,gm,gn,go)}continue}for(var gi=0;gi<gh.changes.length;++gi){var gp=gh.changes[gi];if(gn<gp.from.line){gp.from=W(gp.from.line+go,gp.from.ch);gp.to=W(gp.to.line+go,gp.to.ch)}else{if(gm<=gp.to.line){gl=false;break}}}if(!gl){gk.splice(0,gj+1);gj=0}}}function dE(gi,gl){var gk=gl.from.line,gj=gl.to.line,gh=gl.text.length-(gj-gk)-1;fh(gi.done,gk,gj,gh);fh(gi.undone,gk,gj,gh)}var cG=H.e_preventDefault=function(gh){if(gh.preventDefault){gh.preventDefault()}else{gh.returnValue=false}};var dq=H.e_stopPropagation=function(gh){if(gh.stopPropagation){gh.stopPropagation()}else{gh.cancelBubble=true}};function bL(gh){return gh.defaultPrevented!=null?gh.defaultPrevented:gh.returnValue==false}var er=H.e_stop=function(gh){cG(gh);dq(gh)};function L(gh){return gh.target||gh.srcElement}function fN(gi){var gh=gi.which;if(gh==null){if(gi.button&1){gh=1}else{if(gi.button&2){gh=3}else{if(gi.button&4){gh=2}}}}if(b7&&gi.ctrlKey&&gh==1){gh=3}return gh}var bX=H.on=function(gk,gi,gj){if(gk.addEventListener){gk.addEventListener(gi,gj,false)}else{if(gk.attachEvent){gk.attachEvent("on"+gi,gj)}else{var gl=gk._handlers||(gk._handlers={});var gh=gl[gi]||(gl[gi]=[]);gh.push(gj)}}};var ed=H.off=function(gl,gj,gk){if(gl.removeEventListener){gl.removeEventListener(gj,gk,false)}else{if(gl.detachEvent){gl.detachEvent("on"+gj,gk)}else{var gh=gl._handlers&&gl._handlers[gj];if(!gh){return}for(var gi=0;gi<gh.length;++gi){if(gh[gi]==gk){gh.splice(gi,1);break}}}}};var aE=H.signal=function(gl,gk){var gh=gl._handlers&&gl._handlers[gk];if(!gh){return}var gi=Array.prototype.slice.call(arguments,2);for(var gj=0;gj<gh.length;++gj){gh[gj].apply(null,gi)}};var bz=null;function ae(gn,gl){var gh=gn._handlers&&gn._handlers[gl];if(!gh){return}var gj=Array.prototype.slice.call(arguments,2),gm;if(bp){gm=bp.delayedCallbacks}else{if(bz){gm=bz}else{gm=bz=[];setTimeout(aM,0)}}function gi(go){return function(){go.apply(null,gj)}}for(var gk=0;gk<gh.length;++gk){gm.push(gi(gh[gk]))}}function aM(){var gh=bz;bz=null;for(var gi=0;gi<gh.length;++gi){gh[gi]()}}function aR(gh,gj,gi){if(typeof gj=="string"){gj={type:gj,preventDefault:function(){this.defaultPrevented=true}}}aE(gh,gi||gj.type,gh,gj);return bL(gj)||gj.codemirrorIgnore}function V(gi){var gh=gi._handlers&&gi._handlers.cursorActivity;if(!gh){return}var gk=gi.curOp.cursorActivityHandlers||(gi.curOp.cursorActivityHandlers=[]);for(var gj=0;gj<gh.length;++gj){if(dh(gk,gh[gj])==-1){gk.push(gh[gj])}}}function fi(gj,gi){var gh=gj._handlers&&gj._handlers[gi];return gh&&gh.length>0}function by(gh){gh.prototype.on=function(gi,gj){bX(this,gi,gj)};gh.prototype.off=function(gi,gj){ed(this,gi,gj)}}var dJ=30;var ca=H.Pass={toString:function(){return"CodeMirror.Pass"}};var Z={scroll:false},M={origin:"*mouse"},cW={origin:"+move"};function gg(){this.id=null}gg.prototype.set=function(gh,gi){clearTimeout(this.id);this.id=setTimeout(gi,gh)};var bT=H.countColumn=function(gk,gi,gm,gn,gj){if(gi==null){gi=gk.search(/[^\s\u00a0]/);if(gi==-1){gi=gk.length}}for(var gl=gn||0,go=gj||0;;){var gh=gk.indexOf("\t",gl);if(gh<0||gh>=gi){return go+(gi-gl)}go+=gh-gl;go+=gm-(go%gm);gl=gh+1}};function eq(gl,gk,gm){for(var gn=0,gj=0;;){var gi=gl.indexOf("\t",gn);if(gi==-1){gi=gl.length}var gh=gi-gn;if(gi==gl.length||gj+gh>=gk){return gn+Math.min(gh,gk-gj)}gj+=gi-gn;gj+=gm-(gj%gm);gn=gi+1;if(gj>=gk){return gn}}}var a0=[""];function cp(gh){while(a0.length<=gh){a0.push(fG(a0)+" ")}return a0[gh]}function fG(gh){return gh[gh.length-1]}var dL=function(gh){gh.select()};if(e1){dL=function(gh){gh.selectionStart=0;gh.selectionEnd=gh.value.length}}else{if(dK){dL=function(gi){try{gi.select()}catch(gh){}}}}function dh(gj,gh){for(var gi=0;gi<gj.length;++gi){if(gj[gi]==gh){return gi}}return -1}function bS(gk,gj){var gh=[];for(var gi=0;gi<gk.length;gi++){gh[gi]=gj(gk[gi],gi)}return gh}function fU(){}function ck(gj,gh){var gi;if(Object.create){gi=Object.create(gj)}else{fU.prototype=gj;gi=new fU()}if(gh){aN(gh,gi)}return gi}function aN(gj,gi,gh){if(!gi){gi={}}for(var gk in gj){if(gj.hasOwnProperty(gk)&&(gh!==false||!gi.hasOwnProperty(gk))){gi[gk]=gj[gk]}}return gi}function cv(gi){var gh=Array.prototype.slice.call(arguments,1);return function(){return gi.apply(null,gh)}}var bc=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;var fD=H.isWordChar=function(gh){return/\w/.test(gh)||gh>"\x80"&&(gh.toUpperCase()!=gh.toLowerCase()||bc.test(gh))};function cA(gh,gi){if(!gi){return fD(gh)}if(gi.source.indexOf("\\w")>-1&&fD(gh)){return true}return gi.test(gh)}function eU(gh){for(var gi in gh){if(gh.hasOwnProperty(gi)&&gh[gi]){return false}}return true}var eJ=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function fp(gh){return gh.charCodeAt(0)>=768&&eJ.test(gh)}function f2(gh,gl,gk,gj){var gm=document.createElement(gh);if(gk){gm.className=gk}if(gj){gm.style.cssText=gj}if(typeof gl=="string"){gm.appendChild(document.createTextNode(gl))}else{if(gl){for(var gi=0;gi<gl.length;++gi){gm.appendChild(gl[gi])}}}return gm}var cl;if(document.createRange){cl=function(gk,gl,gi,gh){var gj=document.createRange();gj.setEnd(gh||gk,gi);gj.setStart(gk,gl);return gj}}else{cl=function(gj,gl,gh){var gi=document.body.createTextRange();try{gi.moveToElementText(gj.parentNode)}catch(gk){return gi}gi.collapse(true);gi.moveEnd("character",gh);gi.moveStart("character",gl);return gi}}function d1(gi){for(var gh=gi.childNodes.length;gh>0;--gh){gi.removeChild(gi.firstChild)}return gi}function bR(gh,gi){return d1(gh).appendChild(gi)}var ga=H.contains=function(gh,gi){if(gi.nodeType==3){gi=gi.parentNode}if(gh.contains){return gh.contains(gi)}do{if(gi.nodeType==11){gi=gi.host}if(gi==gh){return true}}while(gi=gi.parentNode)};function dO(){return document.activeElement}if(dK&&k<11){dO=function(){try{return document.activeElement}catch(gh){return document.body}}}function S(gh){return new RegExp("(^|\\s)"+gh+"(?:$|\\s)\\s*")}var f=H.rmClass=function(gj,gh){var gk=gj.className;var gi=S(gh).exec(gk);if(gi){var gl=gk.slice(gi.index+gi[0].length);gj.className=gk.slice(0,gi.index)+(gl?gi[1]+gl:"")}};var fA=H.addClass=function(gi,gh){var gj=gi.className;if(!S(gh).test(gj)){gi.className+=(gj?" ":"")+gh}};function fS(gj,gh){var gi=gj.split(" ");for(var gk=0;gk<gi.length;gk++){if(gi[gk]&&!S(gi[gk]).test(gh)){gh+=" "+gi[gk]}}return gh}function aA(gk){if(!document.body.getElementsByClassName){return}var gj=document.body.getElementsByClassName("CodeMirror");for(var gi=0;gi<gj.length;gi++){var gh=gj[gi].CodeMirror;if(gh){gk(gh)}}}var cC=false;function bj(){if(cC){return}fE();cC=true}function fE(){var gh;bX(window,"resize",function(){if(gh==null){gh=setTimeout(function(){gh=null;aA(aT)},100)}});bX(window,"blur",function(){aA(aV)})}var eL=function(){if(dK&&k<9){return false}var gh=f2("div");return"draggable" in gh||"dragDrop" in gh}();var fL;function bn(gh){if(fL==null){var gj=f2("span","\u200b");bR(gh,f2("span",[gj,document.createTextNode("x")]));if(gh.firstChild.offsetHeight!=0){fL=gj.offsetWidth<=1&&gj.offsetHeight>2&&!(dK&&k<8)}}var gi=fL?f2("span","\u200b"):f2("span","\u00a0",null,"display: inline-block; width: 1px; margin-right: -1px");gi.setAttribute("cm-text","");return gi}var fK;function bO(gk){if(fK!=null){return fK}var gh=bR(gk,document.createTextNode("A\u062eA"));var gj=cl(gh,0,1).getBoundingClientRect();if(!gj||gj.left==gj.right){return false}var gi=cl(gh,1,2).getBoundingClientRect();return fK=(gi.right-gj.right<3)}var a1=H.splitLines="\n\nb".split(/\n/).length!=3?function(gm){var gn=0,gh=[],gl=gm.length;while(gn<=gl){var gk=gm.indexOf("\n",gn);if(gk==-1){gk=gm.length}var gj=gm.slice(gn,gm.charAt(gk-1)=="\r"?gk-1:gk);var gi=gj.indexOf("\r");if(gi!=-1){gh.push(gj.slice(0,gi));gn+=gi+1}else{gh.push(gj);gn=gk+1}}return gh}:function(gh){return gh.split(/\r\n?|\n/)};var bs=window.getSelection?function(gi){try{return gi.selectionStart!=gi.selectionEnd}catch(gh){return false}}:function(gj){try{var gh=gj.ownerDocument.selection.createRange()}catch(gi){}if(!gh||gh.parentElement()!=gj){return false}return gh.compareEndPoints("StartToEnd",gh)!=0};var da=(function(){var gh=f2("div");if("oncopy" in gh){return true}gh.setAttribute("oncopy","return;");return typeof gh.oncopy=="function"})();var e6=null;function aK(gi){if(e6!=null){return e6}var gj=bR(gi,f2("span","x"));var gk=gj.getBoundingClientRect();var gh=cl(gj,0,1).getBoundingClientRect();return e6=Math.abs(gk.left-gh.left)>1}var fg={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",107:"=",109:"-",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};H.keyNames=fg;(function(){for(var gh=0;gh<10;gh++){fg[gh+48]=fg[gh+96]=String(gh)}for(var gh=65;gh<=90;gh++){fg[gh]=String.fromCharCode(gh)}for(var gh=1;gh<=12;gh++){fg[gh+111]=fg[gh+63235]="F"+gh}})();function d4(gh,gn,gm,gl){if(!gh){return gl(gn,gm,"ltr")}var gk=false;for(var gj=0;gj<gh.length;++gj){var gi=gh[gj];if(gi.from<gm&&gi.to>gn||gn==gm&&gi.to==gn){gl(Math.max(gi.from,gn),Math.min(gi.to,gm),gi.level==1?"rtl":"ltr");gk=true}}if(!gk){gl(gn,gm,"ltr")}}function dy(gh){return gh.level%2?gh.to:gh.from}function gd(gh){return gh.level%2?gh.from:gh.to}function cE(gi){var gh=a(gi);return gh?dy(gh[0]):0}function cS(gi){var gh=a(gi);if(!gh){return gi.text.length}return gd(fG(gh))}function bt(gi,gl){var gj=ff(gi.doc,gl);var gm=y(gj);if(gm!=gj){gl=bN(gm)}var gh=a(gm);var gk=!gh?0:gh[0].level%2?cS(gm):cE(gm);return W(gl,gk)}function dP(gj,gm){var gi,gk=ff(gj.doc,gm);while(gi=ew(gk)){gk=gi.find(1,true).line;gm=null}var gh=a(gk);var gl=!gh?gk.text.length:gh[0].level%2?cE(gk):cS(gk);return W(gm==null?bN(gk):gm,gl)}function dI(gi,gn){var gm=bt(gi,gn.line);var gj=ff(gi.doc,gm.line);var gh=a(gj);if(!gh||gh[0].level==0){var gl=Math.max(0,gj.text.search(/\S/));var gk=gn.line==gm.line&&gn.ch<=gl&&gn.ch;return W(gm.line,gk?0:gl)}return gm}function an(gi,gj,gh){var gk=gi[0].level;if(gj==gk){return true}if(gh==gk){return false}return gj<gh}var e2;function aG(gh,gl){e2=null;for(var gi=0,gj;gi<gh.length;++gi){var gk=gh[gi];if(gk.from<gl&&gk.to>gl){return gi}if((gk.from==gl||gk.to==gl)){if(gj==null){gj=gi}else{if(an(gh,gk.level,gh[gj].level)){if(gk.from!=gk.to){e2=gj}return gi}else{if(gk.from!=gk.to){e2=gi}return gj}}}}return gj}function fe(gh,gk,gi,gj){if(!gj){return gk+gi}do{gk+=gi}while(gk>0&&fp(gh.text.charAt(gk)));return gk}function u(gh,go,gj,gk){var gl=a(gh);if(!gl){return ai(gh,go,gj,gk)}var gn=aG(gl,go),gi=gl[gn];var gm=fe(gh,go,gi.level%2?-gj:gj,gk);for(;;){if(gm>gi.from&&gm<gi.to){return gm}if(gm==gi.from||gm==gi.to){if(aG(gl,gm)==gn){return gm}gi=gl[gn+=gj];return(gj>0)==gi.level%2?gi.to:gi.from}else{gi=gl[gn+=gj];if(!gi){return null}if((gj>0)==gi.level%2){gm=fe(gh,gi.to,-1,gk)}else{gm=fe(gh,gi.from,1,gk)}}}}function ai(gh,gl,gi,gj){var gk=gl+gi;if(gj){while(gk>0&&fp(gh.text.charAt(gk))){gk+=gi}}return gk<0||gk>gh.text.length?null:gk}var bh=(function(){var gn="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN";var gl="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm";function gk(gr){if(gr<=247){return gn.charAt(gr)}else{if(1424<=gr&&gr<=1524){return"R"}else{if(1536<=gr&&gr<=1773){return gl.charAt(gr-1536)}else{if(1774<=gr&&gr<=2220){return"r"}else{if(8192<=gr&&gr<=8203){return"w"}else{if(gr==8204){return"b"}else{return"L"}}}}}}}var gh=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;var gq=/[stwN]/,gj=/[LRr]/,gi=/[Lb1n]/,gm=/[1n]/;var gp="L";function go(gt,gs,gr){this.level=gt;this.from=gs;this.to=gr}return function(gB){if(!gh.test(gB)){return false}var gH=gB.length,gx=[];for(var gG=0,gt;gG<gH;++gG){gx.push(gt=gk(gB.charCodeAt(gG)))}for(var gG=0,gA=gp;gG<gH;++gG){var gt=gx[gG];if(gt=="m"){gx[gG]=gA}else{gA=gt}}for(var gG=0,gr=gp;gG<gH;++gG){var gt=gx[gG];if(gt=="1"&&gr=="r"){gx[gG]="n"}else{if(gj.test(gt)){gr=gt;if(gt=="r"){gx[gG]="R"}}}}for(var gG=1,gA=gx[0];gG<gH-1;++gG){var gt=gx[gG];if(gt=="+"&&gA=="1"&&gx[gG+1]=="1"){gx[gG]="1"}else{if(gt==","&&gA==gx[gG+1]&&(gA=="1"||gA=="n")){gx[gG]=gA}}gA=gt}for(var gG=0;gG<gH;++gG){var gt=gx[gG];if(gt==","){gx[gG]="N"}else{if(gt=="%"){for(var gu=gG+1;gu<gH&&gx[gu]=="%";++gu){}var gI=(gG&&gx[gG-1]=="!")||(gu<gH&&gx[gu]=="1")?"1":"N";for(var gE=gG;gE<gu;++gE){gx[gE]=gI}gG=gu-1}}}for(var gG=0,gr=gp;gG<gH;++gG){var gt=gx[gG];if(gr=="L"&&gt=="1"){gx[gG]="L"}else{if(gj.test(gt)){gr=gt}}}for(var gG=0;gG<gH;++gG){if(gq.test(gx[gG])){for(var gu=gG+1;gu<gH&&gq.test(gx[gu]);++gu){}var gy=(gG?gx[gG-1]:gp)=="L";var gs=(gu<gH?gx[gu]:gp)=="L";var gI=gy||gs?"L":"R";for(var gE=gG;gE<gu;++gE){gx[gE]=gI}gG=gu-1}}var gF=[],gC;for(var gG=0;gG<gH;){if(gi.test(gx[gG])){var gv=gG;for(++gG;gG<gH&&gi.test(gx[gG]);++gG){}gF.push(new go(0,gv,gG))}else{var gw=gG,gz=gF.length;for(++gG;gG<gH&&gx[gG]!="L";++gG){}for(var gE=gw;gE<gG;){if(gm.test(gx[gE])){if(gw<gE){gF.splice(gz,0,new go(1,gw,gE))}var gD=gE;for(++gE;gE<gG&&gm.test(gx[gE]);++gE){}gF.splice(gz,0,new go(2,gD,gE));gw=gE}else{++gE}}if(gw<gG){gF.splice(gz,0,new go(1,gw,gG))}}}if(gF[0].level==1&&(gC=gB.match(/^\s+/))){gF[0].from=gC[0].length;gF.unshift(new go(0,0,gC[0].length))}if(fG(gF).level==1&&(gC=gB.match(/\s+$/))){fG(gF).to-=gC[0].length;gF.push(new go(0,gH-gC[0].length,gH))}if(gF[0].level==2){gF.unshift(new go(1,gF[0].to,gF[0].to))}if(gF[0].level!=fG(gF).level){gF.push(new go(gF[0].level,gH,gH))}return gF}})();H.version="5.3.0";return H});