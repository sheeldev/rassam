function upclick(d){var e={element:null,action:"about:blank",action_params:{},maxsize:0,onstart:null,oncomplete:null,dataname:"upload",uploadtype:"general",target:null,zindex:"auto"};for(var n in e){d[n]=d[n]?d[n]:e[n]}var g=d.element;if(typeof g=="string"){g=document.getElementById(g)}var m=g.ownerDocument;var l;var a=m.createElement("div");var k="frame"+new Date().getTime().toString().substr(8);a.innerHTML='<iframe name="'+k+'" src="about:blank" onload="this.onload_callback()"></iframe>';var b=a.childNodes[0];b.onload_callback=function(){var q=m.createElement("form");a.appendChild(q);q.method="post";q.enctype="multipart/form-data";q.encoding="multipart/form-data";if(d.target){q.target=d.target;q.setAttribute("target",d.target)}else{q.target=k;q.setAttribute("target",k)}q.action=d.action;q.setAttribute("action",d.action);q.style.margin=0;q.style.padding=0;q.style.height="80px";q.style.width="40px";q.runat="server";if(d.maxsize){var r=m.createElement("input");r.type="hidden";r.name="MAX_FILE_SIZE";r.value=String(d.maxsize);q.appendChild(r)}l=m.createElement("input");l.name=d.dataname;l.type="file";l.size="1";l.runat="server";q.appendChild(l);l.style.position="absolute";l.style.display="block";l.style.top=0;l.style.left=0;l.style.height=q.style.height;l.style.width="80px";l.style.opacity=0;l.style.filter="alpha(opacity=0)";l.style.fontSize=8;l.style.zIndex=1;l.style.visiblity="hidden";l.style.marginLeft="-40px";var p=function(x){if(!l.value){return}for(var u=0;u<q.childNodes.length;u++){var t=q.childNodes[u];if(t.is_action_params){q.removeChild(t)}}var z=d.action_params;if(typeof(z)=="function"){z=z()}for(var s in z){var w=m.createElement("input");w.type="hidden";w.name=s;w.value=String(z[s]);w.is_action_params=true;q.appendChild(w)}var v=d.onstart;if(v){v(l.value)}q.submit()};if(l.addEventListener){l.addEventListener("change",p,false)}else{if(l.attachEvent){l.attachEvent("onpropertychange",function(s){if(!s){s=window.event}if(s.propertyName=="value"){p()}})}else{l.onpropertychange=p}}b.onload_callback=function(){var s=null;if(b.contentWindow){s=b.contentWindow}else{if(b.contentDocument){s=b.contentDocument.defaultView}}var u=s.document.body.innerHTML;var t=d.oncomplete;if(t){t(u)}q.reset()}};b.style.display="none";b.width=0;b.height=0;b.marginHeight=0;b.marginWidth=0;m.body.insertBefore(a,m.body.firstChild);a.style.position="absolute";a.style.overflow="hidden";a.style.padding=0;a.style.margin=0;a.style.visiblity="hidden";a.style.width="0px";a.style.height="0px";if(d.zindex=="auto"){var o=0,j;var f=g;var i;while(f.tagName!="BODY"){i=f.currentStyle?f.currentStyle:getComputedStyle(f,null);j=parseInt(i.zIndex);j=isNaN(j)?0:j;o+=j+1;f=f.parentNode}a.style.zIndex=o}else{a.style.zIndex=d.zindex}var c=function(q){if(!q){q=window.event}a.style.width="0px";a.style.height="0px";var p=m.elementFromPoint(q.clientX,q.clientY);if(p===g){a.style.width="40px";a.style.height="80px"}};if(a.addEventListener){a.addEventListener("mousemove",c,false)}else{if(a.attachEvent){a.attachEvent("onmousemove",c)}}var h=function(s){if(!s){s=window.event}var q=y=0;if(s.pageX){q=s.pageX}else{if(s.clientX){q=s.clientX+(m.documentElement.scrollLeft?m.documentElement.scrollLeft:m.body.scrollLeft)}}if(s.pageY){y=s.pageY}else{if(s.clientY){y=s.clientY+(m.documentElement.scrollTop?m.documentElement.scrollTop:m.body.scrollTop)}}a.style.left=q-20+"px";a.style.top=y-40+"px";a.style.width="40px";a.style.height="80px";if(document.createEvent){var r=document.createEvent("MouseEvents");r.initEvent("mouseenter",true,false);g.dispatchEvent(r);var p=document.createEvent("MouseEvents");p.initEvent("mouseover",true,false);g.dispatchEvent(p)}else{if(document.createEventObject){g.fireEvent("onmouseenter");g.fireEvent("onmouseover")}}};if(g.addEventListener){g.addEventListener("mousemove",h,false)}else{if(g.attachEvent){g.attachEvent("onmousemove",h)}}};